// TeamPulse Analytics - Complete Enhanced Version
// Comprehensive team analysis with sociometric data visualization

// ===== Language Translations =====
const translations = {
    uk: {
        'mobile.title': '–î–ª—è –∫—Ä–∞—â–æ–≥–æ –¥–æ—Å–≤—ñ–¥—É',
        'mobile.description': '–†–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ –Ω–∞ –∫–æ–º–ø\'—é—Ç–µ—Ä—ñ –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó',
        'mobile.continue': '–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –Ω–∞ –º–æ–±—ñ–ª—å–Ω–æ–º—É',
        'logo.subtitle': 'VQ & IM Team Insights',
        'nav.visualizations': '–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó',
        'nav.3d': '3D –ü—Ä–æ—Å—Ç—ñ—Ä',
        'nav.force': '–°–∏–ª–æ–≤–∏–π –≥—Ä–∞—Ñ',
        'nav.circular': '–ö—Ä—É–≥–æ–≤–∞',
        'nav.heatmap': '–¢–µ–ø–ª–æ–≤–∞ –∫–∞—Ä—Ç–∞',
        'nav.development': '–†–æ–∑–≤–∏—Ç–æ–∫ –∫–æ–º–∞–Ω–¥–∏',
        'nav.analysis': '–ì–ª–∏–±–æ–∫–∏–π –∞–Ω–∞–ª—ñ–∑',
        'nav.metrics': '–ú–µ—Ç—Ä–∏–∫–∏ –∫–æ–º–∞–Ω–¥–∏',
        'nav.glossary': '–ì–ª–æ—Å–∞—Ä—ñ–π',
        'filters.title': '–§—ñ–ª—å—Ç—Ä–∏',
        'filters.positive': '–ü–æ–∑–∏—Ç–∏–≤–Ω—ñ –∑–≤\'—è–∑–∫–∏',
        'filters.negative': '–ù–µ–≥–∞—Ç–∏–≤–Ω—ñ –∑–≤\'—è–∑–∫–∏',
        'filters.incoming': '–í—Ö—ñ–¥–Ω—ñ –æ—Ü—ñ–Ω–∫–∏',
        'filters.outgoing': '–í–∏—Ö—ñ–¥–Ω—ñ –æ—Ü—ñ–Ω–∫–∏',
        'filters.focusPerson': '–§–æ–∫—É—Å –Ω–∞ –æ—Å–æ–±—ñ:',
        'filters.allMembers': '–í—Å—ñ —É—á–∞—Å–Ω–∏–∫–∏',
        'metrics.title': '–ö–ª—é—á–æ–≤—ñ –º–µ—Ç—Ä–∏–∫–∏',
        'metrics.teamHealth': '–ó–¥–æ—Ä–æ–≤\'—è –∫–æ–º–∞–Ω–¥–∏',
        'metrics.friction': '–Ü–Ω–¥–µ–∫—Å —Ç–µ—Ä—Ç—è',
        'metrics.clarity': '–Ø—Å–Ω—ñ—Å—Ç—å —Ä–æ–ª–µ–π',
        'metrics.engagement': '–ó–∞–ª—É—á–µ–Ω—ñ—Å—Ç—å',
        'actions.title': '–î—ñ—ó',
        'actions.pauseAnimation': '–ü–∞—É–∑–∞ –∞–Ω—ñ–º–∞—Ü—ñ—ó',
        'actions.playAnimation': '–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –∞–Ω—ñ–º–∞—Ü—ñ—é',
        'actions.screenshot': '–°–∫—Ä—ñ–Ω—à–æ—Ç',
        'actions.fullscreen': '–ù–∞ –≤–µ—Å—å –µ–∫—Ä–∞–Ω',
        'actions.export': '–ï–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–∏—Ö',
        'actions.toggleLegend': '–ü—Ä–∏—Ö–æ–≤–∞—Ç–∏/–ü–æ–∫–∞–∑–∞—Ç–∏ –ª–µ–≥–µ–Ω–¥—É',
        'titles.3d': '3D –ü—Ä–æ—Å—Ç—ñ—Ä –∫–æ–º–∞–Ω–¥–∏',
        'titles.force': '–°–∏–ª–æ–≤–∞ –¥—ñ–∞–≥—Ä–∞–º–∞ –∑–≤\'—è–∑–∫—ñ–≤',
        'titles.circular': '–ö—Ä—É–≥–æ–≤–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è',
        'titles.heatmap': '–¢–µ–ø–ª–æ–≤–∞ –∫–∞—Ä—Ç–∞ –≤–∑–∞—î–º–æ–¥—ñ–π',
        'titles.development': '–†–æ–∑–≤–∏—Ç–æ–∫ –∫–æ–º–∞–Ω–¥–∏',
        'titles.analysis': '–ì–ª–∏–±–∏–Ω–Ω–∏–π –∞–Ω–∞–ª—ñ–∑',
        'titles.metrics': '–î–µ—Ç–∞–ª—å–Ω—ñ –º–µ—Ç—Ä–∏–∫–∏ –∫–æ–º–∞–Ω–¥–∏',
        'titles.glossary': '–ì–ª–æ—Å–∞—Ä—ñ–π —Ç–µ—Ä–º—ñ–Ω—ñ–≤',
        'legend.title': '–õ–µ–≥–µ–Ω–¥–∞',
        'legend.positive': '–ü–æ–∑–∏—Ç–∏–≤–Ω–∏–π –∑–≤\'—è–∑–æ–∫',
        'legend.negative': '–ù–µ–≥–∞—Ç–∏–≤–Ω–∏–π –∑–≤\'—è–∑–æ–∫',
        'legend.leader': '–õ—ñ–¥–µ—Ä/–ö–µ—Ä—ñ–≤–Ω–∏–∫',
        'legend.mutual': '–í–∑–∞—î–º–Ω–∏–π —Ç–æ–ø-3',
        'info3d.structure': '–ö–æ–º–∞–Ω–¥–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞',
        'info3d.clickInstruction': '–ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ —á–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∏ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó',
        'quick.positive': '–ü–æ–∑–∏—Ç–∏–≤–Ω—ñ',
        'quick.negative': '–ù–µ–≥–∞—Ç–∏–≤–Ω—ñ',
        'quick.influence': '–í–ø–ª–∏–≤',
        'quick.details': '–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ',
        'member.competencies': '–û—Ü—ñ–Ω–∫–∏ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü—ñ–π',
        'member.communication': '–ö–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è',
        'member.leadership': '–õ—ñ–¥–µ—Ä—Å—Ç–≤–æ',
        'member.trust': '–î–æ–≤—ñ—Ä–∞',
        'member.collaboration': '–°–ø—ñ–≤–ø—Ä–∞—Ü—è',
        'member.conflict': '–í–∏—Ä—ñ—à–µ–Ω–Ω—è –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤',
        'member.development': '–Ü–Ω–¥–µ–∫—Å–∏ —Ä–æ–∑–≤–∏—Ç–∫—É',
        'member.connections': '–°–æ—Ü—ñ–æ–º–µ—Ç—Ä–∏—á–Ω—ñ –∑–≤\'—è–∑–∫–∏',
        'member.preferredColleagues': '–ë–∞–∂–∞–Ω—ñ –∫–æ–ª–µ–≥–∏',
        'member.leastPreferredColleagues': '–ù–∞–π–º–µ–Ω—à –±–∞–∂–∞–Ω—ñ –∫–æ–ª–µ–≥–∏',
        'member.keyQuote': '–ö–ª—é—á–æ–≤–∞ —Ü–∏—Ç–∞—Ç–∞',
        'member.professionalProfile': '–ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å',
        'member.strengths': '–°–∏–ª—å–Ω—ñ —Å—Ç–æ—Ä–æ–Ω–∏',
        'member.challenges': '–í–∏–∫–ª–∏–∫–∏',
        'member.developmentZone': '–ó–æ–Ω–∞ —Ä–æ–∑–≤–∏—Ç–∫—É',
        'member.keyInsight': '–ö–ª—é—á–æ–≤–∏–π —ñ–Ω—Å–∞–π—Ç',
        'member.quadrantAnalysis': '–ö–≤–∞–¥—Ä–∞–Ω—Ç-–∞–Ω–∞–ª—ñ–∑',
        'member.psychology': '–ü—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å',
        'member.development': '–ü–ª–∞–Ω —Ä–æ–∑–≤–∏—Ç–∫—É',
        'member.sociometricData': '–°–æ—Ü—ñ–æ–º–µ—Ç—Ä–∏—á–Ω—ñ –¥–∞–Ω—ñ',
        'member.meanRank': '–°–µ—Ä–µ–¥–Ω—ñ–π —Ä–∞–Ω–≥',
        'member.stdDev': '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è',
        'member.top3Count': '–í—Ö–æ–¥–∂–µ–Ω—å –≤ —Ç–æ–ø-3',
        'member.statusScore': '–°—Ç–∞—Ç—É—Å–Ω–∏–π –±–∞–ª',
        'member.selfPerceptionMAE': '–ü–æ—Ö–∏–±–∫–∞ —Å–∞–º–æ—Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è',
        'member.bias': '–ó–º—ñ—â–µ–Ω–Ω—è –æ—Ü—ñ–Ω–∫–∏',
        'member.accuracy': '–¢–æ—á–Ω—ñ—Å—Ç—å ¬±1',
        'quadrant.highPerformers': '–í–∏—Å–æ–∫–æ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ',
        'quadrant.developmentNeeded': '–ü–æ—Ç—Ä–µ–±—É—é—Ç—å —Ä–æ–∑–≤–∏—Ç–∫—É',
        'quadrant.underutilized': '–ù–µ–¥–æ–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ',
        'quadrant.delegationReady': '–ì–æ—Ç–æ–≤—ñ –¥–æ –¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è',
        'psychology.motivators': '–§–∞–∫—Ç–æ—Ä–∏ –º–æ—Ç–∏–≤–∞—Ü—ñ—ó',
        'psychology.demotivators': '–§–∞–∫—Ç–æ—Ä–∏ –¥–µ–º–æ—Ç–∏–≤–∞—Ü—ñ—ó',
        'psychology.conflictStyle': '–°—Ç–∏–ª—å –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –≤ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç–∞—Ö',
        'psychology.risks': '–†–∏–∑–∏–∫–∏ –Ω–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—ó –ø–æ–≤–µ–¥—ñ–Ω–∫–∏',
        'development.title': '–Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–π –ø–ª–∞–Ω —Ä–æ–∑–≤–∏—Ç–∫—É',
        'glossary.meanRank': '–°–µ—Ä–µ–¥–Ω—ñ–π —Ä–∞–Ω–≥',
        'glossary.meanRankDesc': '–°–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è —Ä–∞–Ω–≥—ñ–≤ (1-8), —è–∫—ñ –ª—é–¥–∏–Ω–∞ –æ—Ç—Ä–∏–º—É—î –≤—ñ–¥ —ñ–Ω—à–∏—Ö —á–ª–µ–Ω—ñ–≤ –∫–æ–º–∞–Ω–¥–∏. –ß–∏–º –Ω–∏–∂—á–µ –∑–Ω–∞—á–µ–Ω–Ω—è, —Ç–∏–º –≤–∏—â–∞ –ø–æ–∑–∏—Ü—ñ—è –≤ —ñ—î—Ä–∞—Ä—Ö—ñ—ó.',
        'glossary.mae': 'MAE (Mean Absolute Error)',
        'glossary.maeDesc': '–°–µ—Ä–µ–¥–Ω—è –∞–±—Å–æ–ª—é—Ç–Ω–∞ –ø–æ—Ö–∏–±–∫–∞ –º—ñ–∂ –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–∏–º —ñ —Ñ–∞–∫—Ç–∏—á–Ω–∏–º —Ä–∞–Ω–≥–æ–º. –ü–æ–∫–∞–∑—É—î, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ —Ç–æ—á–Ω–æ –ª—é–¥–∏–Ω–∞ –æ—Ü—ñ–Ω—é—î —Å–≤–æ—î —Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è —ñ–Ω—à–∏–º–∏.',
        'glossary.statusScore': '–°—Ç–∞—Ç—É—Å–Ω–∏–π –±–∞–ª',
        'glossary.statusScoreDesc': '–ó–≤–∞–∂–µ–Ω–∏–π –ø–æ–∫–∞–∑–Ω–∏–∫ —Å—Ç–∞—Ç—É—Å—É (0-1). –†–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è —è–∫ —Å—É–º–∞ –≤—Ö—ñ–¥–Ω–∏—Ö –≤–∞–≥ –ø–æ–¥—ñ–ª–µ–Ω–∞ –Ω–∞ –º–∞–∫—Å–∏–º—É–º. –ß–∏–º –≤–∏—â–µ, —Ç–∏–º –≤–∏—â–∏–π —Å—Ç–∞—Ç—É—Å.',
        'glossary.bias': 'Bias (–ó–º—ñ—â–µ–Ω–Ω—è)',
        'glossary.biasDesc': '–†—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ —Ñ–∞–∫—Ç–∏—á–Ω–∏–º —ñ –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–∏–º —Ä–∞–Ω–≥–æ–º. –ü–æ–∑–∏—Ç–∏–≤–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è = –ø–µ—Ä–µ–æ—Ü—ñ–Ω–∫–∞ —Å–≤–æ–≥–æ —Å—Ç–∞—Ç—É—Å—É, –Ω–µ–≥–∞—Ç–∏–≤–Ω–µ = –Ω–µ–¥–æ–æ—Ü—ñ–Ω–∫–∞.',
        'glossary.top3': '–¢–æ–ø-3 –≤—Ö–æ–¥–∂–µ–Ω–Ω—è',
        'glossary.top3Desc': '–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–∞–∑—ñ–≤, –∫–æ–ª–∏ –ª—é–¥–∏–Ω–∞ –ø–æ—Ç—Ä–∞–ø–ª—è—î –≤ —Ç–æ–ø-3 –∑–∞ –æ—Ü—ñ–Ω–∫–∞–º–∏ –∫–æ–ª–µ–≥ (—Ä–∞–Ω–≥–∏ 1, 2 –∞–±–æ 3).',
        'glossary.gini': '–Ü–Ω–¥–µ–∫—Å –î–∂–∏–Ω—ñ',
        'glossary.giniDesc': '–ú—ñ—Ä–∞ –Ω–µ—Ä—ñ–≤–Ω–æ—Å—Ç—ñ —Ä–æ–∑–ø–æ–¥—ñ–ª—É (0-1). –í –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –∫–æ–º–∞–Ω–¥–∏ –ø–æ–∫–∞–∑—É—î —Å—Ç—É–ø—ñ–Ω—å –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü—ñ—ó –≤–ª–∞–¥–∏/–¥–æ–≤—ñ—Ä–∏.',
        'notification.welcome': '–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –¥–æ TeamPulse Analytics! üöÄ',
        'notification.viewReset': '–í–∏–≥–ª—è–¥ —Å–∫–∏–Ω—É—Ç–æ',
        'notification.screenshotCreating': '–°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫—Ä—ñ–Ω—à–æ—Ç—É...',
        'notification.screenshotSaved': '–°–∫—Ä—ñ–Ω—à–æ—Ç –∑–±–µ—Ä–µ–∂–µ–Ω–æ!',
        'notification.screenshotError': '–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫—Ä—ñ–Ω—à–æ—Ç—É',
        'notification.fullscreenEnabled': '–ü–æ–≤–Ω–æ–µ–∫—Ä–∞–Ω–Ω–∏–π —Ä–µ–∂–∏–º —É–≤—ñ–º–∫–Ω–µ–Ω–æ',
        'notification.fullscreenDisabled': '–ü–æ–≤–Ω–æ–µ–∫—Ä–∞–Ω–Ω–∏–π —Ä–µ–∂–∏–º –≤–∏–º–∫–Ω–µ–Ω–æ',
        'notification.dataExported': '–î–∞–Ω—ñ –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ —É—Å–ø—ñ—à–Ω–æ!',
        'notification.animationPaused': '–ê–Ω—ñ–º–∞—Ü—ñ—é –ø—Ä–∏–∑—É–ø–∏–Ω–µ–Ω–æ',
        'notification.animationResumed': '–ê–Ω—ñ–º–∞—Ü—ñ—é –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–æ',
        'notification.legendToggled': '–í–∏–¥–∏–º—ñ—Å—Ç—å –ª–µ–≥–µ–Ω–¥–∏ –∑–º—ñ–Ω–µ–Ω–æ'
    },
    en: {
        'mobile.title': 'For Better Experience',
        'mobile.description': 'We recommend viewing on a computer for full visualization functionality',
        'mobile.continue': 'Continue on Mobile',
        'logo.subtitle': 'VQ & IM Team Insights',
        'nav.visualizations': 'Visualizations',
        'nav.3d': '3D Space',
        'nav.force': 'Force Graph',
        'nav.circular': 'Circular',
        'nav.heatmap': 'Heat Map',
        'nav.development': 'Team Development',
        'nav.analysis': 'Deep Analysis',
        'nav.metrics': 'Team Metrics',
        'nav.glossary': 'Glossary',
        'filters.title': 'Filters',
        'filters.positive': 'Positive Connections',
        'filters.negative': 'Negative Connections',
        'filters.incoming': 'Incoming Ratings',
        'filters.outgoing': 'Outgoing Ratings',
        'filters.focusPerson': 'Focus on Person:',
        'filters.allMembers': 'All Members',
        'metrics.title': 'Key Metrics',
        'metrics.teamHealth': 'Team Health',
        'metrics.friction': 'Friction Index',
        'metrics.clarity': 'Role Clarity',
        'metrics.engagement': 'Engagement',
        'actions.title': 'Actions',
        'actions.pauseAnimation': 'Pause Animation',
        'actions.playAnimation': 'Resume Animation',
        'actions.screenshot': 'Screenshot',
        'actions.fullscreen': 'Fullscreen',
        'actions.export': 'Export Data',
        'actions.toggleLegend': 'Toggle Legend',
        'titles.3d': '3D Team Space',
        'titles.force': 'Force Connection Diagram',
        'titles.circular': 'Circular Visualization',
        'titles.heatmap': 'Interaction Heat Map',
        'titles.development': 'Team Development',
        'titles.analysis': 'Deep Analysis',
        'titles.metrics': 'Detailed Team Metrics',
        'titles.glossary': 'Terms Glossary',
        'legend.title': 'Legend',
        'legend.positive': 'Positive Connection',
        'legend.negative': 'Negative Connection',
        'legend.leader': 'Leader/Manager',
        'legend.mutual': 'Mutual Top-3',
        'info3d.structure': 'Team Structure',
        'info3d.clickInstruction': 'Click on a team member for detailed information',
        'quick.positive': 'Positive',
        'quick.negative': 'Negative',
        'quick.influence': 'Influence',
        'quick.details': 'Details',
        'member.competencies': 'Competency Scores',
        'member.communication': 'Communication',
        'member.leadership': 'Leadership',
        'member.trust': 'Trust',
        'member.collaboration': 'Collaboration',
        'member.conflict': 'Conflict Resolution',
        'member.development': 'Development Indices',
        'member.connections': 'Sociometric Connections',
        'member.preferredColleagues': 'Preferred Colleagues',
        'member.leastPreferredColleagues': 'Least Preferred Colleagues',
        'member.keyQuote': 'Key Quote',
        'member.professionalProfile': 'Professional Profile',
        'member.strengths': 'Strengths',
        'member.challenges': 'Challenges',
        'member.developmentZone': 'Development Zone',
        'member.keyInsight': 'Key Insight',
        'member.quadrantAnalysis': 'Quadrant Analysis',
        'member.psychology': 'Psychological Profile',
        'member.development': 'Development Plan',
        'member.sociometricData': 'Sociometric Data',
        'member.meanRank': 'Mean Rank',
        'member.stdDev': 'Standard Deviation',
        'member.top3Count': 'Top-3 Entries',
        'member.statusScore': 'Status Score',
        'member.selfPerceptionMAE': 'Self-Perception Error',
        'member.bias': 'Bias',
        'member.accuracy': 'Accuracy ¬±1',
        'quadrant.highPerformers': 'High Performers',
        'quadrant.developmentNeeded': 'Development Needed',
        'quadrant.underutilized': 'Underutilized',
        'quadrant.delegationReady': 'Delegation Ready',
        'psychology.motivators': 'Motivational Factors',
        'psychology.demotivators': 'Demotivational Factors',
        'psychology.conflictStyle': 'Conflict Behavior Style',
        'psychology.risks': 'Unproductive Behavior Risks',
        'development.title': 'Individual Development Plan',
        'glossary.meanRank': 'Mean Rank',
        'glossary.meanRankDesc': 'Average of ranks (1-8) a person receives from other team members. Lower value means higher position in hierarchy.',
        'glossary.mae': 'MAE (Mean Absolute Error)',
        'glossary.maeDesc': 'Average absolute error between predicted and actual rank. Shows how accurately a person estimates their perception by others.',
        'glossary.statusScore': 'Status Score',
        'glossary.statusScoreDesc': 'Weighted status indicator (0-1). Calculated as sum of incoming weights divided by maximum. Higher means higher status.',
        'glossary.bias': 'Bias',
        'glossary.biasDesc': 'Difference between actual and predicted rank. Positive = overestimating status, negative = underestimating.',
        'glossary.top3': 'Top-3 Entries',
        'glossary.top3Desc': 'Number of times a person is in top-3 by colleagues\' ratings (ranks 1, 2, or 3).',
        'glossary.gini': 'Gini Index',
        'glossary.giniDesc': 'Measure of distribution inequality (0-1). In team context shows degree of power/trust concentration.',
        'notification.welcome': 'Welcome to TeamPulse Analytics! üöÄ',
        'notification.viewReset': 'View reset',
        'notification.screenshotCreating': 'Creating screenshot...',
        'notification.screenshotSaved': 'Screenshot saved!',
        'notification.screenshotError': 'Screenshot error',
        'notification.fullscreenEnabled': 'Fullscreen mode enabled',
        'notification.fullscreenDisabled': 'Fullscreen mode disabled',
        'notification.dataExported': 'Data exported successfully!',
        'notification.animationPaused': 'Animation paused',
        'notification.animationResumed': 'Animation resumed',
        'notification.legendToggled': 'Legend visibility changed'
    }
};

// ===== Real Sociometric Data =====
const sociometricData = {
    '1001': { // Alex
        meanRankOwnership: 1.50,
        meanRankTrust: 1.63,
        stdOwnership: 0.71,
        stdTrust: 0.86,
        top3CountOwnership: 8,
        top3CountTrust: 8,
        statusScoreOwnership: 0.938,
        statusScoreTrust: 0.922,
        selfMAEOwnership: 0.25,
        selfMAETrust: 0.38,
        biasOwnership: 0.25,
        biasTrust: 0.38,
        accuracyOwnership: 100,
        accuracyTrust: 87.5
    },
    '1004': { // Igor
        meanRankOwnership: 2.38,
        meanRankTrust: 2.00,
        stdOwnership: 1.87,
        stdTrust: 1.00,
        top3CountOwnership: 7,
        top3CountTrust: 7,
        statusScoreOwnership: 0.828,
        statusScoreTrust: 0.875,
        selfMAEOwnership: 0.88,
        selfMAETrust: 0.50,
        biasOwnership: 0.38,
        biasTrust: 0.00,
        accuracyOwnership: 75,
        accuracyTrust: 87.5
    },
    '1006': { // Rami
        meanRankOwnership: 3.50,
        meanRankTrust: 3.50,
        stdOwnership: 1.22,
        stdTrust: 1.66,
        top3CountOwnership: 5,
        top3CountTrust: 5,
        statusScoreOwnership: 0.688,
        statusScoreTrust: 0.688,
        selfMAEOwnership: 0.88,
        selfMAETrust: 1.00,
        biasOwnership: 0.38,
        biasTrust: -0.25,
        accuracyOwnership: 75,
        accuracyTrust: 75
    },
    '1007': { // Nik
        meanRankOwnership: 5.50,
        meanRankTrust: 4.38,
        stdOwnership: 1.58,
        stdTrust: 0.86,
        top3CountOwnership: 2,
        top3CountTrust: 1,
        statusScoreOwnership: 0.493,
        statusScoreTrust: 0.478,
        selfMAEOwnership: 2.25,
        selfMAETrust: 2.25,
        biasOwnership: 2.25,
        biasTrust: 2.25,
        accuracyOwnership: 50,
        accuracyTrust: 37.5
    },
    '1002': { // Oleg
        meanRankOwnership: 4.88,
        meanRankTrust: 5.00,
        stdOwnership: 1.62,
        stdTrust: 1.73,
        top3CountOwnership: 2,
        top3CountTrust: 2,
        statusScoreOwnership: 0.516,
        statusScoreTrust: 0.500,
        selfMAEOwnership: 1.50,
        selfMAETrust: 1.50,
        biasOwnership: 1.25,
        biasTrust: 1.25,
        accuracyOwnership: 50,
        accuracyTrust: 50
    },
    '1009': { // Antonia
        meanRankOwnership: 4.75,
        meanRankTrust: 4.75,
        stdOwnership: 1.79,
        stdTrust: 2.05,
        top3CountOwnership: 2,
        top3CountTrust: 2,
        statusScoreOwnership: 0.531,
        statusScoreTrust: 0.531,
        selfMAEOwnership: 1.63,
        selfMAETrust: 1.75,
        biasOwnership: 0.13,
        biasTrust: 0.50,
        accuracyOwnership: 75,
        accuracyTrust: 62.5
    },
    '1003': { // Maivi
        meanRankOwnership: 5.13,
        meanRankTrust: 5.13,
        stdOwnership: 1.69,
        stdTrust: 1.76,
        top3CountOwnership: 1,
        top3CountTrust: 2,
        statusScoreOwnership: 0.484,
        statusScoreTrust: 0.484,
        selfMAEOwnership: 1.63,
        selfMAETrust: 1.63,
        biasOwnership: -0.38,
        biasTrust: -0.38,
        accuracyOwnership: 50,
        accuracyTrust: 50
    },
    '1008': { // Yana
        meanRankOwnership: 6.38,
        meanRankTrust: 6.75,
        stdOwnership: 1.41,
        stdTrust: 1.20,
        top3CountOwnership: 0,
        top3CountTrust: 0,
        statusScoreOwnership: 0.328,
        statusScoreTrust: 0.281,
        selfMAEOwnership: 0.63,
        selfMAETrust: 0.63,
        biasOwnership: -0.38,
        biasTrust: -0.13,
        accuracyOwnership: 75,
        accuracyTrust: 87.5
    },
    '1005': { // Viktoria
        meanRankOwnership: 7.50,
        meanRankTrust: 7.38,
        stdOwnership: 1.00,
        stdTrust: 0.86,
        top3CountOwnership: 0,
        top3CountTrust: 0,
        statusScoreOwnership: 0.188,
        statusScoreTrust: 0.203,
        selfMAEOwnership: 0.50,
        selfMAETrust: 1.38,
        biasOwnership: -0.50,
        biasTrust: 1.38,
        accuracyOwnership: 87.5,
        accuracyTrust: 37.5
    }
};

// ===== Mutual Top3 Connections =====
const mutualTop3Ownership = [
    ['1001', '1006'], ['1001', '1002'], ['1001', '1004'], 
    ['1002', '1004'], ['1004', '1006'], ['1006', '1007']
];

const mutualTop3Trust = [
    ...mutualTop3Ownership,
    ['1003', '1009']
];

// ===== Enhanced Team Data with Real Metrics =====
const teamData = {
    members: [
        {
            id: '1001',
            code: '1001',
            name: 'Alex Klymenko',
            firstName: 'Alex',
            role: 'Main Sales Manager',
            company: 'Vagoteq',
            department: 'Sales',
            level: 'Senior',
            scores: { communication: 4, leadership: 4, trust: 5, collaboration: 4, conflict: 4 },
            preferred: [],
            leastPreferred: [],
            innovator: false,
            leader: true,
            quote: '–£ –Ω–∞—Å –Ω–µ–º–∞—î —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏—Ö —Ç–∞ —á—ñ—Ç–∫–∏—Ö –æ–±–æ–≤\'—è–∑–∫—ñ–≤ –º—ñ–∂ –∫–æ–ª–µ–≥–∞–º–∏, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –ø—Ä–æ–±–ª–µ–º —É –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó.',
            insights: {
                strength: '–õ—ñ–¥–µ—Ä—Å—Ç–≤–æ —É –ø—Ä–æ–¥–∞–∂–∞—Ö, –≥–ª–∏–±–æ–∫–µ –∑–∞–ª—É—á–µ–Ω–Ω—è –≤ –ø—Ä–æ–µ–∫—Ç–∏, –¥—É—Ö —Å–ø—ñ–≤–ø—Ä–∞—Ü—ñ',
                challenge: '–ë—Ä–∞–∫ "—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏—Ö –æ–±–æ–≤\'—è–∑–∫—ñ–≤"; –ø–æ—Ç—Ä–µ–±—É—î –±—ñ–ª—å—à–µ —á–∞—Å—É –Ω–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è',
                development: '–°—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è: –ø–µ—Ä–µ—Ö—ñ–¥ –¥–æ —Å–ø—Ä–∞–≤–∂–Ω—å–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —á–µ—Ä–µ–∑ —á—ñ—Ç–∫—ñ —Ü—ñ–ª—ñ',
                keyInsight: '–ê–±—Å–æ–ª—é—Ç–Ω–∏–π –ª—ñ–¥–µ—Ä –∫–æ–º–∞–Ω–¥–∏ –∑ –Ω–∞–¥–∑–≤–∏—á–∞–π–Ω–æ—é –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü—ñ—î—é –¥–æ–≤—ñ—Ä–∏ —Ç–∞ –æ—á—ñ–∫—É–≤–∞–Ω—å.'
            },
            motivators: ['Team achievement', 'Process improvement', 'Professional growth', 'Trust'],
            demotivators: ['Unclear responsibilities', 'Time pressure', 'Interpersonal conflicts'],
            conflictStyle: 'Accommodating',
            conflictDescription: '–°—Ö–∏–ª—å–Ω–∏–π –ø–æ—Å—Ç—É–ø–∞—Ç–∏—Å—è –∑–∞—Ä–∞–¥–∏ –≥–∞—Ä–º–æ–Ω—ñ—ó, —â–æ –º–æ–∂–µ –Ω–∞–∫–æ–ø–∏—á—É–≤–∞—Ç–∏ –Ω–µ–≤–∏—Ä—ñ—à–µ–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è.',
            risks: [
                { type: '–ù–∞–¥—Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–∞—Ü—ñ—è', level: 'high', description: '"–ì–æ—Ä–ª–æ –ø–ª—è—à–∫–∏" –≤ —É—Ö–≤–∞–ª–µ–Ω–Ω—ñ —Ä—ñ—à–µ–Ω—å' },
                { type: '–ü–µ—Ä—Ñ–µ–∫—Ü—ñ–æ–Ω—ñ–∑–º', level: 'low', description: '–ó–∞—Ç—Ä–∏–º–∫–∏ —á–µ—Ä–µ–∑ –ø—Ä–∞–≥–Ω–µ–Ω–Ω—è —ñ–¥–µ–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É' }
            ],
            ...sociometricData['1001']
        },
        {
            id: '1004',
            code: '1004',
            name: 'Igor Bordunov',
            firstName: 'Igor',
            role: 'Tender Manager',
            company: 'Intermastra',
            department: 'Operations',
            level: 'Senior',
            scores: { communication: 3, leadership: 4, trust: 4, collaboration: 3, conflict: 3 },
            preferred: [],
            leastPreferred: [],
            innovator: true,
            leader: false,
            quote: '–ö–æ–ª–µ–≥–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—ñ–¥—á—É–≤–∞—Ç–∏ –±—ñ–ª—å—à–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ –∑–∞ –∑–∞–≤–¥–∞–Ω–Ω—è, —è–∫—ñ –≤–æ–Ω–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å.',
            insights: {
                strength: '–Ü–Ω–Ω–æ–≤–∞—Ü—ñ–π–Ω—ñ—Å—Ç—å, —Å–∏—Å—Ç–µ–º–Ω–µ –º–∏—Å–ª–µ–Ω–Ω—è, —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç–µ–Ω–¥–µ—Ä–∞–º–∏',
                challenge: '–í–≤–∞–∂–∞—î, —â–æ –∫–æ–ª–µ–≥–∞–º –±—Ä–∞–∫—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ; –π–æ–≥–æ –≤–∞–∂–∫–æ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏',
                development: '–°–ø—ñ–ª—å–Ω–∏–π –≤–ø–ª–∏–≤: —Ä–æ–∑–≤–∏—Ç–æ–∫ –Ω–∞–≤–∏—á–æ–∫ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó –¥–ª—è –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è —ñ–¥–µ–π',
                keyInsight: '–ù–∞–π—Å–∏–ª—å–Ω—ñ—à–∏–π –º—ñ–∂–∫–æ–º–ø–∞–Ω—ñ–π–Ω–∏–π –º—ñ—Å—Ç, –∫—Ä–∏—Ç–∏—á–Ω–∏–π –∫–ª–µ–π –º—ñ–∂ VQ —Ç–∞ IM.'
            },
            motivators: ['Innovation implementation', 'System efficiency', 'Professional expertise', 'Independence'],
            demotivators: ['Resistance to change', 'Lack of accountability', 'Inefficient processes'],
            conflictStyle: 'Competing',
            conflictDescription: '–ù–∞–ø–æ–ª–µ–≥–ª–∏–≤–∏–π —É –≤—ñ–¥—Å—Ç–æ—é–≤–∞–Ω–Ω—ñ —Å–≤–æ—î—ó –ø–æ–∑–∏—Ü—ñ—ó, –º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–∞–ø—Ä—É–≥—É.',
            risks: [
                { type: '–ü–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è', level: 'high', description: '–í–∏—Å–Ω–∞–∂–µ–Ω–Ω—è –≤—ñ–¥ –Ω–µ–≤–∏–¥–∏–º–æ—ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—ó' },
                { type: '–†–∏–≥—ñ–¥–Ω—ñ—Å—Ç—å', level: 'medium', description: '–ù–µ–ø–æ—Å—Ç—É–ø–ª–∏–≤—ñ—Å—Ç—å —É –ø–æ–≥–ª—è–¥–∞—Ö' }
            ],
            ...sociometricData['1004']
        },
        {
            id: '1006',
            code: '1006',
            name: 'Rami Mando',
            firstName: 'Rami',
            role: 'Sales Manager',
            company: 'Intermastra',
            department: 'Sales',
            level: 'Middle',
            scores: { communication: 5, leadership: 5, trust: 5, collaboration: 5, conflict: 5 },
            preferred: [],
            leastPreferred: [],
            innovator: false,
            leader: false,
            insights: {
                strength: '–ü–æ–∑–∏—Ç–∏–≤–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è, –∑–∞–∫—É–ø—ñ–≤–ª—ñ, —Å–∏–ª—å–Ω—ñ –≤—ñ–¥–Ω–æ—Å–∏–Ω–∏',
                challenge: '–ù–µ –±–∞—á–∏—Ç—å –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ–π–Ω–∏—Ö –±–∞—Ä\'—î—Ä—ñ–≤',
                development: '–ö—É–ª—å—Ç—É—Ä–Ω–∏–π –∞–º–±–∞—Å–∞–¥–æ—Ä: –º–æ–¥–µ–ª—å –ø–æ–∑–∏—Ç–∏–≤–Ω–æ—ó —Å–ø—ñ–≤–ø—Ä–∞—Ü—ñ',
                keyInsight: '–°—Ç–∞–±—ñ–ª—å–Ω–∏–π —Ç–æ–ø-3, –∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω–∏–π –º—ñ—Å—Ç —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ —Ä—ñ–≤–Ω—è –º—ñ–∂ –∫–æ–º–ø–∞–Ω—ñ—è–º–∏.'
            },
            motivators: ['Positive relationships', 'Team harmony', 'Professional growth', 'Stability'],
            demotivators: ['Conflict', 'Negative atmosphere', 'Lack of support'],
            conflictStyle: 'Collaborating',
            conflictDescription: '–ï—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –≤–∑–∞—î–º–æ–≤–∏–≥—ñ–¥–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è, —Å–ø—Ä–∏—è—î –∫–æ–º–∞–Ω–¥–Ω—ñ–π –≥–∞—Ä–º–æ–Ω—ñ—ó.',
            risks: [
                { type: '–ù–∞–¥–º—ñ—Ä–Ω–∏–π –æ–ø—Ç–∏–º—ñ–∑–º', level: 'low', description: '–ú–æ–∂–µ –Ω–µ –ø–æ–º—ñ—á–∞—Ç–∏ —Ä–µ–∞–ª—å–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º' },
                { type: '–ö–æ–Ω—Ñ–æ—Ä–º—ñ–∑–º', level: 'low', description: '–£–Ω–∏–∫–∞–Ω–Ω—è –Ω–µ–ø–æ–ø—É–ª—è—Ä–Ω–∏—Ö, –∞–ª–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö —Ä—ñ—à–µ–Ω—å' }
            ],
            ...sociometricData['1006']
        },
        {
            id: '1007',
            code: '1007',
            name: 'Nik Sakhno',
            firstName: 'Nik',
            role: 'Procurement',
            company: 'Vagoteq',
            department: 'Operations',
            level: 'Middle',
            scores: { communication: 4, leadership: 5, trust: 4, collaboration: 4, conflict: 4 },
            preferred: [],
            leastPreferred: [],
            innovator: false,
            leader: false,
            quote: '–í–µ–ª–∏–∫–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ –±–∞–≥–∞—Ç—å–æ—Ö —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤ –∑–∞–≤–∞–∂–∞—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ä–æ–±–æ—Ç—É –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ç–∞ –∑–∞ –ø–ª–∞–Ω–æ–º.',
            insights: {
                strength: '–ó–∞–∫—É–ø—ñ–≤–ª—ñ, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—è –ª–æ–≥—ñ—Å—Ç–∏–∫–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–ø—ñ–ª—å–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤',
                challenge: '"–í–µ–ª–∏–∫–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è" –∑–∞–≤–∞–∂–∞—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ–π —Ä–æ–±–æ—Ç—ñ',
                development: '–ü—Ä–æ–∞–∫—Ç–∏–≤–Ω–∞ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è: –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–æ–∑–æ—Ä–æ—Å—Ç—ñ –ø—Ä–æ—Ü–µ—Å—ñ–≤',
                keyInsight: '–ù–∞–π–≥—ñ—Ä—à–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å —Å–∞–º–æ–æ—Ü—ñ–Ω–∫–∏ (MAE=2.25), –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π “ë—Ä—É–Ω—Ç –¥–ª—è —Ñ—Ä—É—Å—Ç—Ä–∞—Ü—ñ—ó.'
            },
            motivators: ['Efficiency', 'Clear timelines', 'Team support', 'Achievement'],
            demotivators: ['Overload', 'Unclear priorities', 'Interpersonal tensions'],
            conflictStyle: 'Compromising',
            conflictDescription: '–ì–æ—Ç–æ–≤–∏–π –¥–æ –∫–æ–º–ø—Ä–æ–º—ñ—Å—ñ–≤, –∞–ª–µ –º–æ–∂–µ –ø–æ—Å—Ç—É–ø–∞—Ç–∏—Å—è –≤–∞–∂–ª–∏–≤–∏–º–∏ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏.',
            risks: [
                { type: '–†–æ–∑—á–∞—Ä—É–≤–∞–Ω–Ω—è', level: 'high', description: '–ü—Ä–∏ –∫–æ—Ä–µ–∫—Ü—ñ—ó –∑–∞–≤–∏—â–µ–Ω–∏—Ö –æ—á—ñ–∫—É–≤–∞–Ω—å' },
                { type: '–°—Ç—Ä–µ—Å', level: 'medium', description: '–ü–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ –Ω–∞–º–∞–≥–∞–Ω–Ω—è –≤—Å—ñ–º –¥–æ–≥–æ–¥–∏—Ç–∏' }
            ],
            ...sociometricData['1007']
        },
        {
            id: '1002',
            code: '1002',
            name: 'Oleg Faleev',
            firstName: 'Oleg',
            role: 'Sales Manager',
            company: 'Vagoteq',
            department: 'Sales',
            level: 'Middle',
            scores: { communication: 5, leadership: 5, trust: 5, collaboration: 5, conflict: 5 },
            preferred: [],
            leastPreferred: [],
            innovator: true,
            leader: false,
            quote: '–ë—Ä–∞–∫ —á–∞—Å—É –Ω–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–µ—Ç–∞–ª—å–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ–π.',
            insights: {
                strength: '–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è CRM, —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ–π, —Å–∏–ª—å–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è',
                challenge: '–ë—Ä–∞–∫ —á–∞—Å—É –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é –ø—Ä–æ—Ü–µ—Å—ñ–≤',
                development: '–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –ø—Ä–æ—Ü–µ—Å—ñ–≤: —Ñ–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è –∑–Ω–∞–Ω—å –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –∫–æ–ª–µ–≥',
                keyInsight: '–°—Ç–∞–±—ñ–ª—å–Ω–µ –ø–µ—Ä–µ–æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (+1.25), —Ä–∏–∑–∏–∫ –º—ñ–∫—Ä–æ–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—É –∑ –±–æ–∫—É –ª—ñ–¥–µ—Ä–∞.'
            },
            motivators: ['Excellence', 'System building', 'Autonomy', 'Efficiency'],
            demotivators: ['Time constraints', 'Interruptions', 'Perceived incompetence'],
            conflictStyle: 'Competing',
            conflictDescription: '–í–∏—Å–æ–∫—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏ –º–æ–∂—É—Ç—å —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–∞–ø—Ä—É–≥—É –∑ —Ç–∏–º–∏, —Ö—Ç–æ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è–º.',
            risks: [
                { type: '–ù–µ—Ç–µ—Ä–ø–∏–º—ñ—Å—Ç—å', level: 'high', description: '–ö—Ä–∏—Ç–∏—á–Ω—ñ—Å—Ç—å –¥–æ –∫–æ–ª–µ–≥ –∑ –Ω–∏–∂—á–∏–º–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º–∏' },
                { type: '–Ü–∑–æ–ª—è—Ü—ñ—è', level: 'medium', description: '–î–∏—Å—Ç–∞–Ω—Ü—ñ—é–≤–∞–Ω–Ω—è –≤—ñ–¥ "—Å–ª–∞–±—à–∏—Ö" –∫–æ–ª–µ–≥' }
            ],
            ...sociometricData['1002']
        },
        {
            id: '1009',
            code: '1009',
            name: 'Antonia Walter',
            firstName: 'Antonia',
            role: 'Internal Calculations',
            company: 'Vagoteq',
            department: 'Finance',
            level: 'Middle',
            scores: { communication: 4, leadership: 4, trust: 4, collaboration: 3, conflict: 2 },
            preferred: [],
            leastPreferred: [],
            innovator: false,
            leader: false,
            quote: '–ù–µ–∑—Ä–æ–∑—É–º—ñ–ª—ñ —Ä–æ–ª—ñ —Ç–∞ –æ–±–æ–≤\'—è–∑–∫–∏.',
            insights: {
                strength: '–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —É —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∞—Ö/—Ü—ñ–Ω–æ—É—Ç–≤–æ—Ä–µ–Ω–Ω—ñ, –≥–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å –¥–æ–ø–æ–º–æ–≥—Ç–∏',
                challenge: '–ù–∞–∑–≤–∞–ª–∞ —Å–≤–æ–≥–æ –∫–µ—Ä—ñ–≤–Ω–∏–∫–∞ Alex —è–∫ –Ω–∞–π–º–µ–Ω—à –±–∞–∂–∞–Ω–æ–≥–æ –∫–æ–ª–µ–≥—É',
                development: '–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–∏–π –∫–æ–Ω—Ñ–ª—ñ–∫—Ç: –Ω–∞–≤–∏—á–∫–∏ —Ñ–æ—Ä–º—É–ª—é–≤–∞–Ω–Ω—è –ø–æ—Ç—Ä–µ–± –ø—Ä–æ—Ü–µ—Å—É',
                keyInsight: '–í–∏—Å–æ–∫–∞ –ø–æ–ª—è—Ä–∏–∑–∞—Ü—ñ—è –¥—É–º–æ–∫ (std trust 2.05), –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å —Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è.'
            },
            motivators: ['Clear structure', 'Recognition of expertise', 'Work-life balance', 'Respect'],
            demotivators: ['Role ambiguity', 'Conflicting priorities', 'Lack of appreciation'],
            conflictStyle: 'Avoiding',
            conflictDescription: '–£–Ω–∏–∫–∞—î –ø—Ä—è–º–æ—ó –∫–æ–Ω—Ñ—Ä–æ–Ω—Ç–∞—Ü—ñ—ó, –Ω–∞–∫–æ–ø–∏—á—É—î —Ñ—Ä—É—Å—Ç—Ä–∞—Ü—ñ—é –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ.',
            risks: [
                { type: '–ï–º–æ—Ü—ñ–π–Ω–µ –≤–∏–≥–æ—Ä–∞–Ω–Ω—è', level: 'high', description: '–ù–∞–∫–æ–ø–∏—á–µ–Ω–Ω—è –Ω–µ–≤–∏—Å–ª–æ–≤–ª–µ–Ω–∏—Ö –ø—Ä–µ—Ç–µ–Ω–∑—ñ–π' },
                { type: '–°–∞–±–æ—Ç–∞–∂', level: 'low', description: '–ù–µ–ø—Ä—è–º–µ –≤–∏—Ä–∞–∂–µ–Ω–Ω—è –Ω–µ–≤–¥–æ–≤–æ–ª–µ–Ω–Ω—è' }
            ],
            ...sociometricData['1009']
        },
        {
            id: '1003',
            code: '1003',
            name: 'Maivi Cap',
            firstName: 'Maivi',
            role: 'Sales Manager',
            company: 'Vagoteq',
            department: 'Sales',
            level: 'Junior',
            scores: { communication: 3, leadership: 5, trust: 5, collaboration: 3, conflict: 3 },
            preferred: [],
            leastPreferred: [],
            innovator: true,
            leader: false,
            quote: 'Depends on with whom I talk...',
            insights: {
                strength: '–ü—Ä–æ–¥–∞–∂—ñ, —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏, –¥–æ–ø–æ–º–æ–≥–∞',
                challenge: '–ö–æ–º—É–Ω—ñ–∫–∞—Ü—ñ–π–Ω—ñ –±–∞—Ä\'—î—Ä–∏ —á–µ—Ä–µ–∑ "—Ä—ñ–∑–Ω—ñ –º–æ–≤–∏"',
                development: '–ß—ñ—Ç–∫—ñ—Å—Ç—å —Ä–æ–ª—ñ: –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–æ—á–Ω–æ—ó —Ä–æ–ª—ñ —Ç–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó',
                keyInsight: '–ù–µ–¥–æ–æ—Ü—ñ–Ω—é—î —Å–µ–±–µ (-0.38), –ø–æ—Ç–µ–Ω—Ü—ñ–∞–ª –¥–ª—è –ø—ñ–¥–Ω—è—Ç—Ç—è —á–µ—Ä–µ–∑ –≤–∏–¥–∏–º—ñ micro-wins.'
            },
            motivators: ['Learning opportunities', 'Positive feedback', 'Clear communication', 'Belonging'],
            demotivators: ['Communication barriers', 'Feeling excluded', 'Unclear expectations'],
            conflictStyle: 'Accommodating',
            conflictDescription: '–ê–¥–∞–ø—Ç—É—î—Ç—å—Å—è –ø—ñ–¥ —Å–ø—ñ–≤—Ä–æ–∑–º–æ–≤–Ω–∏–∫–∞, –º–æ–∂–µ –≤—Ç—Ä–∞—á–∞—Ç–∏ –≤–ª–∞—Å–Ω—É –ø–æ–∑–∏—Ü—ñ—é.',
            risks: [
                { type: '–í—Ç—Ä–∞—Ç–∞ —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ', level: 'medium', description: '–ù–∞–¥–º—ñ—Ä–Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü—ñ—è –ø—ñ–¥ —ñ–Ω—à–∏—Ö' },
                { type: '–ü–∞—Å–∏–≤–Ω—ñ—Å—Ç—å', level: 'high', description: '–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—è —ñ–Ω—ñ—Ü—ñ–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å' }
            ],
            ...sociometricData['1003']
        },
        {
            id: '1008',
            code: '1008',
            name: 'Yana',
            firstName: 'Yana',
            role: 'Personal Assistant',
            company: 'Vagoteq',
            department: 'Administration',
            level: 'Junior',
            scores: { communication: 5, leadership: 5, trust: 5, collaboration: 5, conflict: 5 },
            preferred: [],
            leastPreferred: [],
            innovator: false,
            leader: false,
            insights: {
                strength: '–î—ñ—î –≤ —ñ–Ω—Ç–µ—Ä–µ—Å–∞—Ö –∫–æ–º–∞–Ω–¥–∏, –∫–æ–æ—Ä–¥–∏–Ω—É—î –∑—É—Å—Ç—Ä—ñ—á—ñ',
                challenge: '–ñ–æ–¥–Ω–∏—Ö –Ω–µ –≤–∏—è–≤–ª–µ–Ω–æ',
                development: '–§–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è —Å–∏—Å—Ç–µ–º –ø—ñ–¥—Ç—Ä–∏–º–∫–∏',
                keyInsight: '–ù–∏–∑—å–∫–∞ –≤–∏–¥–∏–º—ñ—Å—Ç—å (0 –≤—Ö–æ–¥—ñ–≤ –≤ —Ç–æ–ø-3), —Ä–∏–∑–∏–∫ –Ω–µ–≤–∏–¥–∏–º–æ—Å—Ç—ñ —Ç–∞ –¥–µ–º–æ—Ç–∏–≤–∞—Ü—ñ—ó.'
            },
            motivators: ['Being helpful', 'Organization', 'Appreciation', 'Clear tasks'],
            demotivators: ['Chaos', 'Being overlooked', 'Conflicting instructions'],
            conflictStyle: 'Accommodating',
            conflictDescription: '–ü—ñ–¥—Ç—Ä–∏–º—É—î –≤—Å—ñ—Ö, —É–Ω–∏–∫–∞—î –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤, —Å—Ç–≤–æ—Ä—é—î –ø–æ–∑–∏—Ç–∏–≤–Ω—É –∞—Ç–º–æ—Å—Ñ–µ—Ä—É.',
            risks: [
                { type: '–ü–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è', level: 'medium', description: '–ë–µ—Ä–µ –Ω–∞ —Å–µ–±–µ –∑–∞–±–∞–≥–∞—Ç–æ –∑–∞–≤–¥–∞–Ω—å' },
                { type: '–ù–µ–≤–∏–¥–∏–º—ñ—Å—Ç—å', level: 'high', description: '–í–Ω–µ—Å–æ–∫ –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–¥–æ–æ—Ü—ñ–Ω–µ–Ω–∏–π' }
            ],
            ...sociometricData['1008']
        },
        {
            id: '1005',
            code: '1005',
            name: 'Viktoria Hilova',
            firstName: 'Viktoria',
            role: 'Personal Assistant',
            company: 'Intermastra',
            department: 'Administration',
            level: 'Junior',
            scores: { communication: 5, leadership: 5, trust: 5, collaboration: 5, conflict: 5 },
            preferred: [],
            leastPreferred: [],
            innovator: false,
            leader: false,
            quote: '–ü–æ—Ç—Ä–µ–±–∞ –≤ –±—ñ–ª—å—à —Å—É—á–∞—Å–Ω–∏—Ö —Ü–∏—Ñ—Ä–æ–≤–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö.',
            insights: {
                strength: '–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∞–º–∏, –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω—ñ –Ω–∞–≤–∏—á–∫–∏',
                challenge: '–°—Ç–∏—Å–ª—ñ —Ç–µ—Ä–º—ñ–Ω–∏; –ø–æ—Ç—Ä–µ–±–∞ –≤ —Ü–∏—Ñ—Ä–æ–≤–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö',
                development: '–ê–¥–≤–æ–∫–∞—Ü—ñ—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—Ä–æ—Ü–µ—Å—ñ–≤',
                keyInsight: '–ù–∞–π–Ω–∏–∂—á–∞ –ø–æ–∑–∏—Ü—ñ—è, –∞–Ω–æ–º–∞–ª—å–Ω—ñ —à–∞–±–ª–æ–Ω–Ω—ñ –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è (8/6) ‚Üí –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∞ –∞–ø–∞—Ç—ñ—è.'
            },
            motivators: ['Modern tools', 'Efficiency', 'Clear processes', 'Team support'],
            demotivators: ['Outdated systems', 'Inefficiency', 'Tight deadlines'],
            conflictStyle: 'Collaborating',
            conflictDescription: '–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ –ø—Ä–æ–ø–æ–Ω—É—î –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è, –¥–∏–ø–ª–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏—Ä—ñ—à—É—î –ø–∏—Ç–∞–Ω–Ω—è.',
            risks: [
                { type: '–í–∏—Ö—ñ–¥', level: 'high', description: 'Learned helplessness —Ç–∞ –¥–µ–º–æ—Ç–∏–≤–∞—Ü—ñ—è' },
                { type: '–í–∏–≥–æ—Ä–∞–Ω–Ω—è', level: 'low', description: '–ß–µ—Ä–µ–∑ –ø–æ—Å—Ç—ñ–π–Ω—ñ —Å—Ç–∏—Å–ª—ñ —Ç–µ—Ä–º—ñ–Ω–∏' }
            ],
            ...sociometricData['1005']
        }
    ]
};

// Process mutual connections
mutualTop3Ownership.forEach(([id1, id2]) => {
    const member1 = teamData.members.find(m => m.id === id1);
    const member2 = teamData.members.find(m => m.id === id2);
    if (member1 && member2) {
        if (!member1.preferred.includes(id2)) member1.preferred.push(id2);
        if (!member2.preferred.includes(id1)) member2.preferred.push(id1);
    }
});

// Add remaining connections based on top3 count
teamData.members.forEach(member => {
    const targetCount = member.top3CountOwnership;
    while (member.preferred.length < Math.min(targetCount, 3)) {
        const potentialTarget = teamData.members.find(m => 
            m.id !== member.id && 
            !member.preferred.includes(m.id) &&
            m.meanRankOwnership < 4
        );
        if (potentialTarget) {
            member.preferred.push(potentialTarget.id);
        } else {
            break;
        }
    }
});

// Add some negative connections based on analysis
const negativeConnections = {
    'stas': ['1003', '1009'], // Stas ‚Üí Maivi, Antonia
    'alex': ['1007'], // Alex ‚Üí Nik
    'antonia': ['1001', '1002'], // Antonia ‚Üí Alex, Oleg
    'oleg': ['1009', '1003'], // Oleg ‚Üí Antonia, Maivi
    'igor': ['1002', '1007'], // Igor ‚Üí Oleg, Nik
    'dany': ['1003', '1004'], // Dany ‚Üí Maivi, Igor
    'nik': ['1004'], // Nik ‚Üí Igor
    'maivi': ['1002'], // Maivi ‚Üí Oleg
    'rami': ['1003'] // Rami ‚Üí Maivi
};

// Add C-Level leaders
teamData.members.unshift(
    {
        id: 'stas',
        code: 'stas',
        name: 'Stas Sakhno',
        firstName: 'Stas',
        role: 'Shareholder / Strategy',
        company: 'Vagoteq',
        department: 'Management',
        level: 'C-Level',
        scores: { communication: 4, leadership: 3, trust: 5, collaboration: 3, conflict: 5 },
        preferred: ['1001', '1004'], // Alex, Igor
        leastPreferred: negativeConnections.stas || [],
        innovator: true,
        leader: true,
        quote: '–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –≤—ñ–¥—á—É—Ç—Ç—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ –∑–∞ —Å–≤–æ—é —Å—Ñ–µ—Ä—É.',
        insights: {
            strength: '–°—Ç—Ä–∞—Ç–µ–≥—ñ—á–Ω–µ –±–∞—á–µ–Ω–Ω—è, —ñ–Ω–Ω–æ–≤–∞—Ü—ñ—ó, —é—Ä–∏–¥–∏—á–Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—è',
            challenge: '–°–ø—Ä–∏–π–º–∞—î "–≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –≤—ñ–¥—á—É—Ç—Ç—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ" –≤ –∫–æ–º–∞–Ω–¥—ñ',
            development: '–û–ø–µ—Ä–∞—Ü—ñ–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó: –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–∏—Å–æ–∫–æ—Ä—ñ–≤–Ω–µ–≤–∏—Ö —Ü—ñ–ª–µ–π –Ω–∞ —á—ñ—Ç–∫—ñ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏',
            keyInsight: '–ì–æ–ª–æ–≤–Ω–∏–π —Å—Ç—Ä–∞—Ç–µ–≥, –∞–ª–µ –≤–∫–∞–∑–∞–≤ Maivi —Ç–∞ Antonia —è–∫ –Ω–∞–π–º–µ–Ω—à –±–∞–∂–∞–Ω–∏—Ö.'
        },
        motivators: ['Innovation', 'Strategic impact', 'Autonomy', 'Results'],
        demotivators: ['Micromanagement', 'Lack of accountability', 'Slow decision-making'],
        conflictStyle: 'Competing',
        conflictDescription: '–ü—Ä—è–º–∏–π, —Ä—ñ—à—É—á–∏–π –ø—ñ–¥—Ö—ñ–¥. –®–≤–∏–¥–∫–æ –ø—Ä–∏–π–º–∞—î —Ä—ñ—à–µ–Ω–Ω—è, –º–æ–∂–µ –∑–¥–∞–≤–∞—Ç–∏—Å—å –∞–≤—Ç–æ—Ä–∏—Ç–∞—Ä–Ω–∏–º.',
        risks: [
            { type: '–ê–≤—Ç–æ—Ä–∏—Ç–∞—Ä–Ω—ñ—Å—Ç—å', level: 'medium', description: '–ú–æ–∂–µ –ø—Ä–∏–¥—É—à—É–≤–∞—Ç–∏ —ñ–Ω—ñ—Ü—ñ–∞—Ç–∏–≤—É —ñ–Ω—à–∏—Ö' },
            { type: '–Ü–∑–æ–ª—è—Ü—ñ—è', level: 'low', description: '–î–∏—Å—Ç–∞–Ω—Ü—ñ—é–≤–∞–Ω–Ω—è –≤—ñ–¥ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∏—Ö –ø–∏—Ç–∞–Ω—å' }
        ],
        meanRankOwnership: 2.0,
        meanRankTrust: 2.2,
        stdOwnership: 0.9,
        stdTrust: 1.0,
        top3CountOwnership: 6,
        top3CountTrust: 6,
        statusScoreOwnership: 0.85,
        statusScoreTrust: 0.82,
        selfMAEOwnership: 0.5,
        selfMAETrust: 0.6,
        biasOwnership: 0.3,
        biasTrust: 0.4,
        accuracyOwnership: 85,
        accuracyTrust: 80
    },
    {
        id: 'dany',
        code: 'dany',
        name: 'Dany Mandou',
        firstName: 'Dany',
        role: 'External Sales Support',
        company: 'Intermastra',
        department: 'Sales',
        level: 'C-Level',
        scores: { communication: 3, leadership: 3, trust: 4, collaboration: 3, conflict: 4 },
        preferred: ['1001', '1006'], // Alex, Rami
        leastPreferred: negativeConnections.dany || [],
        innovator: false,
        leader: true,
        quote: '–ü—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω–æ, —â–æ –ª—é–¥–∏ –º–∞—é—Ç—å –∑–∞–≤–¥–∞–Ω–Ω—è –≤—ñ–¥ –æ–±–æ—Ö –∫–æ–º–ø–∞–Ω—ñ–π... —ñ–Ω–æ–¥—ñ –Ω–µ–∑—Ä–æ–∑—É–º—ñ–ª–æ, —Ö—Ç–æ —â–æ –º–∞—î —Ä–æ–±–∏—Ç–∏... —Ç—Ä–æ—Ö–∏ —Ö–∞–æ—Å.',
        insights: {
            strength: '–í—ñ–¥–Ω–æ—Å–∏–Ω–∏ –∑ –∫–ª—ñ—î–Ω—Ç–∞–º–∏, –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∏–π –¥—Ä–∞–π–≤, –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –∫–æ–º–∞–Ω–¥–∏',
            challenge: '–í—ñ–¥—á—É–≤–∞—î —Å–µ–±–µ –Ω–µ–¥–æ–æ—Ü—ñ–Ω–µ–Ω–∏–º; —Ä–æ–∑—á–∞—Ä–æ–≤–∞–Ω–∏–π "—Ö–∞–æ—Å–æ–º" –≤—ñ–¥ –∑–ª–∏—Ç—Ç—è VQ/IM',
            development: '–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ø–æ–≤–Ω–æ–≤–∞–∂–µ–Ω—å: –ø–µ—Ä–µ—Ö—ñ–¥ –≤—ñ–¥ –≤–∏—Ä—ñ—à—É–≤–∞—á–∞ –ø—Ä–æ–±–ª–µ–º –¥–æ –∫–æ—É—á–∞ –∫–æ–º–∞–Ω–¥–∏',
            keyInsight: '–†–æ–∑—á–∞—Ä–æ–≤–∞–Ω–∏–π –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—é –≤—ñ–¥ –Ω—å–æ–≥–æ, –∞–ª–µ –π–æ–≥–æ —Å—Ç–∏–ª—å –∫–µ—Ä—ñ–≤–Ω–∏—Ü—Ç–≤–∞ —Å–ø—Ä–∏—è—î —Ü—ñ–π –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ.'
        },
        motivators: ['Team success', 'Client satisfaction', 'Clear processes', 'Recognition'],
        demotivators: ['Unclear roles', 'Organizational chaos', 'Dependency burden'],
        conflictStyle: 'Collaborating',
        conflictDescription: '–®—É–∫–∞—î win-win —Ä—ñ—à–µ–Ω–Ω—è, –∞–ª–µ –º–æ–∂–µ –∑–∞—Ç—è–≥—É–≤–∞—Ç–∏ –ø—Ä–æ—Ü–µ—Å —á–µ—Ä–µ–∑ –ø—Ä–∞–≥–Ω–µ–Ω–Ω—è –∫–æ–Ω—Å–µ–Ω—Å—É—Å—É.',
        risks: [
            { type: '–í–∏–≥–æ—Ä–∞–Ω–Ω—è', level: 'high', description: '–ü–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ –≤—ñ–¥—á—É—Ç—Ç—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ –∑–∞ –≤—Å—ñ—Ö' },
            { type: '–ü–∞—Å–∏–≤–Ω–∞ –∞–≥—Ä–µ—Å—ñ—è', level: 'medium', description: '–ù–µ–ø—Ä—è–º–µ –≤–∏—Ä–∞–∂–µ–Ω–Ω—è —Ñ—Ä—É—Å—Ç—Ä–∞—Ü—ñ—ó' }
        ],
        meanRankOwnership: 2.5,
        meanRankTrust: 2.3,
        stdOwnership: 1.1,
        stdTrust: 0.9,
        top3CountOwnership: 5,
        top3CountTrust: 6,
        statusScoreOwnership: 0.78,
        statusScoreTrust: 0.81,
        selfMAEOwnership: 0.7,
        selfMAETrust: 0.6,
        biasOwnership: 0.4,
        biasTrust: 0.2,
        accuracyOwnership: 75,
        accuracyTrust: 82
    }
);

// Apply negative connections
Object.entries(negativeConnections).forEach(([fromId, toIds]) => {
    const member = teamData.members.find(m => m.id === fromId);
    if (member) {
        member.leastPreferred = toIds;
    }
});

// Calculate CORRECT ownership and trust indices
teamData.members.forEach(member => {
    // High status score = high position = low index value for quadrant
    member.ownershipIndex = Math.round(member.statusScoreOwnership * 100);
    member.trustIndex = Math.round(member.statusScoreTrust * 100);
});

// ===== Global State with Performance Optimizations =====
let currentView = 'metrics';
let currentLang = 'uk';
let scene, camera, renderer, controls;
let forceSimulation;
let selectedPerson = null;
let filters = {
    positive: true,
    negative: true,
    vagoteq: true,
    intermastra: true,
    incoming: true,
    outgoing: true
};
let quickInfoPerson = null;
let raycaster, mouse;
let animationPaused = false;
let animationId = null;
let legendVisible = false; // Start with legend hidden
let sceneObjects = {
    nodes: new Map(),
    nodeObjects: [],
    sprites: [],
    connections: [],
    levelRings: []
};

// Performance optimization
let renderRequested = false;
const preferReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

function requestRender() {
    if (!renderRequested && !preferReducedMotion) {
        renderRequested = true;
        requestAnimationFrame(() => {
            renderRequested = false;
            if (renderer && scene && camera) {
                renderer.render(scene, camera);
            }
        });
    }
}

// ===== Initialize Application =====
document.addEventListener('DOMContentLoaded', () => {
    initializeLanguage();
    checkMobile();
    setupEventListeners();
    populatePersonFilter();
    updateMetrics();
    addGlossaryButton();
    updateVisualization();
    showNotification(t('notification.welcome'), 'success');
});

// ===== Add Glossary Button =====
function addGlossaryButton() {
    const navButtons = document.querySelector('.nav-buttons');
    const glossaryBtn = document.createElement('button');
    glossaryBtn.className = 'nav-btn';
    glossaryBtn.dataset.view = 'glossary';
    glossaryBtn.innerHTML = `<i class="fas fa-book"></i><span data-i18n="nav.glossary">${t('nav.glossary')}</span>`;
    navButtons.appendChild(glossaryBtn);
    glossaryBtn.addEventListener('click', () => switchView('glossary'));
}

// ===== Language Functions =====
function initializeLanguage() {
    const savedLang = localStorage.getItem('teamPulseLang') || 'uk';
    currentLang = savedLang;
    updateLanguage();
}

function updateLanguage() {
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        element.textContent = t(key);
    });
    
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.lang === currentLang);
    });
    
    updatePageTitle();
}

function t(key) {
    return translations[currentLang][key] || translations['en'][key] || key;
}

function updatePageTitle() {
    const titles = {
        '3d': 'titles.3d',
        'force': 'titles.force',
        'circular': 'titles.circular',
        'heatmap': 'titles.heatmap',
        'development': 'titles.development',
        'analysis': 'titles.analysis',
        'metrics': 'titles.metrics',
        'glossary': 'titles.glossary'
    };
    document.getElementById('pageTitle').textContent = t(titles[currentView]);
}

// ===== Mobile Check =====
function checkMobile() {
    if (window.innerWidth <= 768) {
        document.getElementById('mobileWarning').style.display = 'flex';
    }
}

function closeMobileWarning() {
    document.getElementById('mobileWarning').style.display = 'none';
}

// ===== Event Listeners =====
function setupEventListeners() {
    // Language switcher
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            currentLang = e.target.dataset.lang;
            localStorage.setItem('teamPulseLang', currentLang);
            updateLanguage();
            updateVisualization();
        });
    });
    
    // Navigation buttons
    document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            const view = e.currentTarget.dataset.view;
            switchView(view);
        });
    });

    // Filters
    document.getElementById('filterPositive').addEventListener('change', updateFilters);
    document.getElementById('filterNegative').addEventListener('change', updateFilters);
    document.getElementById('filterVQ').addEventListener('change', updateFilters);
    document.getElementById('filterIM').addEventListener('change', updateFilters);
    document.getElementById('filterIncoming').addEventListener('change', updateFilters);
    document.getElementById('filterOutgoing').addEventListener('change', updateFilters);
    document.getElementById('personFilter').addEventListener('change', updateFilters);

    // Controls
    document.getElementById('zoomIn').addEventListener('click', () => zoomView(1.2));
    document.getElementById('zoomOut').addEventListener('click', () => zoomView(0.8));
    document.getElementById('resetView').addEventListener('click', resetView);
    document.getElementById('playPauseBtn').addEventListener('click', toggleAnimation);
    document.getElementById('screenshotBtn').addEventListener('click', takeScreenshot);
    document.getElementById('fullscreenBtn').addEventListener('click', toggleFullscreen);
    document.getElementById('exportBtn').addEventListener('click', exportData);
    
    // Toggle legend button
    const toggleLegendBtn = document.createElement('button');
    toggleLegendBtn.className = 'control-btn';
    toggleLegendBtn.id = 'toggleLegend';
    toggleLegendBtn.title = 'Toggle Legend';
    toggleLegendBtn.innerHTML = '<i class="fas fa-list"></i>';
    toggleLegendBtn.addEventListener('click', toggleLegend);
    document.querySelector('.zoom-controls').appendChild(toggleLegendBtn);

    // Modal
    document.getElementById('modalClose').addEventListener('click', closeModal);
    document.getElementById('detailsModal').addEventListener('click', (e) => {
        if (e.target === e.currentTarget) closeModal();
    });

    // Quick info popup close on click outside
    document.addEventListener('click', (e) => {
        const quickInfo = document.getElementById('quickInfo');
        if (!quickInfo.contains(e.target) && !e.target.closest('.node') && !e.target.closest('circle')) {
            quickInfo.classList.remove('active');
        }
    });

    // Window resize
    window.addEventListener('resize', debounce(handleResize, 250));
}

// Performance helper - debounce
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// ===== View Management =====
function switchView(view) {
    currentView = view;
    
    document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.view === view);
    });
    
    updatePageTitle();
    
    document.getElementById('infoPanel3D').style.display = view === '3d' ? 'block' : 'none';
    document.getElementById('forceFilters').style.display = view === 'force' ? 'block' : 'none';
    
    updateVisualization();
}

// ===== Data Filtering =====
function updateFilters() {
    filters.positive = document.getElementById('filterPositive').checked;
    filters.negative = document.getElementById('filterNegative').checked;
    filters.vagoteq = document.getElementById('filterVQ').checked;
    filters.intermastra = document.getElementById('filterIM').checked;
    filters.incoming = document.getElementById('filterIncoming').checked;
    filters.outgoing = document.getElementById('filterOutgoing').checked;
    
    updateVisualization();
}

function getFilteredData() {
    let members = [...teamData.members];
    
    if (!filters.vagoteq) {
        members = members.filter(m => m.company !== 'Vagoteq');
    }
    if (!filters.intermastra) {
        members = members.filter(m => m.company !== 'Intermastra');
    }
    
    const personFilter = document.getElementById('personFilter').value;
    if (personFilter !== 'all') {
        const person = members.find(m => m.id === personFilter);
        if (person) {
            const relatedIds = new Set([person.id]);
            person.preferred.forEach(id => relatedIds.add(id));
            person.leastPreferred.forEach(id => relatedIds.add(id));
            
            members.forEach(m => {
                if (m.preferred.includes(person.id) || m.leastPreferred.includes(person.id)) {
                    relatedIds.add(m.id);
                }
            });
            
            members = members.filter(m => relatedIds.has(m.id));
        }
    }
    
    return members;
}

// ===== Update Metrics =====
function updateMetrics() {
    const members = getFilteredData();
    
    // Calculate team health based on mean ranks
    const avgMeanRank = members.reduce((sum, m) => 
        sum + (m.meanRankOwnership + m.meanRankTrust) / 2, 0
    ) / members.length;
    const teamHealth = Math.round((1 - avgMeanRank / 8) * 100);
    
    // Calculate Gini coefficient (inequality)
    const giniOwnership = 0.217 * 100;
    const giniTrust = 0.226 * 100;
    const frictionIndex = Math.round((giniOwnership + giniTrust) / 2);
    
    // Role clarity (based on quotes analysis)
    const clarityScore = 35;
    
    // Engagement score based on accuracy
    const avgAccuracy = members.reduce((sum, m) => 
        sum + (m.accuracyOwnership + m.accuracyTrust) / 2, 0
    ) / members.length;
    const engagementScore = Math.round(avgAccuracy);
    
    document.getElementById('teamHealthScore').textContent = teamHealth + '%';
    document.getElementById('frictionIndex').textContent = frictionIndex + '%';
    document.getElementById('clarityScore').textContent = clarityScore + '%';
    document.getElementById('engagementScore').textContent = engagementScore + '%';
}

// ===== Populate Person Filter =====
function populatePersonFilter() {
    const select = document.getElementById('personFilter');
    
    teamData.members.forEach(member => {
        const option = document.createElement('option');
        option.value = member.id;
        option.textContent = `${member.name} (${member.company})`;
        select.appendChild(option);
    });
}

// ===== Clear Visualizations =====
function clearVisualizations() {
    // Cancel any pending animation
    if (animationId) {
        cancelAnimationFrame(animationId);
        animationId = null;
    }
    
    // Clear Three.js
    if (renderer) {
        // Dispose of all geometries and materials
        scene.traverse((object) => {
            if (object.geometry) object.geometry.dispose();
            if (object.material) {
                if (Array.isArray(object.material)) {
                    object.material.forEach(material => material.dispose());
                } else {
                    object.material.dispose();
                }
            }
        });
        
        renderer.dispose();
        const container = document.getElementById('threeContainer');
        while (container.firstChild) {
            container.removeChild(container.firstChild);
        }
        renderer = null;
        scene = null;
        camera = null;
    }
    
    // Clear objects
    sceneObjects.nodes.clear();
    sceneObjects.nodeObjects = [];
    sceneObjects.sprites = [];
    sceneObjects.connections = [];
    sceneObjects.levelRings = [];
    
    // Clear SVG
    d3.select('#svgCanvas').selectAll('*').remove();
    
    // Clear Canvas
    const canvas = document.getElementById('heatmapCanvas');
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Clear other containers
    document.getElementById('analysisContainer').innerHTML = '';
    document.getElementById('developmentContainer').innerHTML = '';
    
    // Hide all canvases
    document.getElementById('threeContainer').style.display = 'none';
    document.getElementById('svgCanvas').style.display = 'none';
    document.getElementById('heatmapCanvas').style.display = 'none';
    document.getElementById('analysisContainer').style.display = 'none';
    document.getElementById('developmentContainer').style.display = 'none';
    
    // Hide side info
    hideSideInfo();
}

// ===== Update Visualization =====
function updateVisualization() {
    clearVisualizations();
    const filteredData = getFilteredData();
    
    switch (currentView) {
        case '3d':
            render3DVisualization(filteredData);
            break;
        case 'force':
            renderForceGraph(filteredData);
            break;
        case 'circular':
            renderCircularLayout(filteredData);
            break;
        case 'heatmap':
            renderHeatmap(filteredData);
            break;
        case 'development':
            renderDevelopmentView(filteredData);
            break;
        case 'analysis':
            renderTextAnalysis(filteredData);
            break;
        case 'metrics':
            renderMetricsView(filteredData);
            break;
        case 'glossary':
            renderGlossary();
            break;
    }
}

// ===== Team Metrics View =====
function renderMetricsView(members) {
    const container = document.getElementById('analysisContainer');
    container.style.display = 'block';
    
    // Sort members by mean rank
    const sortedByOwnership = [...members].sort((a, b) => a.meanRankOwnership - b.meanRankOwnership);
    const sortedByTrust = [...members].sort((a, b) => a.meanRankTrust - b.meanRankTrust);
    
    container.innerHTML = `
        <div class="metrics-header">
            <h1>${currentLang === 'uk' ? '–î–µ—Ç–∞–ª—å–Ω—ñ –º–µ—Ç—Ä–∏–∫–∏ –∫–æ–º–∞–Ω–¥–∏' : 'Detailed Team Metrics'}</h1>
            <p>${currentLang === 'uk' ? 
                '–ö–æ–º–ø–ª–µ–∫—Å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Å–æ—Ü—ñ–æ–º–µ—Ç—Ä–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö' : 
                'Comprehensive analysis based on sociometric data'}</p>
        </div>
        
        <div class="metrics-sections">
            ${generateMetricsOverview(members)}
            ${generateRankingTables(sortedByOwnership, sortedByTrust)}
            ${generatePerceptionAnalysis(members)}
            ${generateClusterAnalysis(members)}
            ${generateRiskMatrix(members)}
        </div>
    `;
}

function generateMetricsOverview(members) {
    const totalTop3Ownership = members.reduce((sum, m) => sum + m.top3CountOwnership, 0);
    const totalTop3Trust = members.reduce((sum, m) => sum + m.top3CountTrust, 0);
    const avgMAEOwnership = members.reduce((sum, m) => sum + m.selfMAEOwnership, 0) / members.length;
    const avgMAETrust = members.reduce((sum, m) => sum + m.selfMAETrust, 0) / members.length;
    
    return `
        <section class="metrics-section">
            <h2>${currentLang === 'uk' ? '–ó–∞–≥–∞–ª—å–Ω–∏–π –æ–≥–ª—è–¥' : 'General Overview'}</h2>
            <div class="overview-grid">
                <div class="overview-card">
                    <h3>${currentLang === 'uk' ? '–°—Ç–∞—Ç—É—Å–Ω–∞ –Ω–µ—Ä—ñ–≤–Ω—ñ—Å—Ç—å' : 'Status Inequality'}</h3>
                    <div class="metric-large">
                        <span class="value">21.7%</span>
                        <span class="label">Ownership Gini</span>
                    </div>
                    <div class="metric-large">
                        <span class="value">22.6%</span>
                        <span class="label">Trust Gini</span>
                    </div>
                    <p>${currentLang === 'uk' ? 
                        '–ü–æ–º—ñ—Ä–Ω–∞ —Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è - –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞, –∞–ª–µ –≤—ñ–¥—á—É—Ç–Ω–∞' : 
                        'Moderate stratification - not critical but noticeable'}</p>
                </div>
                
                <div class="overview-card">
                    <h3>${currentLang === 'uk' ? '–¢–æ–ø-3 –≤—Ö–æ–¥–∂–µ–Ω–Ω—è' : 'Top-3 Entries'}</h3>
                    <div class="metric-large">
                        <span class="value">${totalTop3Ownership}</span>
                        <span class="label">Ownership</span>
                    </div>
                    <div class="metric-large">
                        <span class="value">${totalTop3Trust}</span>
                        <span class="label">Trust</span>
                    </div>
                </div>
                
                <div class="overview-card">
                    <h3>${currentLang === 'uk' ? '–¢–æ—á–Ω—ñ—Å—Ç—å —Å–∞–º–æ–æ—Ü—ñ–Ω–∫–∏' : 'Self-Assessment Accuracy'}</h3>
                    <div class="metric-large">
                        <span class="value">${avgMAEOwnership.toFixed(2)}</span>
                        <span class="label">MAE Ownership</span>
                    </div>
                    <div class="metric-large">
                        <span class="value">${avgMAETrust.toFixed(2)}</span>
                        <span class="label">MAE Trust</span>
                    </div>
                </div>
            </div>
        </section>
    `;
}

function generateRankingTables(sortedByOwnership, sortedByTrust) {
    const createTable = (data, criterion) => {
        const meanRankKey = criterion === 'ownership' ? 'meanRankOwnership' : 'meanRankTrust';
        const stdKey = criterion === 'ownership' ? 'stdOwnership' : 'stdTrust';
        const top3Key = criterion === 'ownership' ? 'top3CountOwnership' : 'top3CountTrust';
        const statusKey = criterion === 'ownership' ? 'statusScoreOwnership' : 'statusScoreTrust';
        const maeKey = criterion === 'ownership' ? 'selfMAEOwnership' : 'selfMAETrust';
        const biasKey = criterion === 'ownership' ? 'biasOwnership' : 'biasTrust';
        const accuracyKey = criterion === 'ownership' ? 'accuracyOwnership' : 'accuracyTrust';
        
        return `
            <table class="metrics-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>${currentLang === 'uk' ? '–Ü–º\'—è' : 'Name'}</th>
                        <th>${currentLang === 'uk' ? '–ö–æ–¥' : 'Code'}</th>
                        <th>${t('member.meanRank')}</th>
                        <th>${t('member.stdDev')}</th>
                        <th>${t('member.top3Count')}</th>
                        <th>${t('member.statusScore')}</th>
                        <th>MAE</th>
                        <th>${t('member.bias')}</th>
                        <th>${t('member.accuracy')}</th>
                    </tr>
                </thead>
                <tbody>
                    ${data.map((member, i) => `
                        <tr class="${i < 3 ? 'top-performer' : i >= data.length - 2 ? 'low-performer' : ''}">
                            <td>${i + 1}</td>
                            <td>${member.name}</td>
                            <td>${member.code}</td>
                            <td class="numeric">${member[meanRankKey].toFixed(2)}</td>
                            <td class="numeric">${member[stdKey].toFixed(2)}</td>
                            <td class="numeric">${member[top3Key]}</td>
                            <td class="numeric">${member[statusKey].toFixed(3)}</td>
                            <td class="numeric">${member[maeKey].toFixed(2)}</td>
                            <td class="numeric ${member[biasKey] > 0 ? 'positive' : member[biasKey] < 0 ? 'negative' : ''}">${member[biasKey] > 0 ? '+' : ''}${member[biasKey].toFixed(2)}</td>
                            <td class="numeric">${member[accuracyKey].toFixed(1)}%</td>
                        </tr>
                    `).join('')}
                </tbody>
            </table>
        `;
    };
    
    return `
        <section class="metrics-section">
            <h2>${currentLang === 'uk' ? '–†–µ–π—Ç–∏–Ω–≥–æ–≤—ñ —Ç–∞–±–ª–∏—Ü—ñ' : 'Ranking Tables'}</h2>
            
            <div class="table-container">
                <h3>Ownership Rankings</h3>
                ${createTable(sortedByOwnership, 'ownership')}
            </div>
            
            <div class="table-container">
                <h3>Trust Rankings</h3>
                ${createTable(sortedByTrust, 'trust')}
            </div>
            
            <div class="spearman-correlation">
                <p><strong>Spearman œÅ = 1.0</strong></p>
                <p>${currentLang === 'uk' ? 
                    '–Ü—î—Ä–∞—Ä—Ö—ñ—è –º–∞–π–∂–µ —ñ–¥–µ–Ω—Ç–∏—á–Ω–∞ –∑–∞ –æ–±–æ–º–∞ –∫—Ä–∏—Ç–µ—Ä—ñ—è–º–∏ (—Å–∏–ª—å–Ω–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–µ –Ω–∞–∫–ª–∞–¥–∞–Ω–Ω—è)' : 
                    'Hierarchy almost identical by both criteria (strong structural overlap)'}</p>
            </div>
        </section>
    `;
}

function generatePerceptionAnalysis(members) {
    // Group by perception patterns
    const highAccuracy = members.filter(m => m.selfMAEOwnership < 0.5 && m.selfMAETrust < 0.5);
    const overestimators = members.filter(m => m.biasOwnership > 1 || m.biasTrust > 1);
    const underestimators = members.filter(m => m.biasOwnership < -0.3 || m.biasTrust < -0.3);
    const poorAccuracy = members.filter(m => m.selfMAEOwnership > 1.5 || m.selfMAETrust > 1.5);
    
    return `
        <section class="metrics-section">
            <h2>${currentLang === 'uk' ? '–ê–Ω–∞–ª—ñ–∑ —Å–∞–º–æ—Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è' : 'Self-Perception Analysis'}</h2>
            
            <div class="perception-grid">
                <div class="perception-card">
                    <h3>${currentLang === 'uk' ? '–í–∏—Å–æ–∫–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å' : 'High Accuracy'}</h3>
                    <div class="member-list">
                        ${highAccuracy.map(m => `
                            <div class="member-item">
                                <span>${m.name}</span>
                                <span class="badge">MAE: ${((m.selfMAEOwnership + m.selfMAETrust) / 2).toFixed(2)}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="perception-card warning">
                    <h3>${currentLang === 'uk' ? '–°–∏—Å—Ç–µ–º–Ω–µ –ø–µ—Ä–µ–æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è' : 'Systematic Overestimation'}</h3>
                    <div class="member-list">
                        ${overestimators.map(m => `
                            <div class="member-item">
                                <span>${m.name}</span>
                                <span class="badge negative">Bias: +${Math.max(m.biasOwnership, m.biasTrust).toFixed(2)}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="perception-card info">
                    <h3>${currentLang === 'uk' ? '–°–∏—Å—Ç–µ–º–Ω–µ –Ω–µ–¥–æ–æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è' : 'Systematic Underestimation'}</h3>
                    <div class="member-list">
                        ${underestimators.map(m => `
                            <div class="member-item">
                                <span>${m.name}</span>
                                <span class="badge positive">Bias: ${Math.min(m.biasOwnership, m.biasTrust).toFixed(2)}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="perception-card critical">
                    <h3>${currentLang === 'uk' ? '–ù–∞–π–≥—ñ—Ä—à–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å' : 'Worst Accuracy'}</h3>
                    <div class="member-list">
                        ${poorAccuracy.map(m => `
                            <div class="member-item">
                                <span>${m.name}</span>
                                <span class="badge negative">MAE: ${Math.max(m.selfMAEOwnership, m.selfMAETrust).toFixed(2)}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
            
            <div class="anomaly-note">
                <h4>${currentLang === 'uk' ? '–ê–Ω–æ–º–∞–ª—ñ—ó' : 'Anomalies'}</h4>
                <p>Viktoria: ${currentLang === 'uk' ? 
                    '–£ Ownership –¥–∞–ª–∞ –≤—Å—ñ–º "8", —É Trust ‚Äì –≤—Å—ñ–º "6": —Å–∏–≥–Ω–∞–ª –Ω–∏–∑—å–∫–æ—ó –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ–∞—Ü—ñ—ó –π/–∞–±–æ –≤—Ç–æ–º–∏, —Ñ–æ—Ä–º–∞–ª—å–Ω–æ—ó —É—á–∞—Å—Ç—ñ.' : 
                    'Gave everyone "8" in Ownership, "6" in Trust: signal of low differentiation and/or fatigue, formal participation.'}</p>
            </div>
        </section>
    `;
}

function generateClusterAnalysis(members) {
    const core1 = members.filter(m => m.meanRankOwnership <= 2);
    const core2 = members.filter(m => m.meanRankOwnership > 2 && m.meanRankOwnership <= 3.5);
    const quasiCore = members.filter(m => m.meanRankOwnership > 3.5 && m.meanRankOwnership <= 5);
    const periphery = members.filter(m => m.meanRankOwnership > 5);
    
    return `
        <section class="metrics-section">
            <h2>${currentLang === 'uk' ? '–ö–ª–∞—Å—Ç–µ—Ä–Ω–∏–π –∞–Ω–∞–ª—ñ–∑' : 'Cluster Analysis'}</h2>
            
            <div class="cluster-grid">
                <div class="cluster-card core">
                    <h3>${currentLang === 'uk' ? '–Ø–¥—Ä–æ 1-–≥–æ —Ä—ñ–≤–Ω—è' : 'Core Level 1'}</h3>
                    <div class="member-chips">
                        ${core1.map(m => `
                            <div class="member-chip">
                                <strong>${m.name}</strong>
                                <span>${m.role}</span>
                            </div>
                        `).join('')}
                    </div>
                    <p>${currentLang === 'uk' ? 
                        '–ù–∞–¥–∑–≤–∏—á–∞–π–Ω–∞ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü—ñ—è –¥–æ–≤—ñ—Ä–∏ —Ç–∞ –æ—á—ñ–∫—É–≤–∞–Ω—å' : 
                        'Extraordinary concentration of trust and expectations'}</p>
                </div>
                
                <div class="cluster-card core2">
                    <h3>${currentLang === 'uk' ? '–Ø–¥—Ä–æ 2-–≥–æ —Ä—ñ–≤–Ω—è' : 'Core Level 2'}</h3>
                    <div class="member-chips">
                        ${core2.map(m => `
                            <div class="member-chip">
                                <strong>${m.name}</strong>
                                <span>${m.role}</span>
                            </div>
                        `).join('')}
                    </div>
                    <p>${currentLang === 'uk' ? 
                        '–í–∏—Å–æ–∫–∏–π —Å—Ç–∞—Ç—É—Å + –º—ñ–∂–∫–æ–º–ø–∞–Ω—ñ–π–Ω—ñ –º–æ—Å—Ç–∏' : 
                        'High status + cross-company bridges'}</p>
                </div>
                
                <div class="cluster-card quasi">
                    <h3>${currentLang === 'uk' ? '–ö–≤–∞–∑—ñ-—è–¥—Ä–æ' : 'Quasi-Core'}</h3>
                    <div class="member-chips">
                        ${quasiCore.map(m => `
                            <div class="member-chip">
                                <strong>${m.name}</strong>
                                <span>${m.role}</span>
                            </div>
                        `).join('')}
                    </div>
                    <p>${currentLang === 'uk' ? 
                        '–°–µ—Ä–µ–¥–∏–Ω–∞ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ —Å–∞–º–æ—Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è' : 
                        'Middle with various self-perception issues'}</p>
                </div>
                
                <div class="cluster-card periphery">
                    <h3>${currentLang === 'uk' ? '–ü–µ—Ä–∏—Ñ–µ—Ä—ñ—è' : 'Periphery'}</h3>
                    <div class="member-chips">
                        ${periphery.map(m => `
                            <div class="member-chip">
                                <strong>${m.name}</strong>
                                <span>${m.role}</span>
                            </div>
                        `).join('')}
                    </div>
                    <p>${currentLang === 'uk' ? 
                        '–ù–∏–∑—å–∫–∞ –≤–∏–¥–∏–º—ñ—Å—Ç—å, —Ä–∏–∑–∏–∫ —ñ–∑–æ–ª—è—Ü—ñ—ó' : 
                        'Low visibility, risk of isolation'}</p>
                </div>
            </div>
            
            <div class="polarization-metric">
                <h4>${currentLang === 'uk' ? '–ü–æ–ª—è—Ä–∏–∑–∞—Ü—ñ—è' : 'Polarization'}</h4>
                <p>${currentLang === 'uk' ? 
                    `–†–æ–∑—Ä–∏–≤ –º—ñ–∂ Alex (1.5) —Ç–∞ Viktoria (7.5) = 6 –ø–æ–∑–∏—Ü—ñ–π —ñ–∑ 8 –º–æ–∂–ª–∏–≤–∏—Ö ‚Üí –¥–æ—Å–∏—Ç—å –∫—Ä—É—Ç–∞ –≥—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∞ –¥—Ä–∞–±–∏–Ω–∞ –æ—á—ñ–∫—É–≤–∞–Ω—å.` : 
                    `Gap between Alex (1.5) and Viktoria (7.5) = 6 positions out of 8 possible ‚Üí quite steep gradient ladder of expectations.`}</p>
            </div>
        </section>
    `;
}

function generateRiskMatrix(members) {
    return `
        <section class="metrics-section">
            <h2>${currentLang === 'uk' ? '–ú–∞—Ç—Ä–∏—Ü—è —Ä–∏–∑–∏–∫—ñ–≤' : 'Risk Matrix'}</h2>
            
            <div class="risk-grid">
                <div class="risk-card high">
                    <h3>${currentLang === 'uk' ? '–í–∏—Å–æ–∫–∏–π —Ä–∏–∑–∏–∫' : 'High Risk'}</h3>
                    <div class="risk-item">
                        <strong>${currentLang === 'uk' ? '–ù–∞–¥—Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–∞—Ü—ñ—è' : 'Over-centralization'}</strong>
                        <p>Alex: ${currentLang === 'uk' ? 
                            '–ê–±—Å–æ–ª—é—Ç–Ω–∏–π ‚Ññ1, "–≥–æ—Ä–ª–æ –ø–ª—è—à–∫–∏" –≤ —É—Ö–≤–∞–ª–µ–Ω–Ω—ñ —Ä—ñ—à–µ–Ω—å' : 
                            'Absolute #1, bottleneck in decision making'}</p>
                    </div>
                    <div class="risk-item">
                        <strong>${currentLang === 'uk' ? '–ü–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π –º—ñ—Å—Ç' : 'Overloaded Bridge'}</strong>
                        <p>Igor: ${currentLang === 'uk' ? 
                            '–í—Å—ñ –∫—Ä–æ—Å-–≤—Ö–æ–¥–∏, –æ–¥–Ω–æ—Ç–æ—á–∫–æ–≤–∏–π –ø—Ä–æ–≤–∞–ª –ø—Ä–∏ –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ' : 
                            'All cross-entries, single point of failure if absent'}</p>
                    </div>
                </div>
                
                <div class="risk-card medium">
                    <h3>${currentLang === 'uk' ? '–°–µ—Ä–µ–¥–Ω—ñ–π —Ä–∏–∑–∏–∫' : 'Medium Risk'}</h3>
                    <div class="risk-item">
                        <strong>${currentLang === 'uk' ? '–ü–µ—Ä—Ü–µ–ø—Ç–∏–≤–Ω—ñ —Ä–æ–∑—Ä–∏–≤–∏' : 'Perceptual Gaps'}</strong>
                        <p>Nik, Oleg, Antonia: ${currentLang === 'uk' ? 
                            '–í–∏—Å–æ–∫–∏–π –ø–æ–∑–∏—Ç–∏–≤–Ω–∏–π bias, –∫–æ–Ω—Ñ–ª—ñ–∫—Ç–∏ –æ—á—ñ–∫—É–≤–∞–Ω—å' : 
                            'High positive bias, expectation conflicts'}</p>
                    </div>
                    <div class="risk-item">
                        <strong>${currentLang === 'uk' ? '–ü–æ–ª—è—Ä–∏–∑–æ–≤–∞–Ω—ñ—Å—Ç—å –¥—É–º–æ–∫' : 'Opinion Polarization'}</strong>
                        <p>Igor, Antonia: ${currentLang === 'uk' ? 
                            '–í–∏—Å–æ–∫–∏–π std, –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å —Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è' : 
                            'High std, perception instability'}</p>
                    </div>
                </div>
                
                <div class="risk-card low">
                    <h3>${currentLang === 'uk' ? '–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ' : 'Potential Opportunities'}</h3>
                    <div class="risk-item">
                        <strong>${currentLang === 'uk' ? '–ù–µ–¥–æ–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –ø–æ—Ç–µ–Ω—Ü—ñ–∞–ª' : 'Underutilized Potential'}</strong>
                        <p>Maivi, Yana: ${currentLang === 'uk' ? 
                            '–ù–µ–¥–æ–æ—Ü—ñ–Ω–∫–∞ —Å–µ–±–µ, –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–ª—è —Ä–æ—Å—Ç—É' : 
                            'Self-underestimation, growth opportunities'}</p>
                    </div>
                </div>
            </div>
        </section>
    `;
}

// ===== Text Analysis View =====
function renderTextAnalysis(members) {
    const container = document.getElementById('analysisContainer');
    container.style.display = 'block';
    
    const analysisTitle = currentLang === 'uk' ? 
        '–ì–ª–∏–±–∏–Ω–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –∫–æ–º–∞–Ω–¥–∏ VQ & IM' : 
        'Deep Analysis of VQ & IM Team';
    const analysisSubtitle = currentLang === 'uk' ? 
        '–ö–æ–º–ø–ª–µ–∫—Å–Ω–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω–æ—ó –¥–∏–Ω–∞–º—ñ–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Å–æ—Ü—ñ–æ–º–µ—Ç—Ä–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö' : 
        'Comprehensive Study of Organizational Dynamics Based on Sociometric Data';
    
    container.innerHTML = `
        <div class="analysis-header">
            <h1 class="analysis-title">${analysisTitle}</h1>
            <p class="analysis-subtitle">${analysisSubtitle}</p>
        </div>
        
        <div class="analysis-sections">
            ${generateExecutiveSummary()}
            ${generateCriticalFindings()}
            ${generateEmployeeAnalysis(members)}
            ${generateStrategicInterventions()}
            ${generateSystemRecommendations()}
        </div>
    `;
    
    // Add interaction to employee cards
    container.querySelectorAll('.employee-card').forEach(card => {
        card.addEventListener('click', () => {
            const memberId = card.dataset.memberId;
            const member = members.find(m => m.id === memberId);
            if (member) showMemberDetails(member);
        });
    });
}

// Generate analysis sections with real data
function generateExecutiveSummary() {
    if (currentLang === 'uk') {
        return `
            <section class="analysis-section">
                <h2 class="section-title">
                    <i class="fas fa-chart-line"></i>
                    –í–∏–∫–æ–Ω–∞–≤—á–µ —Ä–µ–∑—é–º–µ
                </h2>
                <p>–ê–Ω–∞–ª—ñ–∑ —Å–æ—Ü—ñ–æ–º–µ—Ç—Ä–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö –≤–∏—è–≤–ª—è—î —á—ñ—Ç–∫–æ –≤–∏—Ä–∞–∂–µ–Ω–µ —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ —è–¥—Ä–æ (Alex‚ÄìIgor‚ÄìRami) 
                –∑ –∫—Ä–∏—Ç–∏—á–Ω–æ—é –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü—ñ—î—é –¥–æ–≤—ñ—Ä–∏ —Ç–∞ –æ—á—ñ–∫—É–≤–∞–Ω—å. Spearman œÅ = 1.0 –º—ñ–∂ Ownership —Ç–∞ Trust 
                –≤–∫–∞–∑—É—î –Ω–∞ —Å–∏–ª—å–Ω–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–µ –Ω–∞–∫–ª–∞–¥–∞–Ω–Ω—è —ñ—î—Ä–∞—Ä—Ö—ñ–π.</p>
                
                <div class="key-metrics">
                    <div class="metric-card-summary">
                        <div class="metric-value">0.217</div>
                        <div class="metric-label">Gini Ownership</div>
                    </div>
                    <div class="metric-card-summary">
                        <div class="metric-value">0.226</div>
                        <div class="metric-label">Gini Trust</div>
                    </div>
                    <div class="metric-card-summary">
                        <div class="metric-value">6/8</div>
                        <div class="metric-label">–ü–æ–ª—è—Ä–∏–∑–∞—Ü—ñ—è —Ä–∞–Ω–≥—ñ–≤</div>
                    </div>
                </div>
                
                <p><strong>–ö–ª—é—á–æ–≤–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫:</strong> –ü–æ–º—ñ—Ä–Ω–∞ —Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è (Gini ~0.22) –≤–∂–µ —Å—Ç–≤–æ—Ä—é—î –≤—ñ–¥—á—É—Ç–Ω—É –Ω–µ—Ä—ñ–≤–Ω—ñ—Å—Ç—å. 
                Alex –º–∞—î mean rank 1.50 –∑ 8 –≤—Ö–æ–¥–∞–º–∏ –≤ —Ç–æ–ø-3, —â–æ —Å—Ç–≤–æ—Ä—é—î "–≥–æ—Ä–ª–æ –ø–ª—è—à–∫–∏" –≤ –ø—Ä–∏–π–Ω—è—Ç—Ç—ñ —Ä—ñ—à–µ–Ω—å. 
                Igor —è–∫ —î–¥–∏–Ω–∏–π –º—ñ–∂–∫–æ–º–ø–∞–Ω—ñ–π–Ω–∏–π –º—ñ—Å—Ç –Ω–µ—Å–µ –∫—Ä–∏—Ç–∏—á–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.</p>
            </section>
        `;
    } else {
        return `
            <section class="analysis-section">
                <h2 class="section-title">
                    <i class="fas fa-chart-line"></i>
                    Executive Summary
                </h2>
                <p>Sociometric data analysis reveals a clearly expressed centralized core (Alex‚ÄìIgor‚ÄìRami) 
                with critical concentration of trust and expectations. Spearman œÅ = 1.0 between Ownership and Trust 
                indicates strong structural overlap of hierarchies.</p>
                
                <div class="key-metrics">
                    <div class="metric-card-summary">
                        <div class="metric-value">0.217</div>
                        <div class="metric-label">Gini Ownership</div>
                    </div>
                    <div class="metric-card-summary">
                        <div class="metric-value">0.226</div>
                        <div class="metric-label">Gini Trust</div>
                    </div>
                    <div class="metric-card-summary">
                        <div class="metric-value">6/8</div>
                        <div class="metric-label">Rank Polarization</div>
                    </div>
                </div>
                
                <p><strong>Key Conclusion:</strong> Moderate stratification (Gini ~0.22) already creates noticeable inequality. 
                Alex has mean rank 1.50 with 8 top-3 entries, creating a decision-making bottleneck. 
                Igor as the sole cross-company bridge carries critical load.</p>
            </section>
        `;
    }
}

function generateCriticalFindings() {
    if (currentLang === 'uk') {
        return `
            <section class="analysis-section">
                <h2 class="section-title">
                    <i class="fas fa-exclamation-triangle"></i>
                    –ö—Ä–∏—Ç–∏—á–Ω—ñ –≤–∏—è–≤–ª–µ–Ω–Ω—è –∑ –¥–∞–Ω–∏—Ö
                </h2>
                
                <div class="findings-grid">
                    <div class="finding-card critical">
                        <h3>1. –°–∏—Å—Ç–µ–º–Ω—ñ –ø–µ—Ä—Ü–µ–ø—Ç–∏–≤–Ω—ñ —Ä–æ–∑—Ä–∏–≤–∏</h3>
                        <p>Nik: MAE = 2.25, Bias = +2.25 - –Ω–∞–π–≥—ñ—Ä—à–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å —Å–∞–º–æ–æ—Ü—ñ–Ω–∫–∏</p>
                        <p>Oleg: Bias = +1.25 - —Å—Ç–∞–±—ñ–ª—å–Ω–µ –ø–µ—Ä–µ–æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è</p>
                        <p>Viktoria: –ê–Ω–æ–º–∞–ª—å–Ω—ñ –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è (–≤—Å—ñ–º "8" –≤ Ownership)</p>
                    </div>
                    
                    <div class="finding-card warning">
                        <h3>2. –ú—ñ–∂–∫–æ–º–ø–∞–Ω—ñ–π–Ω–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å</h3>
                        <p>Igor: 6/6 —Ç–æ–ø-3 –≤—Ö–æ–¥—ñ–≤ –≤—ñ–¥ Vagoteq - –∫—Ä–∏—Ç–∏—á–Ω–∏–π –∫–ª–µ–π</p>
                        <p>Rami: 4 –∫—Ä–æ—Å-–∫–æ–º–ø–∞–Ω—ñ–π–Ω—ñ –≤—Ö–æ–¥–∏ - —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π –º—ñ—Å—Ç</p>
                        <p>Viktoria: 0 –∫—Ä–æ—Å-–≤—Ö–æ–¥—ñ–≤ - –ø–æ–≤–Ω–∞ —ñ–∑–æ–ª—è—Ü—ñ—è</p>
                    </div>
                    
                    <div class="finding-card warning">
                        <h3>3. –í–∑–∞—î–º–Ω—ñ —Ç–æ–ø-3 –∑–≤'—è–∑–∫–∏</h3>
                        <p>–°–µ—Ä—Ü–µ–≤–∏–Ω–Ω–∏–π —Ç—Ä–∏–∫—É—Ç–Ω–∏–∫: Alex‚ÄìIgor‚ÄìRami</p>
                        <p>–Ü–∑–æ–ª—å–æ–≤–∞–Ω—ñ: Yana, Viktoria (0 –≤–∑–∞—î–º–Ω–∏—Ö —Ç–æ–ø-3)</p>
                        <p>Maivi-Antonia: –≤–∑–∞—î–º–Ω—ñ—Å—Ç—å —Ç—ñ–ª—å–∫–∏ –≤ Trust</p>
                    </div>
                </div>
            </section>
        `;
    } else {
        return `
            <section class="analysis-section">
                <h2 class="section-title">
                    <i class="fas fa-exclamation-triangle"></i>
                    Critical Data Findings
                </h2>
                
                <div class="findings-grid">
                    <div class="finding-card critical">
                        <h3>1. Systemic Perceptual Gaps</h3>
                        <p>Nik: MAE = 2.25, Bias = +2.25 - worst self-assessment accuracy</p>
                        <p>Oleg: Bias = +1.25 - stable overestimation</p>
                        <p>Viktoria: Anomalous predictions (everyone "8" in Ownership)</p>
                    </div>
                    
                    <div class="finding-card warning">
                        <h3>2. Cross-Company Dependency</h3>
                        <p>Igor: 6/6 top-3 entries from Vagoteq - critical glue</p>
                        <p>Rami: 4 cross-company entries - stable bridge</p>
                        <p>Viktoria: 0 cross-entries - complete isolation</p>
                    </div>
                    
                    <div class="finding-card warning">
                        <h3>3. Mutual Top-3 Connections</h3>
                        <p>Core triangle: Alex‚ÄìIgor‚ÄìRami</p>
                        <p>Isolated: Yana, Viktoria (0 mutual top-3)</p>
                        <p>Maivi-Antonia: mutuality only in Trust</p>
                    </div>
                </div>
            </section>
        `;
    }
}

function generateEmployeeAnalysis(members) {
    const title = currentLang === 'uk' ? '–Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –∫–æ–º–∞–Ω–¥–∏' : 'Individual Team Analysis';
    
    const employeeCards = members.map(member => {
        const strengthLabel = currentLang === 'uk' ? '–°–∏–ª–∞:' : 'Strength:';
        const challengeLabel = currentLang === 'uk' ? '–í–∏–∫–ª–∏–∫:' : 'Challenge:';
        const dataLabel = currentLang === 'uk' ? '–î–∞–Ω—ñ:' : 'Data:';
        
        return `
            <div class="employee-card" data-member-id="${member.id}">
                <div class="employee-header">
                    <div class="employee-avatar">${member.firstName || member.name.split(' ')[0]}</div>
                    <div class="employee-info">
                        <h4>${member.name}</h4>
                        <p>${member.role} ‚Ä¢ ${member.company}</p>
                    </div>
                </div>
                
                <div class="employee-metrics">
                    <div class="metric">
                        <div class="metric-value">${member.meanRankOwnership.toFixed(2)}</div>
                        <div class="metric-label">${t('member.meanRank')}</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">${member.top3CountOwnership}</div>
                        <div class="metric-label">${t('member.top3Count')}</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value ${member.biasOwnership > 0 ? 'negative' : 'positive'}">${member.biasOwnership > 0 ? '+' : ''}${member.biasOwnership.toFixed(2)}</div>
                        <div class="metric-label">${t('member.bias')}</div>
                    </div>
                </div>
                
                <div class="employee-insights">
                    <p><strong>${dataLabel}</strong> Status: ${member.statusScoreOwnership.toFixed(3)}, MAE: ${member.selfMAEOwnership.toFixed(2)}, Accuracy: ${member.accuracyOwnership}%</p>
                    <p><strong>${strengthLabel}</strong> ${currentLang === 'uk' ? member.insights.strength : getEnglishInsight(member.insights.strength)}</p>
                    <p><strong>${challengeLabel}</strong> ${currentLang === 'uk' ? member.insights.challenge : getEnglishInsight(member.insights.challenge)}</p>
                    ${member.quote ? `<p class="employee-quote">"${member.quote}"</p>` : ''}
                </div>
            </div>
        `;
    }).join('');
    
    return `
        <section class="analysis-section">
            <h2 class="section-title">
                <i class="fas fa-users"></i>
                ${title}
            </h2>
            
            <div class="employee-grid">
                ${employeeCards}
            </div>
        </section>
    `;
}

function generateStrategicInterventions() {
    if (currentLang === 'uk') {
        return `
            <section class="analysis-section">
                <h2 class="section-title">
                    <i class="fas fa-tasks"></i>
                    –°—Ç—Ä–∞—Ç–µ–≥—ñ—á–Ω—ñ –∫–æ–º–∞–Ω–¥–Ω—ñ —ñ–Ω—Ç–µ—Ä–≤–µ–Ω—Ü—ñ—ó
                </h2>
                
                <div class="intervention-timeline">
                    <div class="timeline-phase">
                        <h3>0‚Äì30 –¥–Ω—ñ–≤ (—à–≤–∏–¥–∫—ñ –∫—Ä–æ–∫–∏)</h3>
                        <ul>
                            <li><strong>–ü—Ä–æ–∑–æ—Ä–∏–π –∑–≤–æ—Ä–æ—Ç–Ω–∏–π –∑–≤'—è–∑–æ–∫ 1:1</strong> –∑ Nik (MAE=2.25), Oleg (+1.25), Antonia: 
                            –ø–æ–∫–∞–∑–∞—Ç–∏ –∞–Ω–æ–Ω—ñ–º—ñ–∑–æ–≤–∞–Ω—ñ –∞–≥—Ä–µ–≥–∞—Ç–∏ + –ø–æ–≥–æ–¥–∏—Ç–∏ –ø–æ–≤–µ–¥—ñ–Ω–∫–æ–≤—ñ –º–∞—Ä–∫–µ—Ä–∏</li>
                            
                            <li><strong>Peer-mentoring "–º—ñ—Å—Ç":</strong>
                                <ul>
                                    <li>Maivi ‚Üî Igor (–≤–∏–¥–∏–º—ñ—Å—Ç—å + —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞)</li>
                                    <li>Yana ‚Üî Rami (–≤–∫–ª—é—á–µ–Ω–Ω—è –≤ —è–¥—Ä–æ —á–µ—Ä–µ–∑ –º—ñ–∫—Ä–æ–ø—Ä–æ–µ–∫—Ç–∏)</li>
                                </ul>
                            </li>
                            
                            <li><strong>Quick Wins –î–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è:</strong> Alex (1.50) –ø–µ—Ä–µ–¥–∞—î 2 —Ä—É—Ç–∏–Ω–Ω—ñ –∑–æ–Ω–∏ –¥–æ Rami (3.50) —Ç–∞ Oleg (4.88)</li>
                        </ul>
                    </div>
                    
                    <div class="timeline-phase">
                        <h3>30‚Äì60 –¥–Ω—ñ–≤</h3>
                        <ul>
                            <li><strong>–ö–∞–ª—ñ–±—Ä—É—é—á–∞ —Å–µ—Å—ñ—è –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤:</strong> –ü–µ—Ä–µ–≤–∏–∑–Ω–∞—á–∏—Ç–∏ "Ownership" —Ç–∞ "Trust" —á–µ—Ä–µ–∑ –ø–æ–≤–µ–¥—ñ–Ω–∫–æ–≤—ñ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏</li>
                            <li><strong>–ú—É–ª—å—Ç–∏–ø–ª—ñ–∫–∞—Ç–∏–≤–Ω—ñ –º—ñ–∫—Ä–æ—Ä–æ–ª—ñ:</strong>
                                <ul>
                                    <li>Nik ‚Üí "Procurement Efficiency Champion"</li>
                                    <li>Oleg ‚Üí "CRM Data Quality Steward"</li>
                                </ul>
                            </li>
                            <li><strong>–í–∏–¥–∏–º—ñ—Å—Ç—å –¥–ª—è –ø–µ—Ä–∏—Ñ–µ—Ä—ñ—ó:</strong> Yana & Viktoria - —Å–ø—ñ–ª—å–Ω—ñ –º—ñ–Ω—ñ-—ñ–Ω—ñ—Ü—ñ–∞—Ç–∏–≤–∏</li>
                        </ul>
                    </div>
                    
                    <div class="timeline-phase">
                        <h3>60‚Äì90 –¥–Ω—ñ–≤</h3>
                        <ul>
                            <li>–î—Ä—É–≥–∏–π —Ä–∞—É–Ω–¥ —Å–æ—Ü—ñ–æ–º–µ—Ç—Ä—ñ—ó –∑ –ø–æ–≤–µ–¥—ñ–Ω–∫–æ–≤–∏–º–∏ —à–∫–∞–ª–∞–º–∏</li>
                            <li>–ü—ñ–ª–æ—Ç –º–∞—Ç—Ä–∏—Ü—ñ —Ä—ñ—à–µ–Ω—å: RACI –∑ –≤—ñ–¥—Ö–æ–¥–æ–º Alex –≤—ñ–¥ "Responsible"</li>
                            <li>–§–æ—Ä–º–∞–ª—å–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –∑–≤'—è–∑–∫—É –ø–æ —Å–∞–º–æ–ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è—Ö</li>
                        </ul>
                    </div>
                </div>
            </section>
        `;
    } else {
        return `
            <section class="analysis-section">
                <h2 class="section-title">
                    <i class="fas fa-tasks"></i>
                    Strategic Team Interventions
                </h2>
                
                <div class="intervention-timeline">
                    <div class="timeline-phase">
                        <h3>0‚Äì30 days (quick steps)</h3>
                        <ul>
                            <li><strong>Transparent 1:1 feedback</strong> with Nik (MAE=2.25), Oleg (+1.25), Antonia: 
                            show anonymized aggregates + agree on behavioral markers</li>
                            
                            <li><strong>Peer-mentoring "bridge":</strong>
                                <ul>
                                    <li>Maivi ‚Üî Igor (visibility + structural support)</li>
                                    <li>Yana ‚Üî Rami (core inclusion through microprojects)</li>
                                </ul>
                            </li>
                            
                            <li><strong>Quick Wins Delegation:</strong> Alex (1.50) transfers 2 routine zones to Rami (3.50) and Oleg (4.88)</li>
                        </ul>
                    </div>
                    
                    <div class="timeline-phase">
                        <h3>30‚Äì60 days</h3>
                        <ul>
                            <li><strong>Criteria calibration session:</strong> Redefine "Ownership" and "Trust" through behavioral indicators</li>
                            <li><strong>Multiplicative micro-roles:</strong>
                                <ul>
                                    <li>Nik ‚Üí "Procurement Efficiency Champion"</li>
                                    <li>Oleg ‚Üí "CRM Data Quality Steward"</li>
                                </ul>
                            </li>
                            <li><strong>Periphery visibility:</strong> Yana & Viktoria - joint mini-initiatives</li>
                        </ul>
                    </div>
                    
                    <div class="timeline-phase">
                        <h3>60‚Äì90 days</h3>
                        <ul>
                            <li>Second sociometry round with behavioral scales</li>
                            <li>Decision matrix pilot: RACI with Alex moving from "Responsible"</li>
                            <li>Formal self-prediction feedback script</li>
                        </ul>
                    </div>
                </div>
            </section>
        `;
    }
}

function generateSystemRecommendations() {
    if (currentLang === 'uk') {
        return `
            <section class="analysis-section">
                <h2 class="section-title">
                    <i class="fas fa-cogs"></i>
                    –°–∏—Å—Ç–µ–º–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó (–Ω–∞–¥ —Ä—ñ–≤–Ω–µ–º —ñ–Ω–¥–∏–≤—ñ–¥—ñ–≤)
                </h2>
                
                <div class="recommendations-table">
                    <table>
                        <thead>
                            <tr>
                                <th>–¶—ñ–ª—å</th>
                                <th>–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç</th>
                                <th>–Ø–∫ –≤–∏–º—ñ—Ä—é—î–º–æ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>–ó–º–µ–Ω—à–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ Alex</td>
                                <td>RACI + —Ä–æ—Ç–∞—Ü—ñ—è —Ñ–∞—Å–∏–ª—ñ—Ç–∞—Ç–æ—Ä—ñ–≤</td>
                                <td>% –º—ñ—Ç–∏–Ω–≥—ñ–≤ –±–µ–∑ —Ñ–∞—Å–∏–ª—ñ—Ç–∞—Ü—ñ—ó Alex ‚Üí ‚â•50% –∑–∞ 60 –¥–Ω—ñ–≤</td>
                            </tr>
                            <tr>
                                <td>–ó–Ω–∏–∑–∏—Ç–∏ –ø–µ—Ä—Ü–µ–ø—Ç–∏–≤–Ω—ñ bias</td>
                                <td>–†–µ–≥—É–ª—è—Ä–Ω–∏–π "Prediction Review"</td>
                                <td>–ó–Ω–∏–∂–µ–Ω–Ω—è —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ MAE –≥—Ä—É–ø–∏ ‚â•20% –∑–∞ 2 —Ö–≤–∏–ª—ñ</td>
                            </tr>
                            <tr>
                                <td>–ü–æ—Å–∏–ª–∏—Ç–∏ –ø–µ—Ä–∏—Ñ–µ—Ä—ñ—é</td>
                                <td>–ü–∞—Ä–Ω—ñ –º—ñ–∫—Ä–æ–ø—Ä–æ–µ–∫—Ç–∏</td>
                                <td>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–æ–≤–∏—Ö —Ç–æ–ø-3 –≤—Ö–æ–¥—ñ–≤ –ø–µ—Ä–∏—Ñ–µ—Ä—ñ—ó —á–µ—Ä–µ–∑ 90 –¥–Ω—ñ–≤</td>
                            </tr>
                            <tr>
                                <td>–ó–±–µ—Ä–µ–≥—Ç–∏ –º—ñ—Å—Ç Igor</td>
                                <td>–î–µ–ª–µ–≥—É–≤–∞—Ç–∏ 30% –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—ó</td>
                                <td>–ó–Ω–∏–∂–µ–Ω–Ω—è Std Rank Igor < 1.5</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="final-recommendations">
                    <h4>–ù–∞—Å—Ç—É–ø–Ω–∏–π —Ä–∞—É–Ω–¥ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏</h4>
                    <ul>
                        <li><strong>Weighted Reciprocity Index:</strong> –≤—ñ–¥—Å—Ç–µ–∂–∏—Ç–∏ —Å—É–º—É –≤–∑–∞—î–º–Ω–∏—Ö (9‚àírank) –ø–∞—Ä</li>
                        <li><strong>Network Constraint (Burt):</strong> —Ñ–æ—Ä–º–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ä–æ–ª—å Igor —è–∫ –±—Ä–æ–∫–µ—Ä–∞</li>
                        <li><strong>Time-Series Drift:</strong> —á–∏ –∑–º–µ–Ω—à—É—î—Ç—å—Å—è –∫—Ä—É—Ç–∏–∑–Ω–∞ —ñ—î—Ä–∞—Ä—Ö—ñ—ó —á–µ—Ä–µ–∑ 60-90 –¥–Ω—ñ–≤</li>
                        <li><strong>Behavioral Anchoring:</strong> –¥–æ–¥–∞—Ç–∏ 5-7 –ø–æ–≤–µ–¥—ñ–Ω–∫–æ–≤–∏—Ö —Ç–≤–µ—Ä–¥–∂–µ–Ω—å Likert</li>
                    </ul>
                </div>
            </section>
        `;
    } else {
        return `
            <section class="analysis-section">
                <h2 class="section-title">
                    <i class="fas fa-cogs"></i>
                    System Recommendations (Above Individual Level)
                </h2>
                
                <div class="recommendations-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Goal</th>
                                <th>Tool</th>
                                <th>How We Measure</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Reduce Alex dependency</td>
                                <td>RACI + facilitator rotation</td>
                                <td>% meetings without Alex facilitation ‚Üí ‚â•50% in 60 days</td>
                            </tr>
                            <tr>
                                <td>Lower perceptual bias</td>
                                <td>Regular "Prediction Review"</td>
                                <td>Group average MAE reduction ‚â•20% in 2 waves</td>
                            </tr>
                            <tr>
                                <td>Strengthen periphery</td>
                                <td>Paired microprojects</td>
                                <td>Number of new top-3 entries for periphery after 90 days</td>
                            </tr>
                            <tr>
                                <td>Preserve Igor bridge</td>
                                <td>Delegate 30% coordination</td>
                                <td>Reduce Igor Std Rank < 1.5</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="final-recommendations">
                    <h4>Next Round Analytics</h4>
                    <ul>
                        <li><strong>Weighted Reciprocity Index:</strong> track sum of mutual (9‚àírank) pairs</li>
                        <li><strong>Network Constraint (Burt):</strong> formalize Igor's broker role</li>
                        <li><strong>Time-Series Drift:</strong> does hierarchy steepness decrease after 60-90 days</li>
                        <li><strong>Behavioral Anchoring:</strong> add 5-7 Likert behavioral statements</li>
                    </ul>
                </div>
            </section>
        `;
    }
}

// ===== Glossary View =====
function renderGlossary() {
    const container = document.getElementById('analysisContainer');
    container.style.display = 'block';
    
    const glossaryTerms = [
        {
            term: t('glossary.meanRank'),
            description: t('glossary.meanRankDesc'),
            example: currentLang === 'uk' ? 
                '–ü—Ä–∏–∫–ª–∞–¥: Alex –º–∞—î —Å–µ—Ä–µ–¥–Ω—ñ–π —Ä–∞–Ω–≥ 1.50, —â–æ –æ–∑–Ω–∞—á–∞—î —â–æ –≤ —Å–µ—Ä–µ–¥–Ω—å–æ–º—É –∫–æ–ª–µ–≥–∏ —Å—Ç–∞–≤–ª—è—Ç—å –π–æ–≥–æ –Ω–∞ 1-2 –º—ñ—Å—Ü–µ.' :
                'Example: Alex has mean rank 1.50, meaning colleagues on average rank him 1st-2nd place.',
            visual: `<div class="glossary-visual">
                <div class="rank-scale">
                    <span class="rank-value high">1</span>
                    <span class="rank-label">${currentLang === 'uk' ? '–ù–∞–π–≤–∏—â–µ' : 'Highest'}</span>
                    <span class="rank-value low">8</span>
                    <span class="rank-label">${currentLang === 'uk' ? '–ù–∞–π–Ω–∏–∂—á–µ' : 'Lowest'}</span>
                </div>
            </div>`
        },
        {
            term: t('glossary.mae'),
            description: t('glossary.maeDesc'),
            example: currentLang === 'uk' ? 
                '–ü—Ä–∏–∫–ª–∞–¥: Nik –º–∞—î MAE 2.25 - –≤—ñ–Ω –¥—É–º–∞—î —â–æ –∑–∞–π–º–∞—î 2-3 –º—ñ—Å—Ü–µ, –∞–ª–µ —Ä–µ–∞–ª—å–Ω–æ –º–∞—î 4-5.' :
                'Example: Nik has MAE 2.25 - he thinks he\'s ranked 2-3 but actually ranked 4-5.',
            formula: 'MAE = Œ£|Actual Rank - Predicted Rank| / N'
        },
        {
            term: t('glossary.statusScore'),
            description: t('glossary.statusScoreDesc'),
            example: currentLang === 'uk' ? 
                '–ü—Ä–∏–∫–ª–∞–¥: Alex –º–∞—î —Å—Ç–∞—Ç—É—Å 0.938 (93.8%) - –º–∞–π–∂–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π –≤–ø–ª–∏–≤ —É –∫–æ–º–∞–Ω–¥—ñ.' :
                'Example: Alex has status 0.938 (93.8%) - almost maximum influence in team.',
            formula: 'Status = Œ£(9 - rank) / 64'
        },
        {
            term: t('glossary.bias'),
            description: t('glossary.biasDesc'),
            example: currentLang === 'uk' ? 
                '–ü—Ä–∏–∫–ª–∞–¥: Nik –º–∞—î bias +2.25 (–ø–µ—Ä–µ–æ—Ü—ñ–Ω—é—î), Maivi –º–∞—î -0.38 (–Ω–µ–¥–æ–æ—Ü—ñ–Ω—É—î).' :
                'Example: Nik has bias +2.25 (overestimates), Maivi has -0.38 (underestimates).'
        },
        {
            term: t('glossary.top3'),
            description: t('glossary.top3Desc'),
            example: currentLang === 'uk' ? 
                '–ü—Ä–∏–∫–ª–∞–¥: Alex –º–∞—î 8 –≤—Ö–æ–¥–∂–µ–Ω—å - –≤—Å—ñ 8 –∫–æ–ª–µ–≥ –ø–æ—Å—Ç–∞–≤–∏–ª–∏ –π–æ–≥–æ –≤ —Å–≤—ñ–π —Ç–æ–ø-3.' :
                'Example: Alex has 8 entries - all 8 colleagues put him in their top-3.'
        },
        {
            term: t('glossary.gini'),
            description: t('glossary.giniDesc'),
            example: currentLang === 'uk' ? 
                '–ü—Ä–∏–∫–ª–∞–¥: Gini 0.22 –æ–∑–Ω–∞—á–∞—î –ø–æ–º—ñ—Ä–Ω—É –Ω–µ—Ä—ñ–≤–Ω—ñ—Å—Ç—å - —î –ª—ñ–¥–µ—Ä–∏, –∞–ª–µ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü—ñ—è.' :
                'Example: Gini 0.22 means moderate inequality - there are leaders but not critical concentration.'
        },
        {
            term: 'RACI Matrix',
            description: currentLang === 'uk' ? 
                '–ú–∞—Ç—Ä–∏—Ü—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ: Responsible (–≤–∏–∫–æ–Ω—É—î), Accountable (–≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î), Consulted (–∫–æ–Ω—Å—É–ª—å—Ç—É—î), Informed (—ñ–Ω—Ñ–æ—Ä–º—É—î—Ç—å—Å—è).' :
                'Responsibility assignment matrix: Responsible (does), Accountable (owns), Consulted (advises), Informed (notified).',
            example: currentLang === 'uk' ? 
                '–ü—Ä–∏–∫–ª–∞–¥: –í –ø—Ä–æ—Ü–µ—Å—ñ –ø—Ä–æ–¥–∞–∂—ñ–≤ Alex = A (–≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î), Oleg = R (–≤–∏–∫–æ–Ω—É—î), Igor = C (–∫–æ–Ω—Å—É–ª—å—Ç—É—î).' :
                'Example: In sales process Alex = A (accountable), Oleg = R (responsible), Igor = C (consulted).'
        },
        {
            term: 'SOP (Standard Operating Procedure)',
            description: currentLang === 'uk' ? 
                '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ - –ø–æ–∫—Ä–æ–∫–æ–≤–∏–π –æ–ø–∏—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è.' :
                'Standard Operating Procedure - step-by-step description of task execution.',
            example: currentLang === 'uk' ? 
                '–ü—Ä–∏–∫–ª–∞–¥: SOP –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Ç–µ–Ω–¥–µ—Ä—É –≤–∫–ª—é—á–∞—î 7 –∫—Ä–æ–∫—ñ–≤ –≤—ñ–¥ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—É –¥–æ –ø–æ–¥–∞—á—ñ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó.' :
                'Example: Tender processing SOP includes 7 steps from request receipt to proposal submission.'
        }
    ];
    
    container.innerHTML = `
        <div class="glossary-container">
            <h1>${t('titles.glossary')}</h1>
            <p class="glossary-subtitle">${currentLang === 'uk' ? 
                '–î–µ—Ç–∞–ª—å–Ω–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è —Ç–µ—Ä–º—ñ–Ω—ñ–≤ —Ç–∞ –º–µ—Ç—Ä–∏–∫, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –∞–Ω–∞–ª—ñ–∑—ñ' :
                'Detailed explanation of terms and metrics used in analysis'}</p>
            
            <div class="glossary-grid">
                ${glossaryTerms.map(term => `
                    <div class="glossary-card">
                        <h3>${term.term}</h3>
                        <p class="description">${term.description}</p>
                        ${term.formula ? `<div class="formula">Formula: <code>${term.formula}</code></div>` : ''}
                        ${term.example ? `<div class="example"><strong>${currentLang === 'uk' ? '–ü—Ä–∏–∫–ª–∞–¥:' : 'Example:'}</strong> ${term.example}</div>` : ''}
                        ${term.visual || ''}
                    </div>
                `).join('')}
            </div>
            
            ${generateRACIExample()}
            ${generateSOPExample()}
        </div>
    `;
}

function generateRACIExample() {
    return `
        <div class="glossary-section">
            <h2>${currentLang === 'uk' ? '–ü—Ä–∏–∫–ª–∞–¥ RACI –º–∞—Ç—Ä–∏—Ü—ñ –¥–ª—è VQ & IM' : 'RACI Matrix Example for VQ & IM'}</h2>
            <table class="raci-table">
                <thead>
                    <tr>
                        <th>${currentLang === 'uk' ? '–ü—Ä–æ—Ü–µ—Å / –ó–∞–≤–¥–∞–Ω–Ω—è' : 'Process / Task'}</th>
                        <th>Alex<br>(Sales)</th>
                        <th>Igor<br>(Tender)</th>
                        <th>Oleg<br>(CRM)</th>
                        <th>Rami<br>(Sales IM)</th>
                        <th>Nik<br>(Procurement)</th>
                        <th>Stas<br>(Strategy)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>${currentLang === 'uk' ? '–ù–æ–≤—ñ –∫–ª—ñ—î–Ω—Ç–∏' : 'New Clients'}</td>
                        <td class="raci-a">A</td>
                        <td class="raci-c">C</td>
                        <td class="raci-r">R</td>
                        <td class="raci-r">R</td>
                        <td class="raci-i">I</td>
                        <td class="raci-i">I</td>
                    </tr>
                    <tr>
                        <td>${currentLang === 'uk' ? '–¢–µ–Ω–¥–µ—Ä–Ω—ñ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó' : 'Tender Proposals'}</td>
                        <td class="raci-c">C</td>
                        <td class="raci-a">A/R</td>
                        <td class="raci-i">I</td>
                        <td class="raci-c">C</td>
                        <td class="raci-r">R</td>
                        <td class="raci-i">I</td>
                    </tr>
                    <tr>
                        <td>${currentLang === 'uk' ? 'CRM –æ–Ω–æ–≤–ª–µ–Ω–Ω—è' : 'CRM Updates'}</td>
                        <td class="raci-i">I</td>
                        <td class="raci-i">I</td>
                        <td class="raci-a">A/R</td>
                        <td class="raci-r">R</td>
                        <td class="raci-i">I</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>${currentLang === 'uk' ? '–¶—ñ–Ω–æ—É—Ç–≤–æ—Ä–µ–Ω–Ω—è' : 'Pricing'}</td>
                        <td class="raci-a">A</td>
                        <td class="raci-c">C</td>
                        <td class="raci-i">I</td>
                        <td class="raci-c">C</td>
                        <td class="raci-c">C</td>
                        <td class="raci-c">C</td>
                    </tr>
                    <tr>
                        <td>${currentLang === 'uk' ? '–°—Ç—Ä–∞—Ç–µ–≥—ñ—á–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è' : 'Strategic Decisions'}</td>
                        <td class="raci-c">C</td>
                        <td class="raci-c">C</td>
                        <td class="raci-i">I</td>
                        <td class="raci-i">I</td>
                        <td class="raci-i">I</td>
                        <td class="raci-a">A/R</td>
                    </tr>
                </tbody>
            </table>
            <div class="raci-legend">
                <span><strong>R</strong> - Responsible (${currentLang === 'uk' ? '–í–∏–∫–æ–Ω—É—î' : 'Does'})</span>
                <span><strong>A</strong> - Accountable (${currentLang === 'uk' ? '–í—ñ–¥–ø–æ–≤—ñ–¥–∞—î' : 'Owns'})</span>
                <span><strong>C</strong> - Consulted (${currentLang === 'uk' ? '–ö–æ–Ω—Å—É–ª—å—Ç—É—î' : 'Advises'})</span>
                <span><strong>I</strong> - Informed (${currentLang === 'uk' ? '–Ü–Ω—Ñ–æ—Ä–º—É—î—Ç—å—Å—è' : 'Notified'})</span>
            </div>
        </div>
    `;
}

function generateSOPExample() {
    return `
        <div class="glossary-section">
            <h2>${currentLang === 'uk' ? '–ü—Ä–∏–∫–ª–∞–¥ SOP: –û–±—Ä–æ–±–∫–∞ —Ç–µ–Ω–¥–µ—Ä–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É' : 'SOP Example: Tender Request Processing'}</h2>
            <div class="sop-container">
                <div class="sop-header">
                    <p><strong>${currentLang === 'uk' ? '–í–ª–∞—Å–Ω–∏–∫ –ø—Ä–æ—Ü–µ—Å—É:' : 'Process Owner:'}</strong> Igor Bordunov</p>
                    <p><strong>${currentLang === 'uk' ? '–£—á–∞—Å–Ω–∏–∫–∏:' : 'Participants:'}</strong> Igor, Nik, Rami, Alex</p>
                    <p><strong>${currentLang === 'uk' ? '–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:' : 'Execution Time:'}</strong> 2-3 ${currentLang === 'uk' ? '–¥–Ω—ñ' : 'days'}</p>
                </div>
                
                <div class="sop-steps">
                    <div class="sop-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>${currentLang === 'uk' ? '–û—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—É' : 'Request Receipt'}</h4>
                            <p><strong>${currentLang === 'uk' ? '–í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–π:' : 'Responsible:'}</strong> Igor</p>
                            <p>${currentLang === 'uk' ? 
                                '–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –≤ CRM –ø—Ä–æ—Ç—è–≥–æ–º 2 –≥–æ–¥–∏–Ω, –ø—Ä–∏—Å–≤–æ—î–Ω–Ω—è ID, –ø–µ—Ä–≤–∏–Ω–Ω–∞ –æ—Ü—ñ–Ω–∫–∞ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ.' :
                                'CRM registration within 2 hours, ID assignment, initial complexity assessment.'}</p>
                        </div>
                    </div>
                    
                    <div class="sop-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>${currentLang === 'uk' ? '–¢–µ—Ö–Ω—ñ—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑' : 'Technical Analysis'}</h4>
                            <p><strong>${currentLang === 'uk' ? '–í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–π:' : 'Responsible:'}</strong> Igor + Nik</p>
                            <p>${currentLang === 'uk' ? 
                                '–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –≤–∏–º–æ–≥, –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ, –æ—Ü—ñ–Ω–∫–∞ —Ç–µ—Ä–º—ñ–Ω—ñ–≤ –ø–æ—Å—Ç–∞–≤–∫–∏.' :
                                'Requirements definition, availability check, delivery timeline estimation.'}</p>
                        </div>
                    </div>
                    
                    <div class="sop-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>${currentLang === 'uk' ? '–ö–æ–º–µ—Ä—Ü—ñ–π–Ω–∞ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—è' : 'Commercial Proposal'}</h4>
                            <p><strong>${currentLang === 'uk' ? '–í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–π:' : 'Responsible:'}</strong> Rami</p>
                            <p>${currentLang === 'uk' ? 
                                '–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–∞—Ä—Ç–æ—Å—Ç—ñ, –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –ö–ü –∑–∞ —à–∞–±–ª–æ–Ω–æ–º, —É–∑–≥–æ–¥–∂–µ–Ω–Ω—è –∑ Alex.' :
                                'Cost calculation, proposal preparation using template, approval with Alex.'}</p>
                        </div>
                    </div>
                    
                    <div class="sop-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>${currentLang === 'uk' ? '–§—ñ–Ω–∞–ª—å–Ω–µ –∑–∞—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è' : 'Final Approval'}</h4>
                            <p><strong>${currentLang === 'uk' ? '–í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–π:' : 'Responsible:'}</strong> Alex</p>
                            <p>${currentLang === 'uk' ? 
                                '–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ, —É–º–æ–≤ –æ–ø–ª–∞—Ç–∏, —Å—Ç—Ä–∞—Ç–µ–≥—ñ—á–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ.' :
                                'Margin check, payment terms, strategic alignment verification.'}</p>
                        </div>
                    </div>
                    
                    <div class="sop-step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <h4>${currentLang === 'uk' ? '–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –∫–ª—ñ—î–Ω—Ç—É' : 'Client Submission'}</h4>
                            <p><strong>${currentLang === 'uk' ? '–í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–π:' : 'Responsible:'}</strong> Igor</p>
                            <p>${currentLang === 'uk' ? 
                                '–í—ñ–¥–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ –æ—Ñ—ñ—Ü—ñ–π–Ω—ñ –∫–∞–Ω–∞–ª–∏, –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞—Ç–∏ follow-up.' :
                                'Submission through official channels, receipt confirmation, follow-up date setting.'}</p>
                        </div>
                    </div>
                </div>
                
                <div class="sop-metrics">
                    <h4>${currentLang === 'uk' ? 'KPI –ø—Ä–æ—Ü–µ—Å—É:' : 'Process KPIs:'}</h4>
                    <ul>
                        <li>${currentLang === 'uk' ? '–ß–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ < 48 –≥–æ–¥–∏–Ω' : 'Response time < 48 hours'}</li>
                        <li>${currentLang === 'uk' ? '–ö–æ–Ω–≤–µ—Ä—Å—ñ—è —Ç–µ–Ω–¥–µ—Ä ‚Üí –∫–æ–Ω—Ç—Ä–∞–∫—Ç > 25%' : 'Tender ‚Üí contract conversion > 25%'}</li>
                        <li>${currentLang === 'uk' ? '–¢–æ—á–Ω—ñ—Å—Ç—å —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤ 98%' : 'Calculation accuracy 98%'}</li>
                    </ul>
                </div>
            </div>
        </div>
    `;
}

// ===== Enhanced 3D Visualization with Correct Hierarchy =====
function render3DVisualization(members) {
    const container = document.getElementById('threeContainer');
    container.style.display = 'block';
    
    // Scene setup
    scene = new THREE.Scene();
    scene.fog = new THREE.Fog(0x0a0a0a, 100, 500);
    
    // Camera
    const aspect = container.clientWidth / container.clientHeight;
    camera = new THREE.PerspectiveCamera(75, aspect, 0.1, 1000);
    camera.position.set(0, 150, 300);
    camera.lookAt(0, 0, 0);
    
    // Renderer with performance settings
    renderer = new THREE.WebGLRenderer({ 
        antialias: !preferReducedMotion, // Disable antialiasing for reduced motion
        alpha: true,
        powerPreference: "high-performance",
        preserveDrawingBuffer: true // For screenshots
    });
    renderer.setSize(container.clientWidth, container.clientHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); // Limit pixel ratio for performance
    renderer.shadowMap.enabled = !preferReducedMotion;
    renderer.shadowMap.type = THREE.PCFSoftShadowMap;
    container.appendChild(renderer.domElement);
    
    // Enhanced Lighting
    const ambientLight = new THREE.AmbientLight(0xffffff, 0.3);
    scene.add(ambientLight);
    
    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
    directionalLight.position.set(50, 100, 50);
    directionalLight.castShadow = !preferReducedMotion;
    directionalLight.shadow.camera.near = 0.1;
    directionalLight.shadow.camera.far = 500;
    directionalLight.shadow.camera.left = -200;
    directionalLight.shadow.camera.right = 200;
    directionalLight.shadow.camera.top = 200;
    directionalLight.shadow.camera.bottom = -200;
    scene.add(directionalLight);
    
    // Colored lights for atmosphere
    if (!preferReducedMotion) {
        const lights = [
            { color: 0x00d4ff, position: [100, 50, 100] },
            { color: 0xa855f7, position: [-100, 50, -100] },
            { color: 0xff0080, position: [0, 100, 0] }
        ];
        
        lights.forEach(light => {
            const pointLight = new THREE.PointLight(light.color, 0.8, 300);
            pointLight.position.set(...light.position);
            scene.add(pointLight);
        });
    }
    
    // Add ground plane
    const groundGeometry = new THREE.PlaneGeometry(600, 600);
    const groundMaterial = new THREE.MeshStandardMaterial({ 
        color: 0x0a0a0a,
        metalness: 0.5,
        roughness: 0.8
    });
    const ground = new THREE.Mesh(groundGeometry, groundMaterial);
    ground.rotation.x = -Math.PI / 2;
    ground.position.y = -150;
    ground.receiveShadow = true;
    scene.add(ground);
    
    // Level configurations - C-Level at TOP
    const levels = [
        { name: 'C-Level', minRank: 0, maxRank: 2.5, y: 150, color: 0xff0080, radius: 100 }, // Highest
        { name: 'Senior', minRank: 0, maxRank: 2.5, y: 100, color: 0xff6b35, radius: 120 },
        { name: 'Middle', minRank: 2.5, maxRank: 5, y: 50, color: 0xffea00, radius: 140 },
        { name: 'Junior', minRank: 5, maxRank: 10, y: 0, color: 0x00ff88, radius: 160 } // Lowest
    ];
    
    // Create level platforms
    levels.forEach(level => {
        // Outer ring
        const ringGeometry = new THREE.TorusGeometry(level.radius, 3, 8, 32);
        const ringMaterial = new THREE.MeshStandardMaterial({ 
            color: level.color,
            emissive: level.color,
            emissiveIntensity: 0.3
        });
        const ring = new THREE.Mesh(ringGeometry, ringMaterial);
        ring.rotation.x = Math.PI / 2;
        ring.position.y = level.y;
        ring.receiveShadow = true;
        ring.castShadow = true;
        scene.add(ring);
        sceneObjects.levelRings.push(ring);
        
        // Platform disc with transparency
        const platformGeometry = new THREE.CylinderGeometry(
            level.radius - 5, 
            level.radius - 5, 
            2, 
            32
        );
        const platformMaterial = new THREE.MeshStandardMaterial({ 
            color: level.color,
            transparent: true,
            opacity: 0.1,
            emissive: level.color,
            emissiveIntensity: 0.1
        });
        const platform = new THREE.Mesh(platformGeometry, platformMaterial);
        platform.position.y = level.y;
        scene.add(platform);
    });
    
    // Group members by actual level
    const membersByLevel = {
        'C-Level': members.filter(m => m.level === 'C-Level'),
        'Senior': members.filter(m => m.level === 'Senior'),
        'Middle': members.filter(m => m.level === 'Middle'),
        'Junior': members.filter(m => m.level === 'Junior')
    };
    
    // Create nodes
    Object.entries(membersByLevel).forEach(([levelName, levelMembers]) => {
        const level = levels.find(l => l.name === levelName);
        if (!level) return;
        
        levelMembers.forEach((member, index) => {
            const totalInLevel = levelMembers.length;
            const angle = (index / totalInLevel) * Math.PI * 2;
            
            // Node sphere - size based on status score
            const size = 6 + member.statusScoreOwnership * 12;
            const geometry = new THREE.SphereGeometry(size, 32, 32);
            
            const color = member.company === 'Vagoteq' ? 0x00d4ff : 0xa855f7;
            const material = new THREE.MeshPhongMaterial({
                color: color,
                emissive: color,
                emissiveIntensity: 0.3,
                shininess: 100
            });
            
            const mesh = new THREE.Mesh(geometry, material);
            mesh.castShadow = true;
            mesh.receiveShadow = true;
            
            // Position on level ring
            const radiusVariation = (Math.random() - 0.5) * 20;
            const actualRadius = level.radius + radiusVariation - 20;
            mesh.position.x = Math.cos(angle) * actualRadius;
            mesh.position.y = level.y;
            mesh.position.z = Math.sin(angle) * actualRadius;
            
            // Add floating animation data
            mesh.userData = {
                ...member,
                floatOffset: Math.random() * Math.PI * 2,
                floatSpeed: 0.5 + Math.random() * 0.5,
                originalY: level.y
            };
            
            scene.add(mesh);
            sceneObjects.nodes.set(member.id, mesh);
            sceneObjects.nodeObjects.push(mesh);
            
            // Text label with NAME not code
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.width = 512;
            canvas.height = 128;
            
            // Gradient background
            const gradient = context.createLinearGradient(0, 0, canvas.width, 0);
            gradient.addColorStop(0, 'rgba(0, 0, 0, 0.8)');
            gradient.addColorStop(0.5, 'rgba(0, 0, 0, 0.9)');
            gradient.addColorStop(1, 'rgba(0, 0, 0, 0.8)');
            context.fillStyle = gradient;
            context.fillRect(0, 0, canvas.width, canvas.height);
            
            // Text with NAME
            context.font = 'Bold 32px Inter';
            context.fillStyle = '#ffffff';
            context.textAlign = 'center';
            context.fillText(member.firstName || member.name.split(' ')[0], 256, 45);
            
            context.font = '24px Inter';
            context.fillStyle = member.company === 'Vagoteq' ? '#00d4ff' : '#a855f7';
            context.fillText(`${member.role}`, 256, 80);
            
            const texture = new THREE.CanvasTexture(canvas);
            texture.needsUpdate = true;
            const spriteMaterial = new THREE.SpriteMaterial({ 
                map: texture,
                transparent: true
            });
            const sprite = new THREE.Sprite(spriteMaterial);
            sprite.scale.set(50, 12.5, 1);
            sprite.position.copy(mesh.position);
            sprite.position.y += size + 10;
            scene.add(sprite);
            sceneObjects.sprites.push({ sprite, node: mesh, size });
        });
    });
    
    // Create connections
    members.forEach(member => {
        const sourceNode = sceneObjects.nodes.get(member.id);
        if (!sourceNode) return;
        
        if (filters.positive) {
            member.preferred.forEach(targetId => {
                const targetNode = sceneObjects.nodes.get(targetId);
                if (targetNode) {
                    const isMutual = mutualTop3Ownership.some(([id1, id2]) => 
                        (id1 === member.id && id2 === targetId) || 
                        (id2 === member.id && id1 === targetId)
                    );
                    const connection = createEnhanced3DConnection(sourceNode, targetNode, 0x00ff88, isMutual ? 0.9 : 0.6);
                    sceneObjects.connections.push(connection);
                    scene.add(connection);
                }
            });
        }
        
        if (filters.negative) {
            member.leastPreferred.forEach(targetId => {
                const targetNode = sceneObjects.nodes.get(targetId);
                if (targetNode) {
                    const connection = createEnhanced3DConnection(sourceNode, targetNode, 0xff0080, 0.4);
                    sceneObjects.connections.push(connection);
                    scene.add(connection);
                }
            });
        }
    });
    
    // Mouse interaction
    raycaster = new THREE.Raycaster();
    mouse = new THREE.Vector2();
    
    renderer.domElement.addEventListener('mousemove', onMouseMove3D, false);
    renderer.domElement.addEventListener('click', onMouseClick3D, false);
    
    function onMouseMove3D(event) {
        const rect = renderer.domElement.getBoundingClientRect();
        mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
        mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
        
        raycaster.setFromCamera(mouse, camera);
        const intersects = raycaster.intersectObjects(sceneObjects.nodeObjects);
        
        renderer.domElement.style.cursor = intersects.length > 0 ? 'pointer' : 'grab';
        
        if (intersects.length > 0) {
            const member = intersects[0].object.userData;
            showTooltip(event, member);
        } else {
            hideTooltip();
        }
    }
    
    function onMouseClick3D(event) {
        raycaster.setFromCamera(mouse, camera);
        const intersects = raycaster.intersectObjects(sceneObjects.nodeObjects);
        
        if (intersects.length > 0) {
            const member = intersects[0].object.userData;
            selectNode3D(member, intersects[0].object);
        }
    }
    
    // Camera controls
    setupEnhancedCameraControls();
    
    // Animation loop
    if (!preferReducedMotion) {
        animate3D();
    } else {
        // Single render for reduced motion
        renderer.render(scene, camera);
    }
}

function createEnhanced3DConnection(source, target, color, opacity) {
    const points = [];
    const segments = preferReducedMotion ? 10 : 30; // Less segments for performance
    
    for (let i = 0; i <= segments; i++) {
        const t = i / segments;
        const x = source.position.x * (1 - t) + target.position.x * t;
        const y = source.position.y * (1 - t) + target.position.y * t;
        const z = source.position.z * (1 - t) + target.position.z * t;
        
        // Add curve
        const curve = Math.sin(t * Math.PI) * 20;
        points.push(new THREE.Vector3(x, y + curve, z));
    }
    
    const geometry = new THREE.BufferGeometry().setFromPoints(points);
    const material = new THREE.LineBasicMaterial({
        color: color,
        opacity: opacity,
        transparent: true,
        linewidth: 2
    });
    
    const line = new THREE.Line(geometry, material);
    return line;
}

function animate3D() {
    animationId = requestAnimationFrame(animate3D);
    
    if (!animationPaused) {
        // Rotate scene slowly
        scene.rotation.y += 0.001;
        
        // Animate nodes floating
        const time = Date.now() * 0.001;
        sceneObjects.nodeObjects.forEach((node) => {
            const userData = node.userData;
            const floatY = Math.sin(time * userData.floatSpeed + userData.floatOffset) * 3;
            node.position.y = userData.originalY + floatY;
        });
        
        // Update sprite positions
        sceneObjects.sprites.forEach(({ sprite, node, size }) => {
            sprite.position.copy(node.position);
            sprite.position.y += size + 12;
        });
    }
    
    renderer.render(scene, camera);
}

function selectNode3D(member, mesh) {
    // Update info panel
    const infoPanel = document.getElementById('selectedInfo3D');
    
    infoPanel.innerHTML = `
        <h5>${member.name}</h5>
        <p>${member.role} ‚Ä¢ ${member.company}</p>
        <div class="node-metrics">
            <div class="metric-small">
                <span class="label">${t('member.meanRank')}:</span>
                <span class="value">${member.meanRankOwnership.toFixed(2)}</span>
            </div>
            <div class="metric-small">
                <span class="label">${t('member.top3Count')}:</span>
                <span class="value">${member.top3CountOwnership}</span>
            </div>
            <div class="metric-small">
                <span class="label">${t('member.statusScore')}:</span>
                <span class="value">${member.statusScoreOwnership.toFixed(3)}</span>
            </div>
            <div class="metric-small">
                <span class="label">${t('quick.positive')}:</span>
                <span class="value">${member.preferred.length}</span>
            </div>
            <div class="metric-small">
                <span class="label">${t('quick.negative')}:</span>
                <span class="value">${member.leastPreferred.length}</span>
            </div>
            <div class="metric-small">
                <span class="label">${t('member.bias')}:</span>
                <span class="value ${member.biasOwnership > 0 ? 'negative' : 'positive'}">${member.biasOwnership > 0 ? '+' : ''}${member.biasOwnership.toFixed(2)}</span>
            </div>
        </div>
        <button class="detail-btn" onclick="showQuickInfo(teamData.members.find(m => m.id === '${member.id}'), event)">
            ${t('quick.details')}
        </button>
    `;
    
    // Highlight node
    sceneObjects.nodeObjects.forEach(node => {
        if (node === mesh) {
            node.scale.set(1.2, 1.2, 1.2);
        } else {
            node.scale.set(1, 1, 1);
        }
    });
}

function setupEnhancedCameraControls() {
    let isDragging = false;
    let previousMousePosition = { x: 0, y: 0 };
    
    renderer.domElement.addEventListener('mousedown', () => {
        isDragging = true;
        renderer.domElement.style.cursor = 'grabbing';
    });
    
    renderer.domElement.addEventListener('mouseup', () => {
        isDragging = false;
        renderer.domElement.style.cursor = 'grab';
    });
    
    renderer.domElement.addEventListener('mousemove', (e) => {
        if (isDragging) {
            const deltaMove = {
                x: e.clientX - previousMousePosition.x,
                y: e.clientY - previousMousePosition.y
            };
            
            const rotationSpeed = 0.005;
            scene.rotation.y += deltaMove.x * rotationSpeed;
            camera.position.y -= deltaMove.y * 0.5;
            camera.position.y = Math.max(-50, Math.min(250, camera.position.y));
        }
        
        previousMousePosition = { x: e.clientX, y: e.clientY };
    });
    
    renderer.domElement.addEventListener('wheel', (e) => {
        e.preventDefault();
        camera.position.z += e.deltaY * 0.1;
        camera.position.z = Math.max(150, Math.min(500, camera.position.z));
    });
}

// ===== Enhanced Force Graph with Better Spacing =====
function renderForceGraph(members) {
    const svg = d3.select('#svgCanvas');
    svg.style('display', 'block');
    
    const width = svg.node().getBoundingClientRect().width;
    const height = svg.node().getBoundingClientRect().height;
    
    svg.attr('viewBox', `0 0 ${width} ${height}`);
    
    // Prepare data
    const nodes = members.map(m => ({ ...m }));
    const links = [];
    
    members.forEach(member => {
        if (filters.positive && filters.outgoing) {
            member.preferred.forEach(targetId => {
                const target = members.find(m => m.id === targetId);
                if (target) {
                    const isMutual = mutualTop3Ownership.some(([id1, id2]) => 
                        (id1 === member.id && id2 === targetId) || 
                        (id2 === member.id && id1 === targetId)
                    );
                    links.push({
                        source: member.id,
                        target: targetId,
                        type: 'positive',
                        direction: 'outgoing',
                        strength: isMutual ? 0.9 : 0.7,
                        mutual: isMutual
                    });
                }
            });
        }
        
        if (filters.negative && filters.outgoing) {
            member.leastPreferred.forEach(targetId => {
                const target = members.find(m => m.id === targetId);
                if (target) {
                    links.push({
                        source: member.id,
                        target: targetId,
                        type: 'negative',
                        direction: 'outgoing',
                        strength: 0.5,
                        mutual: false
                    });
                }
            });
        }
    });
    
    // Add incoming links if filter is active
    if (filters.incoming) {
        const incomingLinks = [];
        links.forEach(link => {
            if (!links.find(l => l.source === link.target && l.target === link.source)) {
                incomingLinks.push({
                    source: link.target,
                    target: link.source,
                    type: link.type,
                    direction: 'incoming',
                    strength: link.strength,
                    mutual: link.mutual
                });
            }
        });
        incomingLinks.forEach(il => {
            if (!links.find(l => l.source === il.source && l.target === il.target)) {
                links.push(il);
            }
        });
    }
    
    // Create simulation with increased spacing
    const simulation = d3.forceSimulation(nodes)
        .force('link', d3.forceLink(links).id(d => d.id).distance(d => {
            const source = nodes.find(n => n.id === d.source.id || n.id === d.source);
            const target = nodes.find(n => n.id === d.target.id || n.id === d.target);
            if (source && target) {
                // Increase distance for better spacing
                return 180 + Math.abs(source.meanRankOwnership - target.meanRankOwnership) * 40;
            }
            return 250;
        }).strength(d => d.mutual ? 0.8 : 0.5))
        .force('charge', d3.forceManyBody().strength(-1500)) // Increased repulsion
        .force('center', d3.forceCenter(width / 2, height / 2))
        .force('collision', d3.forceCollide().radius(d => 70 + (8 - d.meanRankOwnership) * 10)) // Increased collision radius
        .force('y', d3.forceY(d => {
            // Position nodes vertically based on mean rank
            return height * (d.meanRankOwnership / 8);
        }).strength(0.5));
    
    const g = svg.append('g');
    
    // Zoom behavior
    const zoom = d3.zoom()
        .scaleExtent([0.1, 10])
        .on('zoom', (event) => {
            g.attr('transform', event.transform);
        });
    
    svg.call(zoom);
    
    // Create arrow markers
    svg.append('defs').selectAll('marker')
        .data(['positive-arrow', 'negative-arrow', 'positive-mutual-arrow', 'negative-mutual-arrow'])
        .enter().append('marker')
        .attr('id', d => d)
        .attr('viewBox', '0 -5 10 10')
        .attr('refX', 45) // Adjusted for larger nodes
        .attr('refY', 0)
        .attr('markerWidth', 6)
        .attr('markerHeight', 6)
        .attr('orient', 'auto')
        .append('path')
        .attr('d', 'M0,-5L10,0L0,5')
        .attr('fill', d => d.includes('positive') ? '#00ff88' : '#ff0080');
    
    // Create links
    const link = g.append('g')
        .selectAll('line')
        .data(links)
        .enter().append('line')
        .attr('stroke', d => d.type === 'positive' ? '#00ff88' : '#ff0080')
        .attr('stroke-opacity', d => d.strength)
        .attr('stroke-width', d => d.mutual ? 3 : 2)
        .attr('class', d => `link ${d.direction} ${d.mutual ? 'mutual' : ''}`)
        .attr('marker-end', d => `url(#${d.type}-${d.mutual ? 'mutual-' : ''}arrow)`);
    
    // Style incoming vs outgoing
    link.filter(d => d.direction === 'incoming')
        .attr('stroke-dasharray', '5,5');
    
    // Create nodes
    const node = g.append('g')
        .selectAll('g')
        .data(nodes)
        .enter().append('g')
        .attr('class', 'node')
        .call(d3.drag()
            .on('start', dragstarted)
            .on('drag', dragged)
            .on('end', dragended));
    
    // Node circles - size based on status score
    node.append('circle')
        .attr('r', d => 30 + d.statusScoreOwnership * 30) // Larger nodes
        .attr('fill', d => d.company === 'Vagoteq' ? '#00d4ff' : '#a855f7')
        .attr('stroke', '#fff')
        .attr('stroke-width', 2)
        .style('cursor', 'pointer');
    
    // Leader indicator
    node.filter(d => d.leader)
        .append('circle')
        .attr('r', d => 35 + d.statusScoreOwnership * 30)
        .attr('fill', 'none')
        .attr('stroke', '#ffea00')
        .attr('stroke-width', 3)
        .attr('stroke-dasharray', '5,5');
    
    // Node text - show NAME not code
    node.append('text')
        .text(d => d.firstName || d.name.split(' ')[0])
        .attr('text-anchor', 'middle')
        .attr('dy', '0.35em')
        .attr('fill', '#fff')
        .attr('font-weight', 'bold')
        .attr('font-size', '14px')
        .style('pointer-events', 'none');
    
    // Labels with role
    node.append('text')
        .text(d => d.role)
        .attr('text-anchor', 'middle')
        .attr('dy', d => 45 + d.statusScoreOwnership * 30)
        .attr('fill', '#fff')
        .attr('font-size', '11px')
        .style('pointer-events', 'none');
    
    // Rank indicator
    node.append('text')
        .text(d => `#${d.meanRankOwnership.toFixed(1)}`)
        .attr('text-anchor', 'middle')
        .attr('dy', d => -(35 + d.statusScoreOwnership * 30))
        .attr('fill', d => d.company === 'Vagoteq' ? '#00d4ff' : '#a855f7')
        .attr('font-size', '12px')
        .attr('font-weight', 'bold')
        .style('pointer-events', 'none');
    
    // Interaction
    node.on('mouseover', function(event, d) {
        // Highlight connections
        link.classed('highlighted', l => 
            l.source.id === d.id || l.target.id === d.id
        );
        link.classed('dimmed', l => 
            !(l.source.id === d.id || l.target.id === d.id)
        );
        
        node.classed('highlighted', n => {
            if (n.id === d.id) return true;
            return links.some(l => 
                (l.source.id === d.id && l.target.id === n.id) ||
                (l.target.id === d.id && l.source.id === n.id)
            );
        });
        
        showTooltip(event, d);
    })
    .on('mouseout', function() {
        link.classed('highlighted', false);
        link.classed('dimmed', false);
        node.classed('highlighted', false);
        hideTooltip();
    })
    .on('click', function(event, d) {
        event.stopPropagation();
        showQuickInfo(d, event);
    });
    
    // Update positions
    simulation.on('tick', () => {
        link
            .attr('x1', d => d.source.x)
            .attr('y1', d => d.source.y)
            .attr('x2', d => d.target.x)
            .attr('y2', d => d.target.y);
        
        node.attr('transform', d => `translate(${d.x},${d.y})`);
    });
    
    function dragstarted(event, d) {
        if (!event.active) simulation.alphaTarget(0.3).restart();
        d.fx = d.x;
        d.fy = d.y;
    }
    
    function dragged(event, d) {
        d.fx = event.x;
        d.fy = event.y;
    }
    
    function dragended(event, d) {
        if (!event.active) simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
    }
}

// ===== Fixed Circular Layout =====
function renderCircularLayout(members) {
    const svg = d3.select('#svgCanvas');
    svg.style('display', 'block');
    
    const width = svg.node().getBoundingClientRect().width;
    const height = svg.node().getBoundingClientRect().height;
    const radius = Math.min(width, height) / 2 - 180;
    const centerX = width / 2;
    const centerY = height / 2;
    
    svg.attr('viewBox', `0 0 ${width} ${height}`);
    
    const g = svg.append('g')
        .attr('transform', `translate(${centerX}, ${centerY})`);
    
    // Company colors
    const companyColors = {
        'Vagoteq': '#00d4ff',
        'Intermastra': '#a855f7'
    };
    
    // Sort members by mean rank for better positioning
    members.sort((a, b) => a.meanRankOwnership - b.meanRankOwnership);
    
    // Position nodes in circle
    const angleStep = (2 * Math.PI) / members.length;
    members.forEach((member, i) => {
        const angle = i * angleStep - Math.PI / 2;
        member.x = Math.cos(angle) * radius;
        member.y = Math.sin(angle) * radius;
        member.angle = angle;
    });
    
    // Create links
    const links = [];
    members.forEach(member => {
        if (filters.positive) {
            member.preferred.forEach(targetId => {
                const target = members.find(m => m.id === targetId);
                if (target) {
                    const isMutual = mutualTop3Ownership.some(([id1, id2]) => 
                        (id1 === member.id && id2 === targetId) || 
                        (id2 === member.id && id1 === targetId)
                    );
                    links.push({
                        source: member,
                        target: target,
                        type: 'positive',
                        mutual: isMutual
                    });
                }
            });
        }
        if (filters.negative) {
            member.leastPreferred.forEach(targetId => {
                const target = members.find(m => m.id === targetId);
                if (target) {
                    links.push({
                        source: member,
                        target: target,
                        type: 'negative',
                        mutual: false
                    });
                }
            });
        }
    });
    
    // Draw company arcs
    const arc = d3.arc()
        .innerRadius(radius - 20)
        .outerRadius(radius + 20);
    
    let currentAngle = -Math.PI / 2;
    ['Vagoteq', 'Intermastra'].forEach(company => {
        const companyMembers = members.filter(m => m.company === company);
        const angleSize = (companyMembers.length / members.length) * 2 * Math.PI;
        
        g.append('path')
            .attr('d', arc({
                startAngle: currentAngle,
                endAngle: currentAngle + angleSize
            }))
            .attr('fill', companyColors[company])
            .attr('opacity', 0.2);
        
        // Company label
        const midAngle = currentAngle + angleSize / 2;
        const labelRadius = radius + 60;
        g.append('text')
            .attr('x', Math.cos(midAngle) * labelRadius)
            .attr('y', Math.sin(midAngle) * labelRadius)
            .attr('text-anchor', 'middle')
            .attr('fill', companyColors[company])
            .attr('font-size', '20px')
            .attr('font-weight', 'bold')
            .text(company);
        
        currentAngle += angleSize;
    });
    
    // Draw links with curves
    const linkGroup = g.append('g');
    links.forEach(link => {
        const path = d3.path();
        path.moveTo(link.source.x, link.source.y);
        path.quadraticCurveTo(0, 0, link.target.x, link.target.y);
        
        linkGroup.append('path')
            .attr('d', path.toString())
            .attr('stroke', link.type === 'positive' ? '#00ff88' : '#ff0080')
            .attr('stroke-opacity', link.mutual ? 0.9 : 0.6)
            .attr('stroke-width', link.mutual ? 3 : 2)
            .attr('fill', 'none')
            .attr('class', `circular-link ${link.mutual ? 'mutual' : ''}`)
            .datum(link);
    });
    
    // Draw nodes
    const nodeGroup = g.append('g');
    const nodes = nodeGroup.selectAll('g')
        .data(members)
        .enter().append('g')
        .attr('transform', d => `translate(${d.x}, ${d.y})`)
        .attr('class', 'circular-node');
    
    // Node circles - size based on status score
    nodes.append('circle')
        .attr('r', d => 25 + d.statusScoreOwnership * 25)
        .attr('fill', d => companyColors[d.company])
        .attr('stroke', '#fff')
        .attr('stroke-width', 2)
        .style('cursor', 'pointer');
    
    // Leader indicator
    nodes.filter(d => d.leader)
        .append('circle')
        .attr('r', d => 30 + d.statusScoreOwnership * 25)
        .attr('fill', 'none')
        .attr('stroke', '#ffea00')
        .attr('stroke-width', 3)
        .attr('stroke-dasharray', '5,5');
    
    // Node text - show NAME
    nodes.append('text')
        .text(d => d.firstName || d.name.split(' ')[0])
        .attr('text-anchor', 'middle')
        .attr('dy', '0.35em')
        .attr('fill', '#fff')
        .attr('font-weight', 'bold')
        .attr('font-size', '14px');
    
    // External labels with rank
    nodes.append('text')
        .text(d => `${d.name} (#${d.meanRankOwnership.toFixed(1)})`)
        .attr('x', d => Math.cos(d.angle) * 60)
        .attr('y', d => Math.sin(d.angle) * 60)
        .attr('text-anchor', d => {
            if (d.angle > -Math.PI/2 && d.angle < Math.PI/2) return 'start';
            return 'end';
        })
        .attr('fill', '#fff')
        .attr('font-size', '12px');
    
    // Interaction
    nodes.on('mouseover', function(event, d) {
        // Highlight connections
        const connectedNodes = new Set([d.id]);
        links.forEach(link => {
            if (link.source.id === d.id) connectedNodes.add(link.target.id);
            if (link.target.id === d.id) connectedNodes.add(link.source.id);
        });
        
        linkGroup.selectAll('.circular-link')
            .classed('highlighted', link => 
                link.source.id === d.id || link.target.id === d.id
            )
            .classed('dimmed', link => 
                !(link.source.id === d.id || link.target.id === d.id)
            );
        
        nodes.style('opacity', n => connectedNodes.has(n.id) ? 1 : 0.3);
        
        showSideInfo(d);
    })
    .on('mouseout', function() {
        linkGroup.selectAll('.circular-link')
            .classed('highlighted', false)
            .classed('dimmed', false);
        nodes.style('opacity', 1);
        hideSideInfo();
    })
    .on('click', function(event, d) {
        event.stopPropagation();
        showQuickInfo(d, event);
    });
}

// ===== Heat Map =====
function renderHeatmap(members) {
    const canvas = document.getElementById('heatmapCanvas');
    canvas.style.display = 'block';
    const ctx = canvas.getContext('2d');
    
    canvas.width = canvas.clientWidth;
    canvas.height = canvas.clientHeight;
    
    // Sort members by mean rank for better visibility
    members.sort((a, b) => a.meanRankOwnership - b.meanRankOwnership);
    
    const cellSize = Math.min(
        (canvas.width - 300) / members.length,
        (canvas.height - 300) / members.length,
        50
    );
    
    const offsetX = (canvas.width - cellSize * members.length) / 2;
    const offsetY = 150;
    
    // Clear canvas
    ctx.fillStyle = '#0a0a0a';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // Title
    ctx.fillStyle = '#fff';
    ctx.font = 'bold 24px Inter';
    ctx.textAlign = 'center';
    ctx.fillText(t('titles.heatmap'), canvas.width / 2, 40);
    
    // Create interaction matrix
    const matrix = [];
    members.forEach((member, i) => {
        matrix[i] = new Array(members.length).fill(0);
        member.preferred.forEach(targetId => {
            const targetIndex = members.findIndex(m => m.id === targetId);
            if (targetIndex !== -1) {
                const isMutual = mutualTop3Ownership.some(([id1, id2]) => 
                    (id1 === member.id && id2 === targetId) || 
                    (id2 === member.id && id1 === targetId)
                );
                matrix[i][targetIndex] = isMutual ? 2 : 1;
            }
        });
        member.leastPreferred.forEach(targetId => {
            const targetIndex = members.findIndex(m => m.id === targetId);
            if (targetIndex !== -1) matrix[i][targetIndex] = -1;
        });
    });
    
    // Store current highlight state
    let highlightedRow = -1;
    let highlightedCol = -1;
    
    // Draw function
    function drawHeatmap() {
        ctx.fillStyle = '#0a0a0a';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        // Title
        ctx.fillStyle = '#fff';
        ctx.font = 'bold 24px Inter';
        ctx.textAlign = 'center';
        ctx.fillText(t('titles.heatmap'), canvas.width / 2, 40);
        
        // Draw cells
        members.forEach((rowMember, i) => {
            members.forEach((colMember, j) => {
                const x = offsetX + j * cellSize;
                const y = offsetY + i * cellSize;
                const value = matrix[i][j];
                
                // Cell color based on value and top3 status
                if (value === 2) {
                    // Mutual top-3
                    ctx.fillStyle = 'rgba(0, 255, 136, 1)';
                } else if (value === 1) {
                    // Regular positive
                    ctx.fillStyle = 'rgba(0, 255, 136, 0.5)';
                } else if (value < 0) {
                    ctx.fillStyle = 'rgba(255, 0, 128, 0.8)';
                } else if (i === j) {
                    // Diagonal - show mean rank with gradient
                    const rank = rowMember.meanRankOwnership;
                    const intensity = 1 - (rank - 1) / 7;
                    ctx.fillStyle = `rgba(0, 212, 255, ${intensity})`;
                } else {
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.02)';
                }
                
                // Highlight effect
                if (i === highlightedRow || j === highlightedCol) {
                    ctx.globalAlpha = 1;
                } else if (highlightedRow !== -1 || highlightedCol !== -1) {
                    ctx.globalAlpha = 0.3;
                } else {
                    ctx.globalAlpha = 1;
                }
                
                ctx.fillRect(x, y, cellSize - 2, cellSize - 2);
                ctx.globalAlpha = 1;
                
                // Text for significant links or diagonal
                if ((Math.abs(value) > 0 || i === j) && cellSize > 30) {
                    ctx.fillStyle = '#fff';
                    ctx.font = 'bold 12px Inter';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    if (i === j) {
                        ctx.fillText(rowMember.meanRankOwnership.toFixed(1), x + cellSize/2, y + cellSize/2);
                    } else if (value === 2) {
                        ctx.fillText('‚ü∑', x + cellSize/2, y + cellSize/2);
                    } else {
                        ctx.fillText(value > 0 ? '+' : '-', x + cellSize/2, y + cellSize/2);
                    }
                }
            });
        });
        
        // Highlight borders
        if (highlightedRow >= 0) {
            ctx.strokeStyle = '#ffea00';
            ctx.lineWidth = 3;
            ctx.strokeRect(offsetX - 1, offsetY + highlightedRow * cellSize - 1, 
                          members.length * cellSize + 2, cellSize + 2);
        }
        
        if (highlightedCol >= 0) {
            ctx.strokeStyle = '#ffea00';
            ctx.lineWidth = 3;
            ctx.strokeRect(offsetX + highlightedCol * cellSize - 1, offsetY - 1, 
                          cellSize + 2, members.length * cellSize + 2);
        }
        
        // Draw labels with NAMES
        ctx.save();
        ctx.fillStyle = '#fff';
        ctx.font = '11px Inter';
        
        // Row labels
        ctx.textAlign = 'right';
        ctx.textBaseline = 'middle';
        members.forEach((member, i) => {
            ctx.fillText(member.firstName || member.name.split(' ')[0], offsetX - 10, offsetY + i * cellSize + cellSize/2);
        });
        
        // Column labels
        ctx.save();
        members.forEach((member, i) => {
            ctx.translate(offsetX + i * cellSize + cellSize/2, offsetY - 10);
            ctx.rotate(-Math.PI/4);
            ctx.textAlign = 'right';
            ctx.textBaseline = 'middle';
            ctx.fillText(member.firstName || member.name.split(' ')[0], 0, 0);
            ctx.restore();
            ctx.save();
        });
        ctx.restore();
        
        // Legend (smaller and in corner)
        if (legendVisible) {
            const legendX = 20;
            const legendY = canvas.height - 170;
            
            // Background for legend
            ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
            ctx.fillRect(legendX - 10, legendY - 30, 200, 160);
            
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 12px Inter';
            ctx.fillText(t('legend.title'), legendX, legendY);
            
            const items = [
                { color: 'rgba(0, 255, 136, 1)', label: t('legend.mutual') },
                { color: 'rgba(0, 255, 136, 0.5)', label: t('legend.positive') },
                { color: 'rgba(255, 0, 128, 0.8)', label: t('legend.negative') },
                { color: 'rgba(0, 212, 255, 0.8)', label: 'Mean Rank (Diagonal)' }
            ];
            
            items.forEach((item, i) => {
                ctx.fillStyle = item.color;
                ctx.fillRect(legendX, legendY + 10 + i * 30, 20, 20);
                ctx.fillStyle = '#fff';
                ctx.font = '11px Inter';
                ctx.textAlign = 'left';
                ctx.textBaseline = 'middle';
                ctx.fillText(item.label, legendX + 25, legendY + 20 + i * 30);
            });
        }
    }
    
    // Initial draw
    drawHeatmap();
    
    // Mouse interaction
    canvas.onmousemove = function(event) {
        const rect = canvas.getBoundingClientRect();
        const x = event.clientX - rect.left;
        const y = event.clientY - rect.top;
        
        const col = Math.floor((x - offsetX) / cellSize);
        const row = Math.floor((y - offsetY) / cellSize);
        
        if (col >= 0 && col < members.length && row >= 0 && row < members.length) {
            if (row !== highlightedRow || col !== highlightedCol) {
                highlightedRow = row;
                highlightedCol = col;
                drawHeatmap();
            }
            
            // Show tooltip with more data
            const member = members[row];
            const target = members[col];
            const value = matrix[row][col];
            
            let tooltipText = `${member.name} ‚Üí ${target.name}`;
            if (row === col) {
                tooltipText = `${member.name}<br>Mean Rank: ${member.meanRankOwnership.toFixed(2)}<br>Status Score: ${member.statusScoreOwnership.toFixed(3)}`;
            } else if (value === 2) {
                tooltipText += ` (${t('legend.mutual')})`;
            } else if (value === 1) {
                tooltipText += ` (${t('legend.positive')})`;
            } else if (value < 0) {
                tooltipText += ` (${t('legend.negative')})`;
            } else {
                tooltipText += ' (Neutral)';
            }
            
            const tooltip = document.getElementById('tooltip');
            tooltip.innerHTML = tooltipText;
            tooltip.style.left = event.pageX + 10 + 'px';
            tooltip.style.top = event.pageY - 30 + 'px';
            tooltip.classList.add('active');
        } else {
            highlightedRow = -1;
            highlightedCol = -1;
            drawHeatmap();
            hideTooltip();
        }
    };
    
    canvas.onmouseleave = function() {
        highlightedRow = -1;
        highlightedCol = -1;
        drawHeatmap();
        hideTooltip();
    };
    
    canvas.onclick = function(event) {
        const rect = canvas.getBoundingClientRect();
        const x = event.clientX - rect.left;
        const y = event.clientY - rect.top;
        
        const col = Math.floor((x - offsetX) / cellSize);
        const row = Math.floor((y - offsetY) / cellSize);
        
        if (col >= 0 && col < members.length && row >= 0 && row < members.length) {
            const member = members[row];
            showQuickInfo(member, event);
        }
    };
}

// ===== Enhanced Development View with Correct Quadrants =====
function renderDevelopmentView(members) {
    const container = document.getElementById('developmentContainer');
    container.style.display = 'block';
    
    // Filter out C-Level members for quadrant analysis
    const nonLeaderMembers = members.filter(m => m.level !== 'C-Level');
    
    const titleKey = currentLang === 'uk' ? 
        '–ê–Ω–∞–ª—ñ–∑ —Ä–æ–∑–≤–∏—Ç–∫—É –∫–æ–º–∞–Ω–¥–∏: Ownership vs Trust' : 
        'Team Development Analysis: Ownership vs Trust';
    const subtitleKey = currentLang === 'uk' ?
        '–ö–≤–∞–¥—Ä–∞–Ω—Ç–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ –¥–æ –¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è —Ç–∞ —Ä–æ–∑–≤–∏—Ç–∫—É' :
        'Quadrant analysis for delegation readiness and development needs';
    
    container.innerHTML = `
        <div class="development-header">
            <h2>${titleKey}</h2>
            <p>${subtitleKey}</p>
        </div>
        <div class="development-grid">
            <div class="chart-container">
                <h3 class="chart-title">${currentLang === 'uk' ? '–ú–∞—Ç—Ä–∏—Ü—è Ownership-Trust' : 'Ownership-Trust Matrix'}</h3>
                <svg id="scatterPlot"></svg>
            </div>
            <div class="chart-container">
                <h3 class="chart-title">${currentLang === 'uk' ? '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —Ä–æ–∑–≤–∏—Ç–∫—É' : 'Development Recommendations'}</h3>
                <div id="developmentRecommendations"></div>
            </div>
        </div>
        <div class="delegation-analysis" id="delegationAnalysis"></div>
    `;
    
    renderScatterPlot(nonLeaderMembers);
    generateDevelopmentRecommendations(nonLeaderMembers);
}

function renderScatterPlot(members) {
    const svg = d3.select('#scatterPlot');
    const margin = { top: 90, right: 200, bottom: 100, left: 80 };
    const container = svg.node().parentElement;
    const width = container.clientWidth - margin.left - margin.right;
    const height = 650 - margin.top - margin.bottom;
    
    svg.attr('width', width + margin.left + margin.right)
       .attr('height', height + margin.top + margin.bottom);
    
    const g = svg.append('g')
        .attr('transform', `translate(${margin.left},${margin.top})`);
    
    // Scales
    const xScale = d3.scaleLinear()
        .domain([0, 100])
        .range([0, width]);
    
    const yScale = d3.scaleLinear()
        .domain([0, 100])
        .range([height, 0]);
    
    // Grid lines
    g.append('g')
        .attr('class', 'grid')
        .attr('transform', `translate(0,${height})`)
        .call(d3.axisBottom(xScale)
            .tickSize(-height)
            .tickFormat('')
        )
        .style('stroke-dasharray', '3,3')
        .style('opacity', 0.3);
    
    g.append('g')
        .attr('class', 'grid')
        .call(d3.axisLeft(yScale)
            .tickSize(-width)
            .tickFormat('')
        )
        .style('stroke-dasharray', '3,3')
        .style('opacity', 0.3);
    
    // Axes
    g.append('g')
        .attr('transform', `translate(0,${height})`)
        .call(d3.axisBottom(xScale))
        .append('text')
        .attr('x', width / 2)
        .attr('y', 40)
        .attr('fill', '#fff')
        .style('text-anchor', 'middle')
        .text('Ownership Index ‚Üí');
    
    g.append('g')
        .call(d3.axisLeft(yScale))
        .append('text')
        .attr('transform', 'rotate(-90)')
        .attr('y', -40)
        .attr('x', -height / 2)
        .attr('fill', '#fff')
        .style('text-anchor', 'middle')
        .text('Trust Index ‚Üí');
    
    // Quadrant lines
    g.append('line')
        .attr('x1', width / 2)
        .attr('x2', width / 2)
        .attr('y1', 0)
        .attr('y2', height)
        .attr('stroke', '#666')
        .attr('stroke-dasharray', '5,5');
    
    g.append('line')
        .attr('x1', 0)
        .attr('x2', width)
        .attr('y1', height / 2)
        .attr('y2', height / 2)
        .attr('stroke', '#666')
        .attr('stroke-dasharray', '5,5');
    
    // Quadrant labels - CORRECTED
    const quadrants = [
        { x: width * 0.75, y: height * 0.25, text: `Q1: ${t('quadrant.highPerformers')}` }, // Top right
        { x: width * 0.25, y: height * 0.25, text: `Q2: ${t('quadrant.underutilized')}` }, // Top left
        { x: width * 0.25, y: height * 0.75, text: `Q3: ${t('quadrant.developmentNeeded')}` }, // Bottom left
        { x: width * 0.75, y: height * 0.75, text: `Q4: ${t('quadrant.delegationReady')}` } // Bottom right
    ];
    
    quadrants.forEach(q => {
        g.append('text')
            .attr('x', q.x)
            .attr('y', q.y)
            .attr('text-anchor', 'middle')
            .attr('fill', '#666')
            .attr('font-style', 'italic')
            .text(q.text);
    });
    
    // Highlight zones
    // High performers zone (Q1 - top right)
    g.append('rect')
        .attr('x', width / 2)
        .attr('y', 0)
        .attr('width', width / 2)
        .attr('height', height / 2)
        .attr('fill', '#00d4ff')
        .attr('fill-opacity', 0.05)
        .attr('stroke', '#00d4ff')
        .attr('stroke-width', 1)
        .attr('stroke-dasharray', '3,3');
    
    // Delegation ready zone (Q4 - bottom right)
    g.append('rect')
        .attr('x', width / 2)
        .attr('y', height / 2)
        .attr('width', width / 2)
        .attr('height', height / 2)
        .attr('fill', '#00ff88')
        .attr('fill-opacity', 0.1)
        .attr('stroke', '#00ff88')
        .attr('stroke-width', 2)
        .attr('stroke-dasharray', '5,5');
    
    // Create tooltip div
    const tooltip = d3.select('body').append('div')
        .attr('class', 'scatter-tooltip')
        .style('opacity', 0)
        .style('position', 'absolute')
        .style('background', 'rgba(0, 0, 0, 0.9)')
        .style('padding', '10px')
        .style('border-radius', '8px')
        .style('pointer-events', 'none')
        .style('font-size', '12px')
        .style('color', '#fff');
    
    // Plot points
    const points = g.selectAll('.point')
        .data(members)
        .enter().append('g')
        .attr('class', 'point')
        .attr('transform', d => `translate(${xScale(d.ownershipIndex)},${yScale(d.trustIndex)})`)
        .style('opacity', 0);
    
    points.append('circle')
        .attr('r', d => 10 + d.statusScoreOwnership * 15)
        .attr('fill', d => {
            const isHighOwnership = d.ownershipIndex > 50;
            const isHighTrust = d.trustIndex > 50;
            if (isHighOwnership && isHighTrust) return '#00d4ff'; // Q1: High performers
            if (!isHighOwnership && isHighTrust) return '#a855f7'; // Q2: Underutilized
            if (!isHighOwnership && !isHighTrust) return '#ff0080'; // Q3: Development needed
            return '#00ff88'; // Q4: Delegation ready
        })
        .attr('stroke', '#fff')
        .attr('stroke-width', 2)
        .style('cursor', 'pointer');
    
    // Labels with NAMES
    points.append('text')
        .text(d => d.firstName || d.name.split(' ')[0])
        .attr('x', 0)
        .attr('y', d => -(12 + d.statusScoreOwnership * 15))
        .attr('text-anchor', 'middle')
        .attr('fill', '#fff')
        .attr('font-size', '12px')
        .attr('font-weight', '600');
    
    // Role labels
    points.append('text')
        .text(d => d.role)
        .attr('x', 0)
        .attr('y', d => 12 + d.statusScoreOwnership * 15 + 10)
        .attr('text-anchor', 'middle')
        .attr('fill', '#aaa')
        .attr('font-size', '10px');
    
    // Animate points to position
    points.transition()
        .duration(800)
        .delay((d, i) => i * 50)
        .style('opacity', 1);
    
    // Interaction
    points.on('mouseover', function(event, d) {
        d3.select(this).select('circle')
            .transition()
            .duration(200)
            .attr('r', d => 14 + d.statusScoreOwnership * 15);
        
        tooltip.transition()
            .duration(200)
            .style('opacity', .9);
        
        const quadrant = getQuadrant(d.ownershipIndex, d.trustIndex);
        tooltip.html(`
            <strong>${d.name}</strong><br/>
            ${d.role}<br/>
            Ownership: ${d.ownershipIndex}<br/>
            Trust: ${d.trustIndex}<br/>
            Status Score: ${d.statusScoreOwnership.toFixed(3)}<br/>
            Mean Rank: ${d.meanRankOwnership.toFixed(2)}<br/>
            ${t('quadrant.' + quadrant)}
        `)
        .style('left', (event.pageX + 10) + 'px')
        .style('top', (event.pageY - 28) + 'px');
    })
    .on('mouseout', function(event, d) {
        d3.select(this).select('circle')
            .transition()
            .duration(200)
            .attr('r', d => 10 + d.statusScoreOwnership * 15);
        
        tooltip.transition()
            .duration(500)
            .style('opacity', 0);
    })
    .on('click', function(event, d) {
        showQuickInfo(d, event);
    });
    
    // Clean up tooltip on component unmount
    return () => tooltip.remove();
}

// Helper function to get quadrant
function getQuadrant(ownership, trust) {
    if (ownership > 50 && trust > 50) return 'highPerformers';
    if (ownership < 50 && trust > 50) return 'underutilized';
    if (ownership < 50 && trust < 50) return 'developmentNeeded';
    return 'delegationReady';
}

function generateDevelopmentRecommendations(members) {
    const recommendationsEl = document.getElementById('developmentRecommendations');
    const analysisEl = document.getElementById('delegationAnalysis');
    
    // Find people in each quadrant
    const q1Members = members.filter(m => m.ownershipIndex > 50 && m.trustIndex > 50); // High performers
    const q2Members = members.filter(m => m.ownershipIndex < 50 && m.trustIndex > 50); // Underutilized
    const q3Members = members.filter(m => m.ownershipIndex < 50 && m.trustIndex < 50); // Development needed
    const q4Members = members.filter(m => m.ownershipIndex > 50 && m.trustIndex < 50); // Delegation ready
    
    // Recommendations HTML
    let recHtml = '<div class="recommendations-list">';
    
    // Based on real data analysis
    recHtml += `
        <div class="recommendation-item critical">
            <i class="fas fa-exclamation-triangle"></i>
            <div>
                <h4>${currentLang === 'uk' ? '–ö—Ä–∏—Ç–∏—á–Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–∞—Ü—ñ—è' : 'Critical Centralization'}</h4>
                <p>${currentLang === 'uk' ? 
                    'Alex –º–∞—î mean rank 1.5 - –ø—Ä–æ—Ñ—ñ—Ü–∏—Ç –¥–æ–≤—ñ—Ä–∏. –ù–µ–æ–±—Ö—ñ–¥–Ω–µ –≤–∏—Ä–æ—â—É–≤–∞–Ω–Ω—è –∫–∞–Ω–¥–∏–¥–∞—Ç—ñ–≤ –Ω–∞ –¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è.' : 
                    'Alex has mean rank 1.5 - excessive unused trust concentration. Immediate task delegation needed.'}</p>
            </div>
        </div>
    `;
    
    if (q1Members.length > 0) {
        const highPerformersText = currentLang === 'uk' ? 
            '–í–∏—Å–æ–∫–æ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ (–≤–∏—Å–æ–∫–∞ –¥–æ–≤—ñ—Ä–∞ —Ç–∞ –≤–æ–ª–æ–¥—ñ–Ω–Ω—è):' : 
            'High performers (high trust and ownership):';
        
        recHtml += `
            <div class="recommendation-item success">
                <i class="fas fa-star"></i>
                <div>
                    <h4>${highPerformersText}</h4>
                    <ul>
                        ${q1Members.map(m => `<li>${m.name} - ${m.role} (Rank: ${m.meanRankOwnership.toFixed(2)})</li>`).join('')}
                    </ul>
                    <p>${currentLang === 'uk' ? 
                        '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —è–∫ –º–µ–Ω—Ç–æ—Ä—ñ–≤ –¥–ª—è —Ä–æ–∑–≤–∏—Ç–∫—É —ñ–Ω—à–∏—Ö.' : 
                        'Recommendation: Use as mentors for developing others.'}</p>
                </div>
            </div>
        `;
    }
    
    if (q4Members.length > 0) {
        const delegationText = currentLang === 'uk' ? 
            '–ì–æ—Ç–æ–≤—ñ –ø—Ä–∏–π–Ω—è—Ç–∏ –¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è (–≤–∏—Å–æ–∫–µ –≤–æ–ª–æ–¥—ñ–Ω–Ω—è, –Ω–∏–∑—å–∫–∞ –¥–æ–≤—ñ—Ä–∞):' : 
            'Ready for delegation (high ownership, low trust):';
        
        recHtml += `
            <div class="recommendation-item info">
                <i class="fas fa-share"></i>
                <div>
                    <h4>${delegationText}</h4>
                    <ul>
                        ${q4Members.map(m => `<li>${m.name} - ${m.role} (Status: ${m.statusScoreOwnership.toFixed(3)})</li>`).join('')}
                    </ul>
                    <p>${currentLang === 'uk' ? 
                        '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è: –ü–µ—Ä–µ–¥–∞—Ç–∏ –±—ñ–ª—å—à–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ, —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ—Å—Ç—ñ—Ä –¥–ª—è —Ä–æ—Å—Ç—É.' : 
                        'Recommendation: Transfer more responsibility, create space for growth.'}</p>
                </div>
            </div>
        `;
    }
    
    // High bias members
    const highBiasMembers = members.filter(m => m.biasOwnership > 1 || m.biasTrust > 1);
    if (highBiasMembers.length > 0) {
        recHtml += `
            <div class="recommendation-item warning">
                <i class="fas fa-user-graduate"></i>
                <div>
                    <h4>${currentLang === 'uk' ? '–ü–æ—Ç—Ä–µ–±—É—é—Ç—å –∫–∞–ª—ñ–±—Ä—É–≤–∞–Ω–Ω—è –æ—á—ñ–∫—É–≤–∞–Ω—å' : 'Need expectation calibration'}</h4>
                    <p>${currentLang === 'uk' ? 
                        '–í–∏—Å–æ–∫–∏–π –ø–æ–∑–∏—Ç–∏–≤–Ω–∏–π bias - –ø–µ—Ä–µ–æ—Ü—ñ–Ω—é—é—Ç—å —Å–≤—ñ–π —Å—Ç–∞—Ç—É—Å:' : 
                        'High positive bias - overestimate their status:'}</p>
                    <ul>
                        ${highBiasMembers.map(m => `<li>${m.name} - Bias: +${Math.max(m.biasOwnership, m.biasTrust).toFixed(2)}</li>`).join('')}
                    </ul>
                </div>
            </div>
        `;
    }
    
    recHtml += '</div>';
    recommendationsEl.innerHTML = recHtml;
    
    // Delegation analysis
    const analysisTitle = currentLang === 'uk' ? '–î–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è' : 'Detailed Delegation Analysis';
    const distributionTitle = currentLang === 'uk' ? '–†–æ–∑–ø–æ–¥—ñ–ª –ø–æ –∫–≤–∞–¥—Ä–∞–Ω—Ç–∞—Ö' : 'Quadrant Distribution';
    const conclusionsTitle = currentLang === 'uk' ? '–ö–ª—é—á–æ–≤—ñ –≤–∏—Å–Ω–æ–≤–∫–∏' : 'Key Conclusions';
    
    const bridgeRisk = currentLang === 'uk' ? 
        'Igor - –∫—Ä–∏—Ç–∏—á–Ω–∏–π –º—ñ—Å—Ç –º—ñ–∂ –∫–æ–º–ø–∞–Ω—ñ—è–º–∏ (–≤—Å—ñ –∫—Ä–æ—Å-–≤—Ö–æ–¥–∏). –†–∏–∑–∏–∫ –æ–¥–Ω–æ—Ç–æ—á–∫–æ–≤–æ–≥–æ –ø—Ä–æ–≤–∞–ª—É.' : 
        'Igor - critical bridge between companies (all cross-entries). Single point of failure risk.';
    
    const peripheryRisk = currentLang === 'uk' ? 
        'Yana —Ç–∞ Viktoria - 0 –≤—Ö–æ–¥—ñ–≤ –≤ —Ç–æ–ø-3. –†–∏–∑–∏–∫ —ñ–∑–æ–ª—è—Ü—ñ—ó —Ç–∞ –¥–µ–º–æ—Ç–∏–≤–∞—Ü—ñ—ó.' : 
        'Yana and Viktoria - 0 top-3 entries. Risk of isolation and demotivation.';
    
    let analysisHtml = `
        <h3>${analysisTitle}</h3>
        <div class="analysis-grid">
            <div class="analysis-card">
                <h4>${distributionTitle}</h4>
                <ul>
                    <li>Q1 (${t('quadrant.highPerformers')}): ${q1Members.length} ${currentLang === 'uk' ? '–æ—Å—ñ–±' : 'people'}</li>
                    <li>Q2 (${t('quadrant.underutilized')}): ${q2Members.length} ${currentLang === 'uk' ? '–æ—Å—ñ–±' : 'people'}</li>
                    <li>Q3 (${t('quadrant.developmentNeeded')}): ${q3Members.length} ${currentLang === 'uk' ? '–æ—Å—ñ–±' : 'people'}</li>
                    <li>Q4 (${t('quadrant.delegationReady')}): ${q4Members.length} ${currentLang === 'uk' ? '–æ—Å—ñ–±' : 'people'}</li>
                </ul>
            </div>
            <div class="analysis-card">
                <h4>${conclusionsTitle}</h4>
                <p><strong>${bridgeRisk}</strong></p>
                <p><strong>${peripheryRisk}</strong></p>
                <p>${currentLang === 'uk' ? 
                    '–ü–æ–ª—è—Ä–∏–∑–∞—Ü—ñ—è: —Ä–æ–∑—Ä–∏–≤ –º—ñ–∂ Alex (1.5) —Ç–∞ Viktoria (7.5) = 6 –ø–æ–∑–∏—Ü—ñ–π.' : 
                    'Polarization: gap between Alex (1.5) and Viktoria (7.5) = 6 positions.'}</p>
            </div>
        </div>
        
        <div class="development-matrix">
            <h4>${currentLang === 'uk' ? '–ú–∞—Ç—Ä–∏—Ü—è —Ä–æ–∑–≤–∏—Ç–∫—É –ø–æ –∫–≤–∞–¥—Ä–∞–Ω—Ç–∞—Ö' : 'Development Matrix by Quadrant'}</h4>
            <table class="development-table">
                <thead>
                    <tr>
                        <th>${currentLang === 'uk' ? '–ö–≤–∞–¥—Ä–∞–Ω—Ç' : 'Quadrant'}</th>
                        <th>${currentLang === 'uk' ? '–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞' : 'Characteristics'}</th>
                        <th>${currentLang === 'uk' ? '–°—Ç—Ä–∞—Ç–µ–≥—ñ—è —Ä–æ–∑–≤–∏—Ç–∫—É' : 'Development Strategy'}</th>
                        <th>${currentLang === 'uk' ? '–ß–ª–µ–Ω–∏ –∫–æ–º–∞–Ω–¥–∏' : 'Team Members'}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Q1</td>
                        <td>${currentLang === 'uk' ? '–í–∏—Å–æ–∫—ñ Trust + Ownership' : 'High Trust + Ownership'}</td>
                        <td>${currentLang === 'uk' ? 
                            '–ú–µ–Ω—Ç–æ—Ä—Å—Ç–≤–æ, –ª—ñ–¥–µ—Ä—Å—å–∫—ñ —Ä–æ–ª—ñ, —Å—Ç—Ä–∞—Ç–µ–≥—ñ—á–Ω—ñ –ø—Ä–æ–µ–∫—Ç–∏' : 
                            'Mentoring, leadership roles, strategic projects'}</td>
                        <td>${q1Members.map(m => m.name).join(', ') || '-'}</td>
                    </tr>
                    <tr>
                        <td>Q2</td>
                        <td>${currentLang === 'uk' ? '–í–∏—Å–æ–∫–∏–π Trust, –Ω–∏–∑—å–∫–∏–π Ownership' : 'High Trust, low Ownership'}</td>
                        <td>${currentLang === 'uk' ? 
                            '–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ø–æ–≤–Ω–æ–≤–∞–∂–µ–Ω—å, –∑–∞–ª—É—á–µ–Ω–Ω—è –¥–æ –ø—Ä–∏–π–Ω—è—Ç—Ç—è —Ä—ñ—à–µ–Ω—å' : 
                            'Expand authority, involve in decision making'}</td>
                        <td>${q2Members.map(m => m.name).join(', ') || '-'}</td>
                    </tr>
                    <tr>
                        <td>Q3</td>
                        <td>${currentLang === 'uk' ? '–ù–∏–∑—å–∫—ñ Trust + Ownership' : 'Low Trust + Ownership'}</td>
                        <td>${currentLang === 'uk' ? 
                            '–ù–∞–≤—á–∞–Ω–Ω—è, –∫–æ—É—á–∏–Ω–≥, –ø–æ—Å—Ç—É–ø–æ–≤–µ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ' : 
                            'Training, coaching, gradual responsibility increase'}</td>
                        <td>${q3Members.map(m => m.name).join(', ') || '-'}</td>
                    </tr>
                    <tr>
                        <td>Q4</td>
                        <td>${currentLang === 'uk' ? '–í–∏—Å–æ–∫–∏–π Ownership, –Ω–∏–∑—å–∫–∏–π Trust' : 'High Ownership, low Trust'}</td>
                        <td>${currentLang === 'uk' ? 
                            '–î–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è, –∞–≤—Ç–æ–Ω–æ–º—ñ—è, –≤–∏–¥–∏–º—ñ—Å—Ç—å –¥–æ—Å—è–≥–Ω–µ–Ω—å' : 
                            'Delegation, autonomy, achievement visibility'}</td>
                        <td>${q4Members.map(m => m.name).join(', ') || '-'}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    `;
    
    analysisEl.innerHTML = analysisHtml;
}

// ===== Helper Functions =====
function getEnglishInsight(insight) {
    // Translation mapping for insights
    const translations = {
        '–°—Ç—Ä–∞—Ç–µ–≥—ñ—á–Ω–µ –±–∞—á–µ–Ω–Ω—è, —ñ–Ω–Ω–æ–≤–∞—Ü—ñ—ó, —é—Ä–∏–¥–∏—á–Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—è': 'Strategic vision, innovation, legal coordination',
        '–õ—ñ–¥–µ—Ä—Å—Ç–≤–æ —É –ø—Ä–æ–¥–∞–∂–∞—Ö, –≥–ª–∏–±–æ–∫–µ –∑–∞–ª—É—á–µ–Ω–Ω—è –≤ –ø—Ä–æ–µ–∫—Ç–∏, –¥—É—Ö —Å–ø—ñ–≤–ø—Ä–∞—Ü—ñ': 'Sales leadership, deep project engagement, collaborative spirit',
        '–Ü–Ω–Ω–æ–≤–∞—Ü—ñ–π–Ω—ñ—Å—Ç—å, —Å–∏—Å—Ç–µ–º–Ω–µ –º–∏—Å–ª–µ–Ω–Ω—è, —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç–µ–Ω–¥–µ—Ä–∞–º–∏': 'Innovation, systems thinking, tender management',
        '–ü–æ–∑–∏—Ç–∏–≤–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è, –∑–∞–∫—É–ø—ñ–≤–ª—ñ, —Å–∏–ª—å–Ω—ñ –≤—ñ–¥–Ω–æ—Å–∏–Ω–∏': 'Positive interaction, procurement, strong relationships',
        '–ó–∞–∫—É–ø—ñ–≤–ª—ñ, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—è –ª–æ–≥—ñ—Å—Ç–∏–∫–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–ø—ñ–ª—å–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤': 'Procurement, logistics coordination, shared tools usage',
        '–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è CRM, —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ–π, —Å–∏–ª—å–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è': 'CRM management, instruction creation, strong integration',
        '–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —É —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∞—Ö/—Ü—ñ–Ω–æ—É—Ç–≤–æ—Ä–µ–Ω–Ω—ñ, –≥–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å –¥–æ–ø–æ–º–æ–≥—Ç–∏': 'Support in calculations/pricing, willingness to help',
        '–ü—Ä–æ–¥–∞–∂—ñ, —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏, –¥–æ–ø–æ–º–æ–≥–∞': 'Sales, calculations, assistance',
        '–î—ñ—î –≤ —ñ–Ω—Ç–µ—Ä–µ—Å–∞—Ö –∫–æ–º–∞–Ω–¥–∏, –∫–æ–æ—Ä–¥–∏–Ω—É—î –∑—É—Å—Ç—Ä—ñ—á—ñ': 'Acts in team interests, coordinates meetings',
        '–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∞–º–∏, –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω—ñ –Ω–∞–≤–∏—á–∫–∏': 'Priority management, organizational skills',
        '–í—ñ–¥–Ω–æ—Å–∏–Ω–∏ –∑ –∫–ª—ñ—î–Ω—Ç–∞–º–∏, –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∏–π –¥—Ä–∞–π–≤, –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –∫–æ–º–∞–Ω–¥–∏': 'Client relationships, operational drive, team support',
        // Challenges
        '–°–ø—Ä–∏–π–º–∞—î "–≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –≤—ñ–¥—á—É—Ç—Ç—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ" –≤ –∫–æ–º–∞–Ω–¥—ñ': 'Perceives "lack of sense of responsibility" in team',
        '–ë—Ä–∞–∫ "—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏—Ö –æ–±–æ–≤\'—è–∑–∫—ñ–≤"; –ø–æ—Ç—Ä–µ–±—É—î –±—ñ–ª—å—à–µ —á–∞—Å—É –Ω–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è': 'Lack of "structured responsibilities"; needs more management time',
        '–í–≤–∞–∂–∞—î, —â–æ –∫–æ–ª–µ–≥–∞–º –±—Ä–∞–∫—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ; –π–æ–≥–æ –≤–∞–∂–∫–æ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏': 'Believes colleagues lack responsibility; hard to convince',
        '–ù–µ –±–∞—á–∏—Ç—å –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ–π–Ω–∏—Ö –±–∞—Ä\'—î—Ä—ñ–≤': 'Doesn\'t see communication barriers',
        '"–í–µ–ª–∏–∫–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è" –∑–∞–≤–∞–∂–∞—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ–π —Ä–æ–±–æ—Ç—ñ': '"Heavy workload" hinders effective work',
        '–ë—Ä–∞–∫ —á–∞—Å—É –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é –ø—Ä–æ—Ü–µ—Å—ñ–≤': 'Lack of time for process documentation',
        '–ù–∞–∑–≤–∞–ª–∞ —Å–≤–æ–≥–æ –∫–µ—Ä—ñ–≤–Ω–∏–∫–∞ Alex —è–∫ –Ω–∞–π–º–µ–Ω—à –±–∞–∂–∞–Ω–æ–≥–æ –∫–æ–ª–µ–≥—É': 'Named her manager Alex as least preferred colleague',
        '–ö–æ–º—É–Ω—ñ–∫–∞—Ü—ñ–π–Ω—ñ –±–∞—Ä\'—î—Ä–∏ —á–µ—Ä–µ–∑ "—Ä—ñ–∑–Ω—ñ –º–æ–≤–∏"': 'Communication barriers due to "different languages"',
        '–ñ–æ–¥–Ω–∏—Ö –Ω–µ –≤–∏—è–≤–ª–µ–Ω–æ': 'None identified',
        '–°—Ç–∏—Å–ª—ñ —Ç–µ—Ä–º—ñ–Ω–∏; –ø–æ—Ç—Ä–µ–±–∞ –≤ —Ü–∏—Ñ—Ä–æ–≤–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö': 'Tight deadlines; need for digital tools',
        '–í—ñ–¥—á—É–≤–∞—î —Å–µ–±–µ –Ω–µ–¥–æ–æ—Ü—ñ–Ω–µ–Ω–∏–º; —Ä–æ–∑—á–∞—Ä–æ–≤–∞–Ω–∏–π "—Ö–∞–æ—Å–æ–º" –≤—ñ–¥ –∑–ª–∏—Ç—Ç—è VQ/IM': 'Feels undervalued; frustrated by merger "chaos"',
        // Development
        '–°—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è: –ø–µ—Ä–µ—Ö—ñ–¥ –¥–æ —Å–ø—Ä–∞–≤–∂–Ω—å–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —á–µ—Ä–µ–∑ —á—ñ—Ç–∫—ñ —Ü—ñ–ª—ñ': 'Structured management: transition to true manager through clear goals',
        '–°–ø—ñ–ª—å–Ω–∏–π –≤–ø–ª–∏–≤: —Ä–æ–∑–≤–∏—Ç–æ–∫ –Ω–∞–≤–∏—á–æ–∫ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó –¥–ª—è –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è —ñ–¥–µ–π': 'Collaborative influence: develop communication skills for idea implementation',
        '–ö—É–ª—å—Ç—É—Ä–Ω–∏–π –∞–º–±–∞—Å–∞–¥–æ—Ä: –º–æ–¥–µ–ª—å –ø–æ–∑–∏—Ç–∏–≤–Ω–æ—ó —Å–ø—ñ–≤–ø—Ä–∞—Ü—ñ': 'Cultural ambassador: model of positive collaboration',
        '–ü—Ä–æ–∞–∫—Ç–∏–≤–Ω–∞ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è: –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–æ–∑–æ—Ä–æ—Å—Ç—ñ –ø—Ä–æ—Ü–µ—Å—ñ–≤': 'Proactive communication: increase process transparency',
        '–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –ø—Ä–æ—Ü–µ—Å—ñ–≤: —Ñ–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è –∑–Ω–∞–Ω—å –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –∫–æ–ª–µ–≥': 'Process documentation: formalize knowledge to support colleagues',
        '–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–∏–π –∫–æ–Ω—Ñ–ª—ñ–∫—Ç: –Ω–∞–≤–∏—á–∫–∏ —Ñ–æ—Ä–º—É–ª—é–≤–∞–Ω–Ω—è –ø–æ—Ç—Ä–µ–± –ø—Ä–æ—Ü–µ—Å—É': 'Constructive conflict: skills for articulating process needs',
        '–ß—ñ—Ç–∫—ñ—Å—Ç—å —Ä–æ–ª—ñ: –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–æ—á–Ω–æ—ó —Ä–æ–ª—ñ —Ç–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó': 'Role clarity: define exact role and communication protocols',
        '–§–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è —Å–∏—Å—Ç–µ–º –ø—ñ–¥—Ç—Ä–∏–º–∫–∏': 'Formalize support systems',
        '–ê–¥–≤–æ–∫–∞—Ü—ñ—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—Ä–æ—Ü–µ—Å—ñ–≤': 'Process improvement advocacy',
        '–û–ø–µ—Ä–∞—Ü—ñ–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó: –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–∏—Å–æ–∫–æ—Ä—ñ–≤–Ω–µ–≤–∏—Ö —Ü—ñ–ª–µ–π –Ω–∞ —á—ñ—Ç–∫—ñ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏': 'Operationalize strategy: transform high-level goals into clear structures',
        '–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ø–æ–≤–Ω–æ–≤–∞–∂–µ–Ω—å: –ø–µ—Ä–µ—Ö—ñ–¥ –≤—ñ–¥ –≤–∏—Ä—ñ—à—É–≤–∞—á–∞ –ø—Ä–æ–±–ª–µ–º –¥–æ –∫–æ—É—á–∞ –∫–æ–º–∞–Ω–¥–∏': 'Expand authority: transition from problem solver to team coach'
    };
    return translations[insight] || insight;
}

function getEnglishConflictDescription(description) {
    const translations = {
        '–ü—Ä—è–º–∏–π, —Ä—ñ—à—É—á–∏–π –ø—ñ–¥—Ö—ñ–¥. –®–≤–∏–¥–∫–æ –ø—Ä–∏–π–º–∞—î —Ä—ñ—à–µ–Ω–Ω—è, –º–æ–∂–µ –∑–¥–∞–≤–∞—Ç–∏—Å—å –∞–≤—Ç–æ—Ä–∏—Ç–∞—Ä–Ω–∏–º.': 
            'Direct, decisive approach. Makes quick decisions, may appear authoritarian.',
        '–°—Ö–∏–ª—å–Ω–∏–π –ø–æ—Å—Ç—É–ø–∞—Ç–∏—Å—è –∑–∞—Ä–∞–¥–∏ –≥–∞—Ä–º–æ–Ω—ñ—ó, —â–æ –º–æ–∂–µ –Ω–∞–∫–æ–ø–∏—á—É–≤–∞—Ç–∏ –Ω–µ–≤–∏—Ä—ñ—à–µ–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è.':
            'Tends to accommodate for harmony, which can accumulate unresolved issues.',
        '–ù–∞–ø–æ–ª–µ–≥–ª–∏–≤–∏–π —É –≤—ñ–¥—Å—Ç–æ—é–≤–∞–Ω–Ω—ñ —Å–≤–æ—î—ó –ø–æ–∑–∏—Ü—ñ—ó, –º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–∞–ø—Ä—É–≥—É.':
            'Persistent in defending position, can create tension.',
        '–ï—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –≤–∑–∞—î–º–æ–≤–∏–≥—ñ–¥–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è, —Å–ø—Ä–∏—è—î –∫–æ–º–∞–Ω–¥–Ω—ñ–π –≥–∞—Ä–º–æ–Ω—ñ—ó.':
            'Effectively finds mutually beneficial solutions, promotes team harmony.',
        '–ì–æ—Ç–æ–≤–∏–π –¥–æ –∫–æ–º–ø—Ä–æ–º—ñ—Å—ñ–≤, –∞–ª–µ –º–æ–∂–µ –ø–æ—Å—Ç—É–ø–∞—Ç–∏—Å—è –≤–∞–∂–ª–∏–≤–∏–º–∏ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏.':
            'Ready for compromises, but may concede important principles.',
        '–í–∏—Å–æ–∫—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏ –º–æ–∂—É—Ç—å —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–∞–ø—Ä—É–≥—É –∑ —Ç–∏–º–∏, —Ö—Ç–æ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è–º.':
            'High standards can create tension with those who don\'t meet expectations.',
        '–£–Ω–∏–∫–∞—î –ø—Ä—è–º–æ—ó –∫–æ–Ω—Ñ—Ä–æ–Ω—Ç–∞—Ü—ñ—ó, –Ω–∞–∫–æ–ø–∏—á—É—î —Ñ—Ä—É—Å—Ç—Ä–∞—Ü—ñ—é –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ.':
            'Avoids direct confrontation, accumulates frustration internally.',
        '–ê–¥–∞–ø—Ç—É—î—Ç—å—Å—è –ø—ñ–¥ —Å–ø—ñ–≤—Ä–æ–∑–º–æ–≤–Ω–∏–∫–∞, –º–æ–∂–µ –≤—Ç—Ä–∞—á–∞—Ç–∏ –≤–ª–∞—Å–Ω—É –ø–æ–∑–∏—Ü—ñ—é.':
            'Adapts to interlocutor, may lose own position.',
        '–ü—ñ–¥—Ç—Ä–∏–º—É—î –≤—Å—ñ—Ö, —É–Ω–∏–∫–∞—î –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤, —Å—Ç–≤–æ—Ä—é—î –ø–æ–∑–∏—Ç–∏–≤–Ω—É –∞—Ç–º–æ—Å—Ñ–µ—Ä—É.':
            'Supports everyone, avoids conflicts, creates positive atmosphere.',
        '–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ –ø—Ä–æ–ø–æ–Ω—É—î –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è, –¥–∏–ø–ª–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏—Ä—ñ—à—É—î –ø–∏—Ç–∞–Ω–Ω—è.':
            'Constructively proposes improvements, diplomatically resolves issues.',
        '–®—É–∫–∞—î win-win —Ä—ñ—à–µ–Ω–Ω—è, –∞–ª–µ –º–æ–∂–µ –∑–∞—Ç—è–≥—É–≤–∞—Ç–∏ –ø—Ä–æ—Ü–µ—Å —á–µ—Ä–µ–∑ –ø—Ä–∞–≥–Ω–µ–Ω–Ω—è –∫–æ–Ω—Å–µ–Ω—Å—É—Å—É.':
            'Seeks win-win solutions, but may prolong process due to consensus seeking.'
    };
    return translations[description] || description;
}

// ===== Side Info Panel =====
function showSideInfo(member) {
    const panel = document.getElementById('sideInfo');
    const body = document.getElementById('sideInfoBody');
    
    body.innerHTML = `
        <div class="side-info-header">
            <div class="side-info-avatar">${member.firstName || member.name.split(' ')[0]}</div>
            <h3>${member.name}</h3>
            <p>${member.role} ‚Ä¢ ${member.company}</p>
        </div>
        
        <div class="side-info-metrics">
            <div class="metric-item">
                <span class="metric-label">${t('member.meanRank')}:</span>
                <span class="metric-value">${member.meanRankOwnership.toFixed(2)}</span>
            </div>
            <div class="metric-item">
                <span class="metric-label">${t('member.statusScore')}:</span>
                <span class="metric-value">${member.statusScoreOwnership.toFixed(3)}</span>
            </div>
            <div class="metric-item">
                <span class="metric-label">${t('member.top3Count')}:</span>
                <span class="metric-value">${member.top3CountOwnership}</span>
            </div>
            <div class="metric-item">
                <span class="metric-label">${t('member.bias')}:</span>
                <span class="metric-value ${member.biasOwnership > 0 ? 'negative' : 'positive'}">${member.biasOwnership > 0 ? '+' : ''}${member.biasOwnership.toFixed(2)}</span>
            </div>
        </div>
        
        ${member.quote ? `
            <div class="side-info-quote">
                <i class="fas fa-quote-left"></i>
                <p>${member.quote}</p>
            </div>
        ` : ''}
        
        <div class="side-info-insight">
            <p><strong>${t('member.keyInsight')}:</strong></p>
            <p>${currentLang === 'uk' ? member.insights.keyInsight : getEnglishInsight(member.insights.keyInsight)}</p>
        </div>
        
        <button class="side-info-btn" onclick="showMemberDetails(teamData.members.find(m => m.id === '${member.id}'))">
            ${t('quick.details')} ‚Üí
        </button>
    `;
    
    panel.classList.add('active');
}

function hideSideInfo() {
    document.getElementById('sideInfo').classList.remove('active');
}

// ===== Tooltip Functions =====
function showTooltip(event, member) {
    const tooltip = document.getElementById('tooltip');
    tooltip.innerHTML = `
        <strong>${member.name}</strong><br>
        ${member.role}<br>
        ${member.company}<br>
        <span style="color: var(--neon-green)">Rank: ${member.meanRankOwnership.toFixed(2)}</span><br>
        <span style="color: var(--neon-yellow)">Top3: ${member.top3CountOwnership}</span><br>
        <span style="color: var(--neon-blue)">Status: ${member.statusScoreOwnership.toFixed(3)}</span><br>
        <span style="color: ${member.biasOwnership > 0 ? 'var(--neon-pink)' : 'var(--neon-green)'}">Bias: ${member.biasOwnership > 0 ? '+' : ''}${member.biasOwnership.toFixed(2)}</span>
    `;
    
    tooltip.style.left = event.pageX + 10 + 'px';
    tooltip.style.top = event.pageY - 10 + 'px';
    tooltip.classList.add('active');
}

function hideTooltip() {
    document.getElementById('tooltip').classList.remove('active');
}

// ===== Quick Info =====
function showQuickInfo(member, event) {
    quickInfoPerson = member;
    const quickInfo = document.getElementById('quickInfo');
    
    // Update content
    quickInfo.querySelector('.quick-info-avatar').textContent = member.firstName || member.name.split(' ')[0];
    quickInfo.querySelector('.quick-info-name').textContent = member.name;
    quickInfo.querySelector('.quick-info-role').textContent = `${member.role} ‚Ä¢ ${member.company}`;
    quickInfo.querySelector('.positive-count').textContent = member.preferred.length;
    quickInfo.querySelector('.negative-count').textContent = member.leastPreferred.length;
    
    // Calculate influence based on top3 count
    const influence = member.top3CountOwnership + member.top3CountTrust;
    quickInfo.querySelector('.influence-score').textContent = influence;
    
    // Position near click
    const x = event.pageX || event.clientX;
    const y = event.pageY || event.clientY;
    
    quickInfo.style.left = x + 'px';
    quickInfo.style.top = y + 10 + 'px';
    
    // Adjust if goes off screen
    setTimeout(() => {
        const quickRect = quickInfo.getBoundingClientRect();
        if (quickRect.right > window.innerWidth) {
            quickInfo.style.left = (window.innerWidth - quickRect.width - 20) + 'px';
        }
        if (quickRect.bottom > window.innerHeight) {
            quickInfo.style.top = (y - quickRect.height - 10) + 'px';
        }
    }, 10);
    
    quickInfo.classList.add('active');
}

function showDetailedModal() {
    if (quickInfoPerson) {
        showMemberDetails(quickInfoPerson);
        document.getElementById('quickInfo').classList.remove('active');
    }
}

// ===== Enhanced Member Details Modal =====
function showMemberDetails(member) {
    const modal = document.getElementById('detailsModal');
    const modalBody = document.getElementById('modalBody');
    
    const positiveConnections = member.preferred.map(id => {
        const target = teamData.members.find(m => m.id === id);
        return target ? { name: target.name, rank: target.meanRankOwnership } : null;
    }).filter(Boolean);
    
    const negativeConnections = member.leastPreferred.map(id => {
        const target = teamData.members.find(m => m.id === id);
        return target ? { name: target.name, rank: target.meanRankOwnership } : null;
    }).filter(Boolean);
    
    const quadrant = getQuadrant(member.ownershipIndex, member.trustIndex);
    
    modalBody.innerHTML = `
        <div class="modal-header-content">
            <div class="modal-avatar">${member.firstName || member.name.split(' ')[0]}</div>
            <h2 class="modal-name">${member.name}</h2>
            <p class="modal-role">${member.role}</p>
            <span class="modal-company">${member.company}</span>
        </div>
        
        <div class="modal-tabs">
            <button class="tab-btn active" onclick="switchTab('overview')">${currentLang === 'uk' ? '–û–≥–ª—è–¥' : 'Overview'}</button>
            <button class="tab-btn" onclick="switchTab('sociometric')">${t('member.sociometricData')}</button>
            <button class="tab-btn" onclick="switchTab('quadrant')">${t('member.quadrantAnalysis')}</button>
            <button class="tab-btn" onclick="switchTab('psychology')">${t('member.psychology')}</button>
            <button class="tab-btn" onclick="switchTab('development')">${t('member.development')}</button>
        </div>
        
        <div id="tab-overview" class="tab-content active">
            ${generateOverviewTab(member, positiveConnections, negativeConnections)}
        </div>
        
        <div id="tab-sociometric" class="tab-content">
            ${generateSociometricTab(member)}
        </div>
        
        <div id="tab-quadrant" class="tab-content">
            ${generateQuadrantTab(member, quadrant)}
        </div>
        
        <div id="tab-psychology" class="tab-content">
            ${generatePsychologyTab(member)}
        </div>
        
        <div id="tab-development" class="tab-content">
            ${generateDevelopmentTab(member)}
        </div>
    `;
    
    modal.classList.add('active');
}

function generateOverviewTab(member, positiveConnections, negativeConnections) {
    return `
        <div class="modal-section">
            <h3 class="modal-section-title">
                <i class="fas fa-chart-bar"></i>
                ${t('member.competencies')}
            </h3>
            <div class="scores-grid">
                <div class="score-item">
                    <span>${t('member.communication')}</span>
                    <div class="score-bar">
                        <div class="score-fill" style="width: ${member.scores.communication * 20}%"></div>
                    </div>
                    <span class="score-value">${member.scores.communication}/5</span>
                </div>
                <div class="score-item">
                    <span>${t('member.leadership')}</span>
                    <div class="score-bar">
                        <div class="score-fill" style="width: ${member.scores.leadership * 20}%"></div>
                    </div>
                    <span class="score-value">${member.scores.leadership}/5</span>
                </div>
                <div class="score-item">
                    <span>${t('member.trust')}</span>
                    <div class="score-bar">
                        <div class="score-fill" style="width: ${member.scores.trust * 20}%"></div>
                    </div>
                    <span class="score-value">${member.scores.trust}/5</span>
                </div>
                <div class="score-item">
                    <span>${t('member.collaboration')}</span>
                    <div class="score-bar">
                        <div class="score-fill" style="width: ${member.scores.collaboration * 20}%"></div>
                    </div>
                    <span class="score-value">${member.scores.collaboration}/5</span>
                </div>
                <div class="score-item">
                    <span>${t('member.conflict')}</span>
                    <div class="score-bar">
                        <div class="score-fill" style="width: ${member.scores.conflict * 20}%"></div>
                    </div>
                    <span class="score-value">${member.scores.conflict}/5</span>
                </div>
            </div>
        </div>
        
        <div class="modal-section">
            <h3 class="modal-section-title">
                <i class="fas fa-link"></i>
                ${t('member.connections')}
            </h3>
            <div class="connections-grid">
                ${positiveConnections.length > 0 ? `
                    <div>
                        <h4>${t('member.preferredColleagues')}:</h4>
                        ${positiveConnections.map(conn => `
                            <div class="connection-item">
                                <span class="connection-name">${conn.name}</span>
                                <span class="connection-rank">Rank: ${conn.rank.toFixed(2)}</span>
                                <span class="connection-type positive">${t('legend.positive')}</span>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
                
                ${negativeConnections.length > 0 ? `
                    <div>
                        <h4>${t('member.leastPreferredColleagues')}:</h4>
                        ${negativeConnections.map(conn => `
                            <div class="connection-item">
                                <span class="connection-name">${conn.name}</span>
                                <span class="connection-rank">Rank: ${conn.rank.toFixed(2)}</span>
                                <span class="connection-type negative">${t('legend.negative')}</span>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
                
                ${positiveConnections.length === 0 && negativeConnections.length === 0 ? `
                    <p class="no-connections">${currentLang === 'uk' ? 
                        '–ù–µ–º–∞—î —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–µ—Ñ–µ—Ä–µ–Ω—Ü—ñ–π –∑–≤\'—è–∑–∫—ñ–≤' : 
                        'No specific connection preferences'}</p>
                ` : ''}
            </div>
        </div>
        
        ${member.quote ? `
            <div class="modal-section">
                <h3 class="modal-section-title">
                    <i class="fas fa-quote-left"></i>
                    ${t('member.keyQuote')}
                </h3>
                <p class="insight-text">${member.quote}</p>
            </div>
        ` : ''}
        
        <div class="modal-section">
            <h3 class="modal-section-title">
                <i class="fas fa-lightbulb"></i>
                ${t('member.professionalProfile')}
            </h3>
            <div class="profile-insights">
                <div class="insight-item">
                    <h4>${t('member.strengths')}:</h4>
                    <p>${currentLang === 'uk' ? member.insights.strength : getEnglishInsight(member.insights.strength)}</p>
                </div>
                <div class="insight-item">
                    <h4>${t('member.challenges')}:</h4>
                    <p>${currentLang === 'uk' ? member.insights.challenge : getEnglishInsight(member.insights.challenge)}</p>
                </div>
                <div class="insight-item">
                    <h4>${t('member.developmentZone')}:</h4>
                    <p>${currentLang === 'uk' ? member.insights.development : getEnglishInsight(member.insights.development)}</p>
                </div>
                <div class="insight-item key-insight-item">
                    <h4>${t('member.keyInsight')}:</h4>
                    <p class="key-insight">${currentLang === 'uk' ? member.insights.keyInsight : getEnglishInsight(member.insights.keyInsight)}</p>
                </div>
            </div>
        </div>
    `;
}

function generateSociometricTab(member) {
    return `
        <div class="sociometric-profile">
            <div class="sociometric-grid">
                <div class="sociometric-section">
                    <h4>Ownership ${currentLang === 'uk' ? '–ú–µ—Ç—Ä–∏–∫–∏' : 'Metrics'}</h4>
                    <div class="metric-rows">
                        <div class="metric-row">
                            <span>${t('member.meanRank')}:</span>
                            <span class="value">${member.meanRankOwnership.toFixed(2)}</span>
                        </div>
                        <div class="metric-row">
                            <span>${t('member.stdDev')}:</span>
                            <span class="value">${member.stdOwnership.toFixed(2)}</span>
                        </div>
                        <div class="metric-row">
                            <span>${t('member.top3Count')}:</span>
                            <span class="value">${member.top3CountOwnership}</span>
                        </div>
                        <div class="metric-row">
                            <span>${t('member.statusScore')}:</span>
                            <span class="value">${member.statusScoreOwnership.toFixed(3)}</span>
                        </div>
                        <div class="metric-row">
                            <span>${t('member.selfPerceptionMAE')}:</span>
                            <span class="value">${member.selfMAEOwnership.toFixed(2)}</span>
                        </div>
                        <div class="metric-row">
                            <span>${t('member.bias')}:</span>
                            <span class="value ${member.biasOwnership > 0 ? 'negative' : 'positive'}">${member.biasOwnership > 0 ? '+' : ''}${member.biasOwnership.toFixed(2)}</span>
                        </div>
                        <div class="metric-row">
                            <span>${t('member.accuracy')}:</span>
                            <span class="value">${member.accuracyOwnership}%</span>
                        </div>
                    </div>
                </div>
                
                <div class="sociometric-section">
                    <h4>Trust ${currentLang === 'uk' ? '–ú–µ—Ç—Ä–∏–∫–∏' : 'Metrics'}</h4>
                    <div class="metric-rows">
                        <div class="metric-row">
                            <span>${t('member.meanRank')}:</span>
                            <span class="value">${member.meanRankTrust.toFixed(2)}</span>
                        </div>
                        <div class="metric-row">
                            <span>${t('member.stdDev')}:</span>
                            <span class="value">${member.stdTrust.toFixed(2)}</span>
                        </div>
                        <div class="metric-row">
                            <span>${t('member.top3Count')}:</span>
                            <span class="value">${member.top3CountTrust}</span>
                        </div>
                        <div class="metric-row">
                            <span>${t('member.statusScore')}:</span>
                            <span class="value">${member.statusScoreTrust.toFixed(3)}</span>
                        </div>
                        <div class="metric-row">
                            <span>${t('member.selfPerceptionMAE')}:</span>
                            <span class="value">${member.selfMAETrust.toFixed(2)}</span>
                        </div>
                        <div class="metric-row">
                            <span>${t('member.bias')}:</span>
                            <span class="value ${member.biasTrust > 0 ? 'negative' : 'positive'}">${member.biasTrust > 0 ? '+' : ''}${member.biasTrust.toFixed(2)}</span>
                        </div>
                        <div class="metric-row">
                            <span>${t('member.accuracy')}:</span>
                            <span class="value">${member.accuracyTrust}%</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="sociometric-analysis">
                <h4>${currentLang === 'uk' ? '–ê–Ω–∞–ª—ñ–∑ –ø–æ–∑–∏—Ü—ñ—ó' : 'Position Analysis'}</h4>
                <p>${currentLang === 'uk' ? 
                    `–ó —Å–µ—Ä–µ–¥–Ω—ñ–º —Ä–∞–Ω–≥–æ–º ${member.meanRankOwnership.toFixed(2)} –≤ Ownership —Ç–∞ ${member.meanRankTrust.toFixed(2)} –≤ Trust, 
                    ${member.name} –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ ${getPositionDescription(member.meanRankOwnership)} –∫–æ–º–∞–Ω–¥–∏.` :
                    `With mean rank ${member.meanRankOwnership.toFixed(2)} in Ownership and ${member.meanRankTrust.toFixed(2)} in Trust, 
                    ${member.name} is in the ${getPositionDescription(member.meanRankOwnership)} of the team.`}
                </p>
                
                ${member.stdOwnership > 1.5 || member.stdTrust > 1.5 ? `
                    <p class="warning">${currentLang === 'uk' ? 
                        '–í–∏—Å–æ–∫–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –≤–∫–∞–∑—É—î –Ω–∞ –ø–æ–ª—è—Ä–∏–∑–æ–≤–∞–Ω—ñ –¥—É–º–∫–∏ —Å–µ—Ä–µ–¥ –∫–æ–º–∞–Ω–¥–∏.' :
                        'High standard deviation indicates polarized opinions among the team.'}</p>
                ` : ''}
                
                ${member.selfMAEOwnership > 1.5 || member.selfMAETrust > 1.5 ? `
                    <p class="warning">${currentLang === 'uk' ? 
                        '–ó–Ω–∞—á–Ω–∞ –ø–æ—Ö–∏–±–∫–∞ —Å–∞–º–æ–æ—Ü—ñ–Ω–∫–∏ –≤–∫–∞–∑—É—î –Ω–∞ —Ä–æ–∑—Ä–∏–≤ –º—ñ–∂ —Å–∞–º–æ—Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è–º —Ç–∞ —Ä–µ–∞–ª—å–Ω—ñ—Å—Ç—é.' :
                        'Significant self-assessment error indicates gap between self-perception and reality.'}</p>
                ` : ''}
            </div>
        </div>
    `;
}

function generateQuadrantTab(member, quadrant) {
    return `
        <div class="quadrant-analysis">
            <h3>${t('member.quadrantAnalysis')}</h3>
            
            <div class="quadrant-chart" id="memberQuadrantChart">
                <svg width="400" height="400"></svg>
            </div>
            
            <div class="quadrant-info">
                <h4>${currentLang === 'uk' ? '–ü–æ—Ç–æ—á–Ω–∞ –ø–æ–∑–∏—Ü—ñ—è' : 'Current Position'}: ${t('quadrant.' + quadrant)}</h4>
                <p>Ownership Index: ${member.ownershipIndex}</p>
                <p>Trust Index: ${member.trustIndex}</p>
            </div>
            
            <div class="quadrant-grid">
                <div class="quadrant-card ${quadrant === 'highPerformers' ? 'active' : ''}">
                    <h4>Q1: ${t('quadrant.highPerformers')}</h4>
                    <p>${currentLang === 'uk' ? 
                        '–í–∏—Å–æ–∫—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –¥–æ–≤—ñ—Ä–∏ —Ç–∞ –≤–æ–ª–æ–¥—ñ–Ω–Ω—è. –ì–æ—Ç–æ–≤—ñ –¥–æ –ª—ñ–¥–µ—Ä—Å—å–∫–∏—Ö —Ä–æ–ª–µ–π.' :
                        'High trust and ownership indicators. Ready for leadership roles.'}</p>
                </div>
                
                <div class="quadrant-card ${quadrant === 'underutilized' ? 'active' : ''}">
                    <h4>Q2: ${t('quadrant.underutilized')}</h4>
                    <p>${currentLang === 'uk' ? 
                        '–í–∏—Å–æ–∫–∞ –¥–æ–≤—ñ—Ä–∞ –ø—Ä–∏ –Ω–∏–∑—å–∫–æ–º—É –≤–æ–ª–æ–¥—ñ–Ω–Ω—ñ. –ü–æ—Ç–µ–Ω—Ü—ñ–∞–ª –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è.' :
                        'High trust with low ownership. Potential not being utilized.'}</p>
                </div>
                
                <div class="quadrant-card ${quadrant === 'developmentNeeded' ? 'active' : ''}">
                    <h4>Q3: ${t('quadrant.developmentNeeded')}</h4>
                    <p>${currentLang === 'uk' ? 
                        '–ü–æ—Ç—Ä–µ–±—É—é—Ç—å —Ä–æ–∑–≤–∏—Ç–∫—É —è–∫ –≤–æ–ª–æ–¥—ñ–Ω–Ω—è, —Ç–∞–∫ —ñ –¥–æ–≤—ñ—Ä–∏. –§–æ–∫—É—Å –Ω–∞ –Ω–∞–≤—á–∞–Ω–Ω—ñ.' :
                        'Need development in both ownership and trust. Focus on learning.'}</p>
                </div>
                
                <div class="quadrant-card ${quadrant === 'delegationReady' ? 'active' : ''}">
                    <h4>Q4: ${t('quadrant.delegationReady')}</h4>
                    <p>${currentLang === 'uk' ? 
                        '–í–∏—Å–æ–∫–∏–π —Ä—ñ–≤–µ–Ω—å –≤–æ–ª–æ–¥—ñ–Ω–Ω—è –∑ –ø–æ–º—ñ—Ä–Ω–æ—é –¥–æ–≤—ñ—Ä–æ—é. –ì–æ—Ç–æ–≤—ñ –¥–æ –±—ñ–ª—å—à–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ.' :
                        'High ownership level with moderate trust. Ready for more responsibility.'}</p>
                </div>
            </div>
        </div>
    `;
}

function generatePsychologyTab(member) {
    const motivatorsText = member.motivators ? member.motivators.map(m => 
        `<li>${currentLang === 'uk' ? getUkrainianMotivator(m) : m}</li>`
    ).join('') : '';
    
    const demotivatorsText = member.demotivators ? member.demotivators.map(d => 
        `<li>${currentLang === 'uk' ? getUkrainianDemotivator(d) : d}</li>`
    ).join('') : '';
    
    return `
        <div class="psychology-profile">
            <div class="profile-section">
                <h4><i class="fas fa-heart"></i> ${t('psychology.motivators')}</h4>
                <div class="motivators-grid">
                    ${member.motivators ? member.motivators.slice(0, 2).map(m => `
                        <div class="motivator-item">
                            <div class="motivator-icon">
                                <i class="fas fa-star"></i>
                            </div>
                            <div>
                                <h5>${currentLang === 'uk' ? getUkrainianMotivator(m) : m}</h5>
                            </div>
                        </div>
                    `).join('') : ''}
                </div>
                <ul class="compact-list">
                    ${motivatorsText}
                </ul>
            </div>
            
            <div class="profile-section">
                <h4><i class="fas fa-exclamation-triangle"></i> ${t('psychology.demotivators')}</h4>
                <div class="motivators-grid">
                    ${member.demotivators ? member.demotivators.slice(0, 2).map(d => `
                        <div class="motivator-item demotivator">
                            <div class="demotivator-icon">
                                <i class="fas fa-times"></i>
                            </div>
                            <div>
                                <h5>${currentLang === 'uk' ? getUkrainianDemotivator(d) : d}</h5>
                            </div>
                        </div>
                    `).join('') : ''}
                </div>
                <ul class="compact-list">
                    ${demotivatorsText}
                </ul>
            </div>
            
            <div class="profile-section">
                <h4><i class="fas fa-fist-raised"></i> ${t('psychology.conflictStyle')}</h4>
                <div class="conflict-style">
                    <div class="conflict-icon">
                        <i class="${getConflictIcon(member.conflictStyle)}"></i>
                    </div>
                    <div>
                        <h5>${currentLang === 'uk' ? getUkrainianConflictStyle(member.conflictStyle) : member.conflictStyle}</h5>
                        <p>${currentLang === 'uk' ? member.conflictDescription : getEnglishConflictDescription(member.conflictDescription)}</p>
                    </div>
                </div>
            </div>
            
            ${member.risks && member.risks.length > 0 ? `
                <div class="profile-section">
                    <h4><i class="fas fa-exclamation-circle"></i> ${t('psychology.risks')}</h4>
                    <div class="risk-indicators">
                        ${member.risks.map(risk => `
                            <div class="risk-item ${risk.level}">
                                <span class="risk-level ${risk.level}">${
                                    risk.level === 'high' ? (currentLang === 'uk' ? '–í–∏—Å–æ–∫–∏–π' : 'High') :
                                    risk.level === 'medium' ? (currentLang === 'uk' ? '–°–µ—Ä–µ–¥–Ω—ñ–π' : 'Medium') :
                                    (currentLang === 'uk' ? '–ù–∏–∑—å–∫–∏–π' : 'Low')
                                }</span>
                                <div>
                                    <strong>${currentLang === 'uk' ? risk.type : getEnglishRiskType(risk.type)}</strong>
                                    <p>${currentLang === 'uk' ? risk.description : getEnglishRiskDescription(risk.description)}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            ` : ''}
        </div>
    `;
}

function generateDevelopmentTab(member) {
    const developmentSteps = generateDevelopmentSteps(member);
    
    return `
        <div class="development-card">
            <h4>${t('development.title')}</h4>
            <p class="development-overview">${currentLang === 'uk' ? member.insights.development : getEnglishInsight(member.insights.development)}</p>
            
            <div class="development-steps">
                ${developmentSteps.map((step, i) => `
                    <div class="step-item">
                        <div class="step-number">${i + 1}</div>
                        <div>
                            <h5>${step.title}</h5>
                            <p>${step.description}</p>
                        </div>
                    </div>
                `).join('')}
            </div>
            
            <div class="development-timeline">
                <h5>${currentLang === 'uk' ? '–ß–∞—Å–æ–≤–∞ —à–∫–∞–ª–∞' : 'Timeline'}</h5>
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-marker"></div>
                        <div class="timeline-content">
                            <strong>0-30 ${currentLang === 'uk' ? '–¥–Ω—ñ–≤' : 'days'}</strong>
                            <p>${developmentSteps[0] ? developmentSteps[0].shortTerm : ''}</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-marker"></div>
                        <div class="timeline-content">
                            <strong>30-60 ${currentLang === 'uk' ? '–¥–Ω—ñ–≤' : 'days'}</strong>
                            <p>${developmentSteps[1] ? developmentSteps[1].midTerm : ''}</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-marker"></div>
                        <div class="timeline-content">
                            <strong>60-90 ${currentLang === 'uk' ? '–¥–Ω—ñ–≤' : 'days'}</strong>
                            <p>${developmentSteps[2] ? developmentSteps[2].longTerm : ''}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
}

// Helper functions for tabs
function getPositionDescription(meanRank) {
    if (meanRank <= 2) return currentLang === 'uk' ? '—è–¥—Ä—ñ 1-–≥–æ —Ä—ñ–≤–Ω—è' : 'core level 1';
    if (meanRank <= 3.5) return currentLang === 'uk' ? '—è–¥—Ä—ñ 2-–≥–æ —Ä—ñ–≤–Ω—è' : 'core level 2';
    if (meanRank <= 5) return currentLang === 'uk' ? '–∫–≤–∞–∑—ñ-—è–¥—Ä—ñ' : 'quasi-core';
    return currentLang === 'uk' ? '–ø–µ—Ä–∏—Ñ–µ—Ä—ñ—ó' : 'periphery';
}

function getConflictIcon(style) {
    const icons = {
        'Competing': 'fas fa-bolt',
        'Collaborating': 'fas fa-handshake',
        'Compromising': 'fas fa-balance-scale',
        'Avoiding': 'fas fa-eye-slash',
        'Accommodating': 'fas fa-heart'
    };
    return icons[style] || 'fas fa-question';
}

function getUkrainianMotivator(motivator) {
    const translations = {
        'Team achievement': '–ö–æ–º–∞–Ω–¥–Ω—ñ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è',
        'Process improvement': '–ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—Ä–æ—Ü–µ—Å—ñ–≤',
        'Professional growth': '–ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π —Ä–æ–∑–≤–∏—Ç–æ–∫',
        'Trust': '–î–æ–≤—ñ—Ä–∞',
        'Innovation implementation': '–í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è —ñ–Ω–Ω–æ–≤–∞—Ü—ñ–π',
        'System efficiency': '–ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Å–∏—Å—Ç–µ–º',
        'Professional expertise': '–ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∞ –µ–∫—Å–ø–µ—Ä—Ç–∏–∑–∞',
        'Independence': '–ù–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å',
        'Positive relationships': '–ü–æ–∑–∏—Ç–∏–≤–Ω—ñ –≤—ñ–¥–Ω–æ—Å–∏–Ω–∏',
        'Team harmony': '–ì–∞—Ä–º–æ–Ω—ñ—è –≤ –∫–æ–º–∞–Ω–¥—ñ',
        'Stability': '–°—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å',
        'Efficiency': '–ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å',
        'Clear timelines': '–ß—ñ—Ç–∫—ñ —Ç–µ—Ä–º—ñ–Ω–∏',
        'Team support': '–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –∫–æ–º–∞–Ω–¥–∏',
        'Achievement': '–î–æ—Å—è–≥–Ω–µ–Ω–Ω—è',
        'Excellence': '–î–æ—Å–∫–æ–Ω–∞–ª—ñ—Å—Ç—å',
        'System building': '–ü–æ–±—É–¥–æ–≤–∞ —Å–∏—Å—Ç–µ–º',
        'Autonomy': '–ê–≤—Ç–æ–Ω–æ–º—ñ—è',
        'Clear structure': '–ß—ñ—Ç–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞',
        'Recognition of expertise': '–í–∏–∑–Ω–∞–Ω–Ω—è –µ–∫—Å–ø–µ—Ä—Ç–∏–∑–∏',
        'Work-life balance': '–ë–∞–ª–∞–Ω—Å —Ä–æ–±–æ—Ç–∏ —Ç–∞ –∂–∏—Ç—Ç—è',
        'Respect': '–ü–æ–≤–∞–≥–∞',
        'Learning opportunities': '–ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –Ω–∞–≤—á–∞–Ω–Ω—è',
        'Positive feedback': '–ü–æ–∑–∏—Ç–∏–≤–Ω–∏–π –∑–≤–æ—Ä–æ—Ç–Ω–∏–π –∑–≤\'—è–∑–æ–∫',
        'Clear communication': '–ß—ñ—Ç–∫–∞ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è',
        'Belonging': '–ü—Ä–∏–Ω–∞–ª–µ–∂–Ω—ñ—Å—Ç—å',
        'Being helpful': '–ë—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º',
        'Organization': '–û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è',
        'Appreciation': '–í–¥—è—á–Ω—ñ—Å—Ç—å',
        'Clear tasks': '–ß—ñ—Ç–∫—ñ –∑–∞–≤–¥–∞–Ω–Ω—è',
        'Modern tools': '–°—É—á–∞—Å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',
        'Clear processes': '–ß—ñ—Ç–∫—ñ –ø—Ä–æ—Ü–µ—Å–∏',
        'Strategic impact': '–°—Ç—Ä–∞—Ç–µ–≥—ñ—á–Ω–∏–π –≤–ø–ª–∏–≤',
        'Results': '–†–µ–∑—É–ª—å—Ç–∞—Ç–∏',
        'Team success': '–£—Å–ø—ñ—Ö –∫–æ–º–∞–Ω–¥–∏',
        'Client satisfaction': '–ó–∞–¥–æ–≤–æ–ª–µ–Ω—ñ—Å—Ç—å –∫–ª—ñ—î–Ω—Ç—ñ–≤',
        'Recognition': '–í–∏–∑–Ω–∞–Ω–Ω—è',
        'Innovation': '–Ü–Ω–Ω–æ–≤–∞—Ü—ñ—ó'
    };
    return translations[motivator] || motivator;
}

function getUkrainianDemotivator(demotivator) {
    const translations = {
        'Unclear responsibilities': '–ù–µ—á—ñ—Ç–∫—ñ –æ–±–æ–≤\'—è–∑–∫–∏',
        'Time pressure': '–¢–∏—Å–∫ —á–∞—Å—É',
        'Interpersonal conflicts': '–ú—ñ–∂–æ—Å–æ–±–∏—Å—Ç—ñ—Å–Ω—ñ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç–∏',
        'Resistance to change': '–û–ø—ñ—Ä –∑–º—ñ–Ω–∞–º',
        'Lack of accountability': '–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ',
        'Inefficient processes': '–ù–µ–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ –ø—Ä–æ—Ü–µ—Å–∏',
        'Conflict': '–ö–æ–Ω—Ñ–ª—ñ–∫—Ç',
        'Negative atmosphere': '–ù–µ–≥–∞—Ç–∏–≤–Ω–∞ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞',
        'Lack of support': '–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø—ñ–¥—Ç—Ä–∏–º–∫–∏',
        'Overload': '–ü–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è',
        'Unclear priorities': '–ù–µ—á—ñ—Ç–∫—ñ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∏',
        'Interpersonal tensions': '–ú—ñ–∂–æ—Å–æ–±–∏—Å—Ç—ñ—Å–Ω–∞ –Ω–∞–ø—Ä—É–≥–∞',
        'Time constraints': '–û–±–º–µ–∂–µ–Ω–Ω—è —á–∞—Å—É',
        'Interruptions': '–ü–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è',
        'Perceived incompetence': '–°–ø—Ä–∏–π–Ω—è—Ç–∞ –Ω–µ–∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å',
        'Role ambiguity': '–ù–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ñ—Å—Ç—å —Ä–æ–ª—ñ',
        'Conflicting priorities': '–°—É–ø–µ—Ä–µ—á–ª–∏–≤—ñ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∏',
        'Lack of appreciation': '–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –≤–¥—è—á–Ω–æ—Å—Ç—ñ',
        'Communication barriers': '–ö–æ–º—É–Ω—ñ–∫–∞—Ü—ñ–π–Ω—ñ –±–∞—Ä\'—î—Ä–∏',
        'Feeling excluded': '–í—ñ–¥—á—É—Ç—Ç—è –≤–∏–∫–ª—é—á–µ–Ω–Ω—è',
        'Unclear expectations': '–ù–µ—á—ñ—Ç–∫—ñ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è',
        'Chaos': '–•–∞–æ—Å',
        'Being overlooked': '–ë—É—Ç–∏ –Ω–µ–ø–æ–º—ñ—á–µ–Ω–∏–º',
        'Conflicting instructions': '–°—É–ø–µ—Ä–µ—á–ª–∏–≤—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó',
        'Outdated systems': '–ó–∞—Å—Ç–∞—Ä—ñ–ª—ñ —Å–∏—Å—Ç–µ–º–∏',
        'Inefficiency': '–ù–µ–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å',
        'Tight deadlines': '–°—Ç–∏—Å–ª—ñ —Ç–µ—Ä–º—ñ–Ω–∏',
        'Micromanagement': '–ú—ñ–∫—Ä–æ–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç',
        'Slow decision-making': '–ü–æ–≤—ñ–ª—å–Ω–µ –ø—Ä–∏–π–Ω—è—Ç—Ç—è —Ä—ñ—à–µ–Ω—å',
        'Unclear roles': '–ù–µ—á—ñ—Ç–∫—ñ —Ä–æ–ª—ñ',
        'Organizational chaos': '–û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω–∏–π —Ö–∞–æ—Å',
        'Dependency burden': '–¢—è–≥–∞—Ä –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ'
    };
    return translations[demotivator] || demotivator;
}

function getUkrainianConflictStyle(style) {
    const translations = {
        'Competing': '–ö–æ–Ω–∫—É—Ä–µ–Ω—Ü—ñ—è',
        'Collaborating': '–°–ø—ñ–≤–ø—Ä–∞—Ü—è',
        'Compromising': '–ö–æ–º–ø—Ä–æ–º—ñ—Å',
        'Avoiding': '–£–Ω–∏–∫–∞–Ω–Ω—è',
        'Accommodating': '–ü—Ä–∏—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è'
    };
    return translations[style] || style;
}

function getEnglishRiskType(type) {
    const translations = {
        '–ù–∞–¥—Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–∞—Ü—ñ—è': 'Over-centralization',
        '–ü–µ—Ä—Ñ–µ–∫—Ü—ñ–æ–Ω—ñ–∑–º': 'Perfectionism',
        '–ü–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è': 'Overload',
        '–†–∏–≥—ñ–¥–Ω—ñ—Å—Ç—å': 'Rigidity',
        '–ù–∞–¥–º—ñ—Ä–Ω–∏–π –æ–ø—Ç–∏–º—ñ–∑–º': 'Excessive optimism',
        '–ö–æ–Ω—Ñ–æ—Ä–º—ñ–∑–º': 'Conformism',
        '–†–æ–∑—á–∞—Ä—É–≤–∞–Ω–Ω—è': 'Disappointment',
        '–°—Ç—Ä–µ—Å': 'Stress',
        '–ù–µ—Ç–µ—Ä–ø–∏–º—ñ—Å—Ç—å': 'Intolerance',
        '–Ü–∑–æ–ª—è—Ü—ñ—è': 'Isolation',
        '–ï–º–æ—Ü—ñ–π–Ω–µ –≤–∏–≥–æ—Ä–∞–Ω–Ω—è': 'Emotional burnout',
        '–°–∞–±–æ—Ç–∞–∂': 'Sabotage',
        '–í—Ç—Ä–∞—Ç–∞ —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ': 'Loss of identity',
        '–ü–∞—Å–∏–≤–Ω—ñ—Å—Ç—å': 'Passivity',
        '–ù–µ–≤–∏–¥–∏–º—ñ—Å—Ç—å': 'Invisibility',
        '–í–∏—Ö—ñ–¥': 'Exit',
        '–í–∏–≥–æ—Ä–∞–Ω–Ω—è': 'Burnout',
        '–ê–≤—Ç–æ—Ä–∏—Ç–∞—Ä–Ω—ñ—Å—Ç—å': 'Authoritarianism',
        '–ü–∞—Å–∏–≤–Ω–∞ –∞–≥—Ä–µ—Å—ñ—è': 'Passive aggression'
    };
    return translations[type] || type;
}

function getEnglishRiskDescription(description) {
    const translations = {
        '"–ì–æ—Ä–ª–æ –ø–ª—è—à–∫–∏" –≤ —É—Ö–≤–∞–ª–µ–Ω–Ω—ñ —Ä—ñ—à–µ–Ω—å': 'Bottleneck in decision making',
        '–ó–∞—Ç—Ä–∏–º–∫–∏ —á–µ—Ä–µ–∑ –ø—Ä–∞–≥–Ω–µ–Ω–Ω—è —ñ–¥–µ–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É': 'Delays due to pursuit of perfect results',
        '–í–∏—Å–Ω–∞–∂–µ–Ω–Ω—è –≤—ñ–¥ –Ω–µ–≤–∏–¥–∏–º–æ—ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—ó': 'Exhaustion from invisible coordination',
        '–ù–µ–ø–æ—Å—Ç—É–ø–ª–∏–≤—ñ—Å—Ç—å —É –ø–æ–≥–ª—è–¥–∞—Ö': 'Inflexibility in views',
        '–ú–æ–∂–µ –Ω–µ –ø–æ–º—ñ—á–∞—Ç–∏ —Ä–µ–∞–ª—å–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º': 'May not notice real problems',
        '–£–Ω–∏–∫–∞–Ω–Ω—è –Ω–µ–ø–æ–ø—É–ª—è—Ä–Ω–∏—Ö, –∞–ª–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö —Ä—ñ—à–µ–Ω—å': 'Avoiding unpopular but necessary decisions',
        '–ü—Ä–∏ –∫–æ—Ä–µ–∫—Ü—ñ—ó –∑–∞–≤–∏—â–µ–Ω–∏—Ö –æ—á—ñ–∫—É–≤–∞–Ω—å': 'When correcting inflated expectations',
        '–ü–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ –Ω–∞–º–∞–≥–∞–Ω–Ω—è –≤—Å—ñ–º –¥–æ–≥–æ–¥–∏—Ç–∏': 'Overload from trying to please everyone',
        '–ö—Ä–∏—Ç–∏—á–Ω—ñ—Å—Ç—å –¥–æ –∫–æ–ª–µ–≥ –∑ –Ω–∏–∂—á–∏–º–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º–∏': 'Critical of colleagues with lower standards',
        '–î–∏—Å—Ç–∞–Ω—Ü—ñ—é–≤–∞–Ω–Ω—è –≤—ñ–¥ "—Å–ª–∞–±—à–∏—Ö" –∫–æ–ª–µ–≥': 'Distancing from "weaker" colleagues',
        '–ù–∞–∫–æ–ø–∏—á–µ–Ω–Ω—è –Ω–µ–≤–∏—Å–ª–æ–≤–ª–µ–Ω–∏—Ö –ø—Ä–µ—Ç–µ–Ω–∑—ñ–π': 'Accumulation of unspoken grievances',
        '–ù–µ–ø—Ä—è–º–µ –≤–∏—Ä–∞–∂–µ–Ω–Ω—è –Ω–µ–≤–¥–æ–≤–æ–ª–µ–Ω–Ω—è': 'Indirect expression of dissatisfaction',
        '–ù–∞–¥–º—ñ—Ä–Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü—ñ—è –ø—ñ–¥ —ñ–Ω—à–∏—Ö': 'Excessive adaptation to others',
        '–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—è —ñ–Ω—ñ—Ü—ñ–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å': 'Insufficient initiative',
        '–ë–µ—Ä–µ –Ω–∞ —Å–µ–±–µ –∑–∞–±–∞–≥–∞—Ç–æ –∑–∞–≤–¥–∞–Ω—å': 'Takes on too many tasks',
        '–í–Ω–µ—Å–æ–∫ –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–¥–æ–æ—Ü—ñ–Ω–µ–Ω–∏–π': 'Contribution may be undervalued',
        'Learned helplessness —Ç–∞ –¥–µ–º–æ—Ç–∏–≤–∞—Ü—ñ—è': 'Learned helplessness and demotivation',
        '–ß–µ—Ä–µ–∑ –ø–æ—Å—Ç—ñ–π–Ω—ñ —Å—Ç–∏—Å–ª—ñ —Ç–µ—Ä–º—ñ–Ω–∏': 'Due to constant tight deadlines',
        '–ú–æ–∂–µ –ø—Ä–∏–¥—É—à—É–≤–∞—Ç–∏ —ñ–Ω—ñ—Ü—ñ–∞—Ç–∏–≤—É —ñ–Ω—à–∏—Ö': 'May suppress others\' initiative',
        '–î–∏—Å—Ç–∞–Ω—Ü—ñ—é–≤–∞–Ω–Ω—è –≤—ñ–¥ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∏—Ö –ø–∏—Ç–∞–Ω—å': 'Distancing from operational issues',
        '–ü–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ –≤—ñ–¥—á—É—Ç—Ç—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ –∑–∞ –≤—Å—ñ—Ö': 'Overload from feeling responsible for everyone',
        '–ù–µ–ø—Ä—è–º–µ –≤–∏—Ä–∞–∂–µ–Ω–Ω—è —Ñ—Ä—É—Å—Ç—Ä–∞—Ü—ñ—ó': 'Indirect expression of frustration'
    };
    return translations[description] || description;
}

function generateDevelopmentSteps(member) {
    // Generate personalized development steps based on member data
    const steps = [];
    
    // Based on bias and accuracy
    if (member.biasOwnership > 1 || member.biasTrust > 1) {
        steps.push({
            title: currentLang === 'uk' ? '–ö–∞–ª—ñ–±—Ä—É–≤–∞–Ω–Ω—è —Å–∞–º–æ–æ—Ü—ñ–Ω–∫–∏' : 'Self-assessment calibration',
            description: currentLang === 'uk' ? 
                '–†–µ–≥—É–ª—è—Ä–Ω–∏–π –∑–≤–æ—Ä–æ—Ç–Ω–∏–π –∑–≤\'—è–∑–æ–∫ –∑ –∞–Ω–æ–Ω—ñ–º—ñ–∑–æ–≤–∞–Ω–∏–º–∏ –∞–≥—Ä–µ–≥–∞—Ç–∞–º–∏ –¥–ª—è –≤–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è –æ—á—ñ–∫—É–≤–∞–Ω—å' :
                'Regular feedback with anonymized aggregates to align expectations',
            shortTerm: currentLang === 'uk' ? '1:1 —Å–µ—Å—ñ—è –∑ –ø—Ä–æ–∑–æ—Ä–∏–º –∑–≤–æ—Ä–æ—Ç–Ω–∏–º –∑–≤\'—è–∑–∫–æ–º' : '1:1 session with transparent feedback',
            midTerm: currentLang === 'uk' ? '–©–æ—Ç–∏–∂–Ω–µ–≤–∏–π review –ø—Ä–æ–≥—Ä–µ—Å—É' : 'Weekly progress review',
            longTerm: currentLang === 'uk' ? '–ó–Ω–∏–∂–µ–Ω–Ω—è MAE –Ω–∞ 20%' : 'Reduce MAE by 20%'
        });
    }
    
    // Based on position in hierarchy
    if (member.meanRankOwnership > 5) {
        steps.push({
            title: currentLang === 'uk' ? '–ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è –≤–∏–¥–∏–º–æ—Å—Ç—ñ' : 'Increase visibility',
            description: currentLang === 'uk' ? 
                '–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó –µ–∫—Å–ø–µ—Ä—Ç–∏–∑–∏ —Ç–∞ –≤–Ω–µ—Å–∫—É –≤ –∫–æ–º–∞–Ω–¥—É' :
                'Creating opportunities to demonstrate expertise and team contribution',
            shortTerm: currentLang === 'uk' ? '–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—è micro-wins –∫–æ–∂–Ω—ñ 2 —Ç–∏–∂–Ω—ñ' : 'Present micro-wins every 2 weeks',
            midTerm: currentLang === 'uk' ? '–õ—ñ–¥–µ—Ä—Å—Ç–≤–æ –≤ –º—ñ–Ω—ñ-–ø—Ä–æ–µ–∫—Ç—ñ' : 'Lead a mini-project',
            longTerm: currentLang === 'uk' ? '–í—Ö–æ–¥–∂–µ–Ω–Ω—è –≤ —Ç–æ–ø-5 –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º' : 'Enter top-5 by status'
        });
    }
    
    // Based on top3 count
    if (member.top3CountOwnership < 3) {
        steps.push({
            title: currentLang === 'uk' ? '–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –º–µ—Ä–µ–∂—ñ –¥–æ–≤—ñ—Ä–∏' : 'Expand trust network',
            description: currentLang === 'uk' ? 
                '–ü–æ–±—É–¥–æ–≤–∞ –º—ñ—Ü–Ω—ñ—à–∏—Ö –∑–≤\'—è–∑–∫—ñ–≤ –∑ –∫–ª—é—á–æ–≤–∏–º–∏ —á–ª–µ–Ω–∞–º–∏ –∫–æ–º–∞–Ω–¥–∏' :
                'Building stronger connections with key team members',
            shortTerm: currentLang === 'uk' ? '–ü–∞—Ä–Ω—ñ –º—ñ–∫—Ä–æ–ø—Ä–æ–µ–∫—Ç–∏ –∑ —á–ª–µ–Ω–∞–º–∏ —è–¥—Ä–∞' : 'Paired microprojects with core members',
            midTerm: currentLang === 'uk' ? '–ö—Ä–æ—Å-—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ —Å–ø—ñ–≤–ø—Ä–∞—Ü—è' : 'Cross-functional collaboration',
            longTerm: currentLang === 'uk' ? '–ó–±—ñ–ª—å—à–µ–Ω–Ω—è —Ç–æ–ø-3 –≤—Ö–æ–¥—ñ–≤ –Ω–∞ 50%' : 'Increase top-3 entries by 50%'
        });
    }
    
    // Based on quadrant position
    const quadrant = getQuadrant(member.ownershipIndex, member.trustIndex);
    if (quadrant === 'developmentNeeded') {
        steps.push({
            title: currentLang === 'uk' ? '–ö–æ–º–ø–ª–µ–∫—Å–Ω–∏–π —Ä–æ–∑–≤–∏—Ç–æ–∫ –Ω–∞–≤–∏—á–æ–∫' : 'Comprehensive skill development',
            description: currentLang === 'uk' ? 
                '–°–∏—Å—Ç–µ–º–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ —Ä–æ–∑–≤–∏—Ç–∫—É –±–∞–∑–æ–≤–∏—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü—ñ–π —Ç–∞ –ø–æ–±—É–¥–æ–≤–∏ –¥–æ–≤—ñ—Ä–∏' :
                'Systematic approach to developing core competencies and building trust',
            shortTerm: currentLang === 'uk' ? '–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è 3 –∫–ª—é—á–æ–≤–∏—Ö –Ω–∞–≤–∏—á–æ–∫ –¥–ª—è —Ä–æ–∑–≤–∏—Ç–∫—É' : 'Identify 3 key skills for development',
            midTerm: currentLang === 'uk' ? '–ü—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è —Ç—Ä–µ–Ω—ñ–Ω–≥—ñ–≤ —Ç–∞ –º–µ–Ω—Ç–æ—Ä–∏–Ω–≥' : 'Complete training and mentoring',
            longTerm: currentLang === 'uk' ? '–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è –ø—Ä–æ–≥—Ä–µ—Å—É —á–µ—Ä–µ–∑ –ø—Ä–æ–µ–∫—Ç–∏' : 'Demonstrate progress through projects'
        });
    }
    
    // Default development step
    if (steps.length === 0) {
        steps.push({
            title: currentLang === 'uk' ? '–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –ø–æ—Ç–æ—á–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó' : 'Maintain current position',
            description: currentLang === 'uk' ? 
                '–§–æ–∫—É—Å –Ω–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ —Å–∏–ª—å–Ω–∏—Ö —Å—Ç–æ—Ä—ñ–Ω —Ç–∞ –ø–æ—Å—Ç—É–ø–æ–≤–æ–º—É –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—ñ' :
                'Focus on maintaining strengths and gradual improvement',
            shortTerm: currentLang === 'uk' ? '–î–æ–∫—É–º–µ–Ω—Ç—É–≤–∞–Ω–Ω—è best practices' : 'Document best practices',
            midTerm: currentLang === 'uk' ? '–ú–µ–Ω—Ç–æ—Ä—Å—Ç–≤–æ –∫–æ–ª–µ–≥' : 'Mentor colleagues',
            longTerm: currentLang === 'uk' ? '–°—Ç–∞—Ç–∏ –µ–∫—Å–ø–µ—Ä—Ç–æ–º –≤ –¥–æ–º–µ–Ω—ñ' : 'Become domain expert'
        });
    }
    
    return steps;
}

// Switch between tabs in modal
function switchTab(tabName) {
    // Hide all tabs
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // Remove active from all buttons
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    // Show selected tab
    document.getElementById(`tab-${tabName}`).classList.add('active');
    
    // Set active button
    event.target.classList.add('active');
    
    // Special handling for quadrant chart
    if (tabName === 'quadrant' && quickInfoPerson) {
        setTimeout(() => renderMemberQuadrantChart(quickInfoPerson), 100);
    }
}

// Render member's position on quadrant chart
function renderMemberQuadrantChart(member) {
    const svg = d3.select('#memberQuadrantChart svg');
    svg.selectAll('*').remove();
    
    const width = 400;
    const height = 400;
    const margin = 40;
    
    const xScale = d3.scaleLinear()
        .domain([0, 100])
        .range([margin, width - margin]);
    
    const yScale = d3.scaleLinear()
        .domain([0, 100])
        .range([height - margin, margin]);
    
    // Background
    svg.append('rect')
        .attr('width', width)
        .attr('height', height)
        .attr('fill', '#0a0a0a');
    
    // Grid
    svg.append('line')
        .attr('x1', width / 2)
        .attr('x2', width / 2)
        .attr('y1', margin)
        .attr('y2', height - margin)
        .attr('stroke', '#666')
        .attr('stroke-dasharray', '3,3');
    
    svg.append('line')
        .attr('x1', margin)
        .attr('x2', width - margin)
        .attr('y1', height / 2)
        .attr('y2', height / 2)
        .attr('stroke', '#666')
        .attr('stroke-dasharray', '3,3');
    
    // Quadrant backgrounds
    const quadrants = [
        { x: width / 2, y: margin, w: (width - 2 * margin) / 2, h: (height - 2 * margin) / 2, color: '#00d4ff' }, // Q1
        { x: margin, y: margin, w: (width - 2 * margin) / 2, h: (height - 2 * margin) / 2, color: '#a855f7' }, // Q2
        { x: margin, y: height / 2, w: (width - 2 * margin) / 2, h: (height - 2 * margin) / 2, color: '#ff0080' }, // Q3
        { x: width / 2, y: height / 2, w: (width - 2 * margin) / 2, h: (height - 2 * margin) / 2, color: '#00ff88' } // Q4
    ];
    
    quadrants.forEach(q => {
        svg.append('rect')
            .attr('x', q.x)
            .attr('y', q.y)
            .attr('width', q.w)
            .attr('height', q.h)
            .attr('fill', q.color)
            .attr('fill-opacity', 0.1);
    });
    
    // Member position
    const x = xScale(member.ownershipIndex);
    const y = yScale(member.trustIndex);
    
    // Highlight circle
    svg.append('circle')
        .attr('cx', x)
        .attr('cy', y)
        .attr('r', 15)
        .attr('fill', member.company === 'Vagoteq' ? '#00d4ff' : '#a855f7')
        .attr('stroke', '#fff')
        .attr('stroke-width', 3);
    
    // Label
    svg.append('text')
        .attr('x', x)
        .attr('y', y - 20)
        .attr('text-anchor', 'middle')
        .attr('fill', '#fff')
        .attr('font-weight', 'bold')
        .text(member.firstName || member.name.split(' ')[0]);
    
    // Axes labels
    svg.append('text')
        .attr('x', width / 2)
        .attr('y', height - 10)
        .attr('text-anchor', 'middle')
        .attr('fill', '#fff')
        .text('Ownership ‚Üí');
    
    svg.append('text')
        .attr('transform', `rotate(-90, 20, ${height / 2})`)
        .attr('x', 20)
        .attr('y', height / 2)
        .attr('text-anchor', 'middle')
        .attr('fill', '#fff')
        .text('Trust ‚Üí');
}

// Close modal
function closeModal() {
    document.getElementById('detailsModal').classList.remove('active');
    quickInfoPerson = null;
}

// ===== Control Functions =====
function zoomView(factor) {
    if (currentView === '3d' && camera) {
        camera.position.multiplyScalar(1 / factor);
        camera.updateProjectionMatrix();
    } else if (currentView === 'force' || currentView === 'circular') {
        const svg = d3.select('#svgCanvas');
        const g = svg.select('g');
        const currentTransform = d3.zoomTransform(svg.node());
        const newK = currentTransform.k * factor;
        
        svg.call(
            d3.zoom().transform,
            d3.zoomIdentity
                .translate(currentTransform.x, currentTransform.y)
                .scale(newK)
        );
    }
}

function resetView() {
    if (currentView === '3d' && camera) {
        camera.position.set(0, 150, 300);
        camera.lookAt(0, 0, 0);
        scene.rotation.y = 0;
    } else if (currentView === 'force' || currentView === 'circular') {
        const svg = d3.select('#svgCanvas');
        svg.call(d3.zoom().transform, d3.zoomIdentity);
    }
    
    showNotification(t('notification.viewReset'), 'info');
}

function toggleAnimation() {
    animationPaused = !animationPaused;
    const btn = document.getElementById('playPauseBtn');
    const icon = btn.querySelector('i');
    const text = btn.querySelector('span');
    
    if (animationPaused) {
        icon.className = 'fas fa-play';
        text.textContent = t('actions.playAnimation');
        showNotification(t('notification.animationPaused'), 'info');
    } else {
        icon.className = 'fas fa-pause';
        text.textContent = t('actions.pauseAnimation');
        showNotification(t('notification.animationResumed'), 'info');
        if (currentView === '3d' && !animationId && !preferReducedMotion) {
            animate3D();
        }
    }
}

function takeScreenshot() {
    showNotification(t('notification.screenshotCreating'), 'info');
    
    let element;
    if (currentView === '3d' && renderer) {
        // For 3D view, use the canvas directly
        const canvas = renderer.domElement;
        canvas.toBlob(function(blob) {
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.download = `TeamPulse_${currentView}_${Date.now()}.png`;
            link.href = url;
            link.click();
            URL.revokeObjectURL(url);
            showNotification(t('notification.screenshotSaved'), 'success');
        });
    } else {
        // For other views
        element = document.getElementById('vizContainer');
        
        html2canvas(element, {
            backgroundColor: '#0a0a0a',
            scale: 2,
            logging: false,
            useCORS: true
        }).then(canvas => {
            // Create download link
            const link = document.createElement('a');
            link.download = `TeamPulse_${currentView}_${Date.now()}.png`;
            link.href = canvas.toDataURL();
            link.click();
            
            showNotification(t('notification.screenshotSaved'), 'success');
        }).catch(error => {
            console.error('Screenshot error:', error);
            showNotification(t('notification.screenshotError'), 'error');
        });
    }
}

function toggleFullscreen() {
    const container = document.getElementById('vizContainer');
    
    if (!document.fullscreenElement) {
        container.requestFullscreen().then(() => {
            container.classList.add('fullscreen');
            showNotification(t('notification.fullscreenEnabled'), 'info');
            // Trigger resize after fullscreen
            setTimeout(handleResize, 100);
        });
    } else {
        document.exitFullscreen().then(() => {
            container.classList.remove('fullscreen');
            showNotification(t('notification.fullscreenDisabled'), 'info');
            // Trigger resize after exit fullscreen
            setTimeout(handleResize, 100);
        });
    }
}

function exportData() {
    const exportData = {
        metadata: {
            exportDate: new Date().toISOString(),
            teamName: 'VQ & IM Team',
            totalMembers: teamData.members.length,
            currentView: currentView,
            language: currentLang
        },
        metrics: {
            giniOwnership: 0.217,
            giniTrust: 0.226,
            teamHealth: document.getElementById('teamHealthScore').textContent,
            frictionIndex: document.getElementById('frictionIndex').textContent,
            clarityScore: document.getElementById('clarityScore').textContent,
            engagementScore: document.getElementById('engagementScore').textContent
        },
        members: teamData.members.map(member => ({
            id: member.id,
            code: member.code,
            name: member.name,
            role: member.role,
            company: member.company,
            department: member.department,
            level: member.level,
            meanRankOwnership: member.meanRankOwnership,
            meanRankTrust: member.meanRankTrust,
            stdOwnership: member.stdOwnership,
            stdTrust: member.stdTrust,
            top3CountOwnership: member.top3CountOwnership,
            top3CountTrust: member.top3CountTrust,
            statusScoreOwnership: member.statusScoreOwnership,
            statusScoreTrust: member.statusScoreTrust,
            selfMAEOwnership: member.selfMAEOwnership,
            selfMAETrust: member.selfMAETrust,
            biasOwnership: member.biasOwnership,
            biasTrust: member.biasTrust,
            accuracyOwnership: member.accuracyOwnership,
            accuracyTrust: member.accuracyTrust,
            ownershipIndex: member.ownershipIndex,
            trustIndex: member.trustIndex,
            preferredConnections: member.preferred.length,
            negativeConnections: member.leastPreferred.length
        })),
        connections: {
            mutualTop3Ownership: mutualTop3Ownership,
            mutualTop3Trust: mutualTop3Trust
        }
    };
    
    // Create and download JSON file
    const dataStr = JSON.stringify(exportData, null, 2);
    const blob = new Blob([dataStr], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.download = `TeamPulse_Export_${Date.now()}.json`;
    link.href = url;
    link.click();
    URL.revokeObjectURL(url);
    
    showNotification(t('notification.dataExported'), 'success');
}

function toggleLegend() {
    legendVisible = !legendVisible;
    const legend = document.getElementById('legend');
    if (legend) {
        legend.style.display = legendVisible ? 'block' : 'none';
    }
    
    // For heatmap, need to redraw
    if (currentView === 'heatmap') {
        renderHeatmap(getFilteredData());
    }
    
    showNotification(t('notification.legendToggled'), 'info');
}

// ===== Notification System =====
function showNotification(message, type = 'info') {
    const container = document.getElementById('notificationContainer');
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    
    const icons = {
        success: 'fa-check-circle',
        error: 'fa-exclamation-circle',
        info: 'fa-info-circle'
    };
    
    notification.innerHTML = `
        <div class="notification-content">
            <i class="fas ${icons[type]} notification-icon"></i>
            <span>${message}</span>
        </div>
    `;
    
    container.appendChild(notification);
    
    // Animate in
    setTimeout(() => notification.classList.add('show'), 10);
    
    // Auto remove after 3 seconds
    setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => notification.remove(), 300);
    }, 3000);
}

// ===== Window Resize Handler =====
function handleResize() {
    if (currentView === '3d' && renderer) {
        const container = document.getElementById('threeContainer');
        camera.aspect = container.clientWidth / container.clientHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(container.clientWidth, container.clientHeight);
    }
    
    // Redraw current visualization
    updateVisualization();
}

// ===== Additional CSS for new elements =====
const style = document.createElement('style');
style.textContent = `
    /* Additional styles for enhanced features */
    .scatter-tooltip {
        z-index: 1000;
    }
    
    .metric-row {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px solid var(--glass-border);
    }
    
    .metric-row:last-child {
        border-bottom: none;
    }
    
    .metric-row .value {
        font-weight: 600;
        color: var(--neon-blue);
    }
    
    .metric-row .value.negative {
        color: var(--neon-pink);
    }
    
    .metric-row .value.positive {
        color: var(--neon-green);
    }
    
    .sociometric-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--spacing-lg);
    }
    
    .sociometric-section {
        background: var(--bg-tertiary);
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        border: 1px solid var(--glass-border);
    }
    
    .sociometric-analysis {
        margin-top: var(--spacing-lg);
        padding: var(--spacing-md);
        background: var(--glass-bg);
        border-radius: var(--radius-md);
        border: 1px solid var(--glass-border);
    }
    
    .sociometric-analysis p.warning {
        color: var(--neon-orange);
        font-weight: 500;
        margin-top: var(--spacing-sm);
    }
    
    .compact-list {
        list-style: none;
        padding-left: 0;
        margin-top: var(--spacing-sm);
    }
    
    .compact-list li {
        padding: 4px 0;
        color: var(--text-secondary);
        font-size: 0.9rem;
    }
    
    .timeline {
        position: relative;
        padding-left: var(--spacing-lg);
    }
    
    .timeline::before {
        content: '';
        position: absolute;
        left: 8px;
        top: 0;
        bottom: 0;
        width: 2px;
        background: var(--gradient-primary);
    }
    
    .timeline-item {
        position: relative;
        margin-bottom: var(--spacing-md);
    }
    
    .timeline-marker {
        position: absolute;
        left: -28px;
        top: 5px;
        width: 16px;
        height: 16px;
        background: var(--neon-blue);
        border-radius: 50%;
        border: 3px solid var(--bg-primary);
    }
    
    .timeline-content {
        padding: var(--spacing-sm);
        background: var(--glass-bg);
        border-radius: var(--radius-sm);
    }
    
    .development-timeline {
        margin-top: var(--spacing-lg);
    }
    
    /* Metrics View Styles */
    .metrics-header {
        text-align: center;
        margin-bottom: var(--spacing-xl);
        padding: var(--spacing-lg);
        background: var(--glass-bg);
        border-radius: var(--radius-lg);
        border: 1px solid var(--glass-border);
    }
    
    .metrics-header h1 {
        font-size: 2rem;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: var(--spacing-sm);
    }
    
    .metrics-sections {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-lg);
    }
    
    .metrics-section {
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-lg);
        padding: var(--spacing-lg);
    }
    
    .metrics-section h2 {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        font-size: 1.5rem;
        margin-bottom: var(--spacing-md);
        color: var(--neon-blue);
    }
    
    .overview-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: var(--spacing-md);
    }
    
    .overview-card {
        background: var(--bg-tertiary);
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        border: 1px solid var(--glass-border);
        text-align: center;
    }
    
    .overview-card h3 {
        color: var(--neon-cyan);
        margin-bottom: var(--spacing-sm);
    }
    
    .metric-large {
        margin: var(--spacing-sm) 0;
    }
    
    .metric-large .value {
        font-size: 2rem;
        font-weight: 700;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    .metric-large .label {
        font-size: 0.9rem;
        color: var(--text-muted);
    }
    
    .metrics-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: var(--spacing-md);
    }
    
    .metrics-table th {
        background: var(--bg-tertiary);
        padding: var(--spacing-sm);
        text-align: left;
        font-weight: 600;
        border-bottom: 2px solid var(--glass-border);
    }
    
    .metrics-table td {
        padding: var(--spacing-sm);
        border-bottom: 1px solid var(--glass-border);
    }
    
    .metrics-table td.numeric {
        text-align: center;
        font-family: 'Monaco', 'Courier New', monospace;
    }
    
    .metrics-table tr.top-performer {
        background: rgba(0, 255, 136, 0.1);
    }
    
    .metrics-table tr.low-performer {
        background: rgba(255, 0, 128, 0.1);
    }
    
    .table-container {
        margin-bottom: var(--spacing-lg);
    }
    
    .table-container h3 {
        margin-bottom: var(--spacing-sm);
        color: var(--neon-purple);
    }
    
    .spearman-correlation {
        text-align: center;
        padding: var(--spacing-md);
        background: var(--gradient-primary);
        border-radius: var(--radius-md);
        color: var(--bg-primary);
        margin-top: var(--spacing-md);
    }
    
    .perception-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: var(--spacing-md);
    }
    
    .perception-card {
        background: var(--bg-tertiary);
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        border: 1px solid var(--glass-border);
    }
    
    .perception-card.warning {
        border-color: var(--neon-orange);
        background: rgba(255, 107, 53, 0.1);
    }
    
    .perception-card.info {
        border-color: var(--neon-blue);
        background: rgba(0, 212, 255, 0.1);
    }
    
    .perception-card.critical {
        border-color: var(--neon-pink);
        background: rgba(255, 0, 128, 0.1);
    }
    
    .member-list {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-xs);
    }
    
    .member-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--spacing-xs);
        background: var(--glass-bg);
        border-radius: var(--radius-sm);
    }
    
    .badge {
        font-size: 0.8rem;
        padding: 2px 8px;
        border-radius: var(--radius-full);
        background: var(--gradient-primary);
        color: var(--bg-primary);
        font-weight: 600;
    }
    
    .badge.negative {
        background: var(--gradient-danger);
    }
    
    .badge.positive {
        background: var(--gradient-success);
    }
    
    .anomaly-note {
        margin-top: var(--spacing-md);
        padding: var(--spacing-md);
        background: rgba(255, 234, 0, 0.1);
        border: 1px solid var(--neon-yellow);
        border-radius: var(--radius-md);
    }
    
    .anomaly-note h4 {
        color: var(--neon-yellow);
        margin-bottom: var(--spacing-xs);
    }
    
    .cluster-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: var(--spacing-md);
    }
    
    .cluster-card {
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        border: 2px solid;
    }
    
    .cluster-card.core {
        background: rgba(255, 0, 128, 0.1);
        border-color: var(--neon-pink);
    }
    
    .cluster-card.core2 {
        background: rgba(255, 107, 53, 0.1);
        border-color: var(--neon-orange);
    }
    
    .cluster-card.quasi {
        background: rgba(255, 234, 0, 0.1);
        border-color: var(--neon-yellow);
    }
    
    .cluster-card.periphery {
        background: rgba(0, 255, 136, 0.1);
        border-color: var(--neon-green);
    }
    
    .member-chips {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-xs);
        margin: var(--spacing-sm) 0;
    }
    
    .member-chip {
        padding: var(--spacing-xs) var(--spacing-sm);
        background: var(--glass-bg);
        border-radius: var(--radius-full);
        font-size: 0.85rem;
    }
    
    .member-chip strong {
        color: var(--text-primary);
    }
    
    .polarization-metric {
        margin-top: var(--spacing-lg);
        padding: var(--spacing-md);
        background: var(--gradient-primary);
        border-radius: var(--radius-md);
        color: var(--bg-primary);
        text-align: center;
    }
    
    .risk-grid {
        display: grid;
        gap: var(--spacing-md);
    }
    
    .risk-card {
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        border-left: 4px solid;
    }
    
    .risk-card.high {
        background: rgba(255, 51, 102, 0.1);
        border-left-color: var(--neon-red);
    }
    
    .risk-card.medium {
        background: rgba(255, 107, 53, 0.1);
        border-left-color: var(--neon-orange);
    }
    
    .risk-card.low {
        background: rgba(0, 255, 136, 0.1);
        border-left-color: var(--neon-green);
    }
    
    .risk-item {
        margin-bottom: var(--spacing-sm);
    }
    
    .risk-item:last-child {
        margin-bottom: 0;
    }
    
    .risk-item strong {
        color: var(--neon-cyan);
        display: block;
        margin-bottom: var(--spacing-xs);
    }
    
    /* Analysis Content Styles */
    .analysis-header {
        text-align: center;
        margin-bottom: var(--spacing-xl);
        padding: var(--spacing-xl);
        background: var(--gradient-primary);
        border-radius: var(--radius-lg);
        color: var(--bg-primary);
    }
    
    .analysis-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: var(--spacing-sm);
    }
    
    .analysis-subtitle {
        font-size: 1.1rem;
        opacity: 0.9;
    }
    
    .analysis-sections {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-xl);
    }
    
    .analysis-section {
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-lg);
        padding: var(--spacing-lg);
    }
    
    .section-title {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        font-size: 1.8rem;
        margin-bottom: var(--spacing-lg);
        color: var(--neon-blue);
    }
    
    .key-metrics {
        display: flex;
        justify-content: center;
        gap: var(--spacing-lg);
        margin: var(--spacing-lg) 0;
    }
    
    .metric-card-summary {
        text-align: center;
        padding: var(--spacing-md);
        background: var(--bg-tertiary);
        border-radius: var(--radius-md);
        border: 1px solid var(--glass-border);
        transition: all 0.3s ease;
    }
    
    .metric-card-summary:hover {
        transform: translateY(-5px);
        border-color: var(--neon-cyan);
        box-shadow: 0 10px 30px rgba(0, 212, 255, 0.3);
    }
    
    .metric-value {
        font-size: 2.5rem;
        font-weight: 700;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    .metric-label {
        font-size: 0.9rem;
        color: var(--text-muted);
        margin-top: var(--spacing-xs);
    }
    
    .findings-grid {
        display: grid;
        gap: var(--spacing-md);
    }
    
    .finding-card {
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        border-left: 4px solid;
        background: var(--bg-tertiary);
    }
    
    .finding-card.critical {
        border-left-color: var(--neon-red);
        background: rgba(255, 51, 102, 0.05);
    }
    
    .finding-card.warning {
        border-left-color: var(--neon-orange);
        background: rgba(255, 107, 53, 0.05);
    }
    
    .finding-card h3 {
        color: var(--neon-cyan);
        margin-bottom: var(--spacing-sm);
    }
    
    .finding-card p {
        margin: var(--spacing-xs) 0;
        color: var(--text-secondary);
    }
    
    .employee-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: var(--spacing-lg);
    }
    
    .employee-card {
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-lg);
        padding: var(--spacing-md);
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .employee-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0, 212, 255, 0.2);
        border-color: var(--neon-cyan);
    }
    
    .employee-header {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-md);
    }
    
    .employee-avatar {
        width: 50px;
        height: 50px;
        background: var(--gradient-primary);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        color: var(--bg-primary);
        font-size: 1.2rem;
    }
    
    .employee-info h4 {
        margin: 0;
        color: var(--text-primary);
    }
    
    .employee-info p {
        margin: 0;
        color: var(--text-muted);
        font-size: 0.9rem;
    }
    
    .employee-metrics {
        display: flex;
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-md);
    }
    
    .metric {
        text-align: center;
        flex: 1;
    }
    
    .metric-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--neon-blue);
    }
    
    .metric-label {
        font-size: 0.75rem;
        color: var(--text-muted);
    }
    
    .employee-insights {
        font-size: 0.9rem;
        color: var(--text-secondary);
    }
    
    .employee-insights p {
        margin: var(--spacing-xs) 0;
    }
    
    .employee-insights strong {
        color: var(--text-primary);
    }
    
    .employee-quote {
        font-style: italic;
        color: var(--neon-purple);
        border-left: 3px solid var(--neon-purple);
        padding-left: var(--spacing-sm);
        margin-top: var(--spacing-sm);
    }
    
    .intervention-timeline {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-lg);
    }
    
    .timeline-phase {
        background: var(--bg-tertiary);
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        border: 1px solid var(--glass-border);
    }
    
    .timeline-phase h3 {
        color: var(--neon-cyan);
        margin-bottom: var(--spacing-sm);
    }
    
    .timeline-phase ul {
        margin: 0;
        padding-left: var(--spacing-lg);
    }
    
    .timeline-phase li {
        margin-bottom: var(--spacing-sm);
        color: var(--text-secondary);
    }
    
    .timeline-phase li strong {
        color: var(--text-primary);
    }
    
    .recommendations-table {
        overflow-x: auto;
    }
    
    .recommendations-table table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .recommendations-table th {
        background: var(--bg-tertiary);
        padding: var(--spacing-sm);
        text-align: left;
        font-weight: 600;
        border-bottom: 2px solid var(--glass-border);
        color: var(--neon-cyan);
    }
    
    .recommendations-table td {
        padding: var(--spacing-sm);
        border-bottom: 1px solid var(--glass-border);
        color: var(--text-secondary);
    }
    
    .final-recommendations {
        margin-top: var(--spacing-lg);
        padding: var(--spacing-md);
        background: var(--bg-tertiary);
        border-radius: var(--radius-md);
        border: 1px solid var(--glass-border);
    }
    
    .final-recommendations h4 {
        color: var(--neon-purple);
        margin-bottom: var(--spacing-sm);
    }
    
    .final-recommendations ul {
        margin: 0;
        padding-left: var(--spacing-lg);
    }
    
    .final-recommendations li {
        margin-bottom: var(--spacing-xs);
        color: var(--text-secondary);
    }
    
    .final-recommendations li strong {
        color: var(--text-primary);
    }
    
    /* Glossary Styles */
    .glossary-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: var(--spacing-xl);
    }
    
    .glossary-container h1 {
        text-align: center;
        font-size: 2.5rem;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: var(--spacing-sm);
    }
    
    .glossary-subtitle {
        text-align: center;
        color: var(--text-muted);
        margin-bottom: var(--spacing-xl);
    }
    
    .glossary-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: var(--spacing-lg);
        margin-bottom: var(--spacing-xl);
    }
    
    .glossary-card {
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-lg);
        padding: var(--spacing-md);
        transition: all 0.3s ease;
    }
    
    .glossary-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0, 212, 255, 0.2);
        border-color: var(--neon-cyan);
    }
    
    .glossary-card h3 {
        color: var(--neon-cyan);
        margin-bottom: var(--spacing-sm);
    }
    
    .glossary-card .description {
        color: var(--text-secondary);
        margin-bottom: var(--spacing-sm);
    }
    
    .glossary-card .formula {
        background: var(--bg-tertiary);
        padding: var(--spacing-sm);
        border-radius: var(--radius-sm);
        margin-bottom: var(--spacing-sm);
        font-family: 'Monaco', 'Courier New', monospace;
        font-size: 0.9rem;
    }
    
    .glossary-card .formula code {
        color: var(--neon-green);
    }
    
    .glossary-card .example {
        color: var(--text-muted);
        font-size: 0.9rem;
        font-style: italic;
    }
    
    .glossary-visual {
        margin-top: var(--spacing-sm);
    }
    
    .rank-scale {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: var(--bg-tertiary);
        padding: var(--spacing-sm);
        border-radius: var(--radius-sm);
    }
    
    .rank-value {
        font-size: 1.5rem;
        font-weight: 700;
    }
    
    .rank-value.high {
        color: var(--neon-green);
    }
    
    .rank-value.low {
        color: var(--neon-pink);
    }
    
    .rank-label {
        font-size: 0.8rem;
        color: var(--text-muted);
    }
    
    .glossary-section {
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-lg);
        padding: var(--spacing-lg);
        margin-bottom: var(--spacing-lg);
    }
    
    .glossary-section h2 {
        color: var(--neon-purple);
        margin-bottom: var(--spacing-md);
    }
    
    .raci-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: var(--spacing-md);
    }
    
    .raci-table th {
        background: var(--bg-tertiary);
        padding: var(--spacing-sm);
        text-align: left;
        font-weight: 600;
        border: 1px solid var(--glass-border);
        color: var(--neon-cyan);
    }
    
    .raci-table td {
        padding: var(--spacing-sm);
        border: 1px solid var(--glass-border);
        text-align: center;
        font-weight: 600;
        font-size: 1.1rem;
    }
    
    .raci-table td:first-child {
        text-align: left;
        font-weight: normal;
        color: var(--text-secondary);
    }
    
    .raci-a { color: var(--neon-red); }
    .raci-r { color: var(--neon-green); }
    .raci-c { color: var(--neon-blue); }
    .raci-i { color: var(--neon-purple); }
    
    .raci-legend {
        display: flex;
        gap: var(--spacing-lg);
        justify-content: center;
        margin-top: var(--spacing-md);
        flex-wrap: wrap;
    }
    
    .raci-legend span {
        color: var(--text-muted);
    }
    
    .raci-legend strong {
        color: var(--text-primary);
        margin-right: var(--spacing-xs);
    }
    
    .sop-container {
        background: var(--bg-tertiary);
        padding: var(--spacing-lg);
        border-radius: var(--radius-md);
        border: 1px solid var(--glass-border);
    }
    
    .sop-header {
        display: flex;
        gap: var(--spacing-lg);
        margin-bottom: var(--spacing-lg);
        flex-wrap: wrap;
    }
    
    .sop-header p {
        margin: 0;
        color: var(--text-secondary);
    }
    
    .sop-header strong {
        color: var(--text-primary);
    }
    
    .sop-steps {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
    }
    
    .sop-step {
        display: flex;
        gap: var(--spacing-md);
        padding: var(--spacing-md);
        background: var(--glass-bg);
        border-radius: var(--radius-md);
        border: 1px solid var(--glass-border);
        transition: all 0.3s ease;
    }
    
    .sop-step:hover {
        transform: translateX(10px);
        border-color: var(--neon-cyan);
    }
    
    .step-number {
        width: 40px;
        height: 40px;
        background: var(--gradient-primary);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 1.2rem;
        color: var(--bg-primary);
        flex-shrink: 0;
    }
    
    .step-content h4 {
        margin: 0 0 var(--spacing-xs) 0;
        color: var(--neon-cyan);
    }
    
    .step-content p {
        margin: 0;
        color: var(--text-secondary);
        font-size: 0.9rem;
    }
    
    .sop-metrics {
        margin-top: var(--spacing-lg);
        padding: var(--spacing-md);
        background: var(--glass-bg);
        border-radius: var(--radius-md);
        border: 1px solid var(--glass-border);
    }
    
    .sop-metrics h4 {
        color: var(--neon-purple);
        margin-bottom: var(--spacing-sm);
    }
    
    .sop-metrics ul {
        margin: 0;
        padding-left: var(--spacing-lg);
    }
    
    .sop-metrics li {
        color: var(--text-secondary);
        margin-bottom: var(--spacing-xs);
    }
    
    /* Development View Additional Styles */
    .development-header {
        text-align: center;
        margin-bottom: var(--spacing-xl);
    }
    
    .development-header h2 {
        font-size: 2rem;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: var(--spacing-sm);
    }
    
    .development-header p {
        color: var(--text-muted);
    }
    
    .development-grid {
        display: grid;
        grid-template-columns: 1,5fr 1fr;
        gap: var(--spacing-lg);
        margin-bottom: var(--spacing-lg);
    }
    
    @media (max-width: 968px) {
        .development-grid {
            grid-template-columns: 1fr;
        }
    }
    
    .chart-container {
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-lg);
        padding: var(--spacing-lg);
    }
    
    .chart-title {
        color: var(--neon-cyan);
        margin-bottom: var(--spacing-md);
        text-align: center;
    }
    
    .recommendations-list {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
    }
    
    .recommendation-item {
        display: flex;
        gap: var(--spacing-md);
        padding: var(--spacing-md);
        background: var(--bg-tertiary);
        border-radius: var(--radius-md);
        border: 1px solid var(--glass-border);
        align-items: flex-start;
    }
    
    .recommendation-item.critical {
        border-color: var(--neon-red);
        background: rgba(255, 51, 102, 0.05);
    }
    
    .recommendation-item.success {
        border-color: var(--neon-green);
        background: rgba(0, 255, 136, 0.05);
    }
    
    .recommendation-item.info {
        border-color: var(--neon-blue);
        background: rgba(0, 212, 255, 0.05);
    }
    
    .recommendation-item.warning {
        border-color: var(--neon-orange);
        background: rgba(255, 107, 53, 0.05);
    }
    
    .recommendation-item i {
        font-size: 1.5rem;
        margin-top: 3px;
    }
    
    .recommendation-item.critical i { color: var(--neon-red); }
    .recommendation-item.success i { color: var(--neon-green); }
    .recommendation-item.info i { color: var(--neon-blue); }
    .recommendation-item.warning i { color: var(--neon-orange); }
    
    .recommendation-item h4 {
        margin: 0 0 var(--spacing-xs) 0;
        color: var(--text-primary);
    }
    
    .recommendation-item ul {
        margin: var(--spacing-xs) 0;
        padding-left: var(--spacing-md);
    }
    
    .recommendation-item li {
        color: var(--text-secondary);
    }
    
    .recommendation-item p {
        margin: var(--spacing-xs) 0 0 0;
        color: var(--text-muted);
        font-style: italic;
    }
    
    .delegation-analysis {
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-lg);
        padding: var(--spacing-lg);
    }
    
    .delegation-analysis h3 {
        color: var(--neon-purple);
        margin-bottom: var(--spacing-md);
    }
    
    .analysis-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--spacing-lg);
        margin-bottom: var(--spacing-lg);
    }
    
    @media (max-width: 768px) {
        .analysis-grid {
            grid-template-columns: 1fr;
        }
    }
    
    .analysis-card {
        background: var(--bg-tertiary);
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        border: 1px solid var(--glass-border);
    }
    
    .analysis-card h4 {
        color: var(--neon-cyan);
        margin-bottom: var(--spacing-sm);
    }
    
    .analysis-card ul {
        margin: 0;
        padding-left: var(--spacing-md);
    }
    
    .analysis-card li {
        color: var(--text-secondary);
        margin-bottom: var(--spacing-xs);
    }
    
    .analysis-card p {
        margin: var(--spacing-xs) 0;
        color: var(--text-secondary);
    }
    
    .analysis-card p strong {
        color: var(--neon-orange);
    }
    
    .development-matrix {
        margin-top: var(--spacing-lg);
    }
    
    .development-matrix h4 {
        color: var(--neon-purple);
        margin-bottom: var(--spacing-md);
    }
    
    .development-table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .development-table th {
        background: var(--bg-tertiary);
        padding: var(--spacing-sm);
        text-align: left;
        font-weight: 600;
        border: 1px solid var(--glass-border);
        color: var(--neon-cyan);
    }
    
    .development-table td {
        padding: var(--spacing-sm);
        border: 1px solid var(--glass-border);
        color: var(--text-secondary);
    }
    
    .development-table td:first-child {
        font-weight: 600;
        color: var(--text-primary);
        text-align: center;
    }
    
    /* Quadrant Analysis Styles */
    .quadrant-analysis {
        padding: var(--spacing-lg);
    }
    
    .quadrant-analysis h3 {
        color: var(--neon-purple);
        margin-bottom: var(--spacing-md);
        text-align: center;
    }
    
    .quadrant-chart {
        display: flex;
        justify-content: center;
        margin-bottom: var(--spacing-lg);
    }
    
    .quadrant-info {
        text-align: center;
        margin-bottom: var(--spacing-lg);
        padding: var(--spacing-md);
        background: var(--bg-tertiary);
        border-radius: var(--radius-md);
    }
    
    .quadrant-info h4 {
        color: var(--neon-cyan);
        margin-bottom: var(--spacing-sm);
    }
    
    .quadrant-info p {
        margin: var(--spacing-xs) 0;
        color: var(--text-secondary);
    }
    
    .quadrant-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--spacing-md);
    }
    
    .quadrant-card {
        padding: var(--spacing-md);
        background: var(--bg-tertiary);
        border-radius: var(--radius-md);
        border: 2px solid var(--glass-border);
        transition: all 0.3s ease;
    }
    
    .quadrant-card.active {
        border-color: var(--neon-cyan);
        box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
    }
    
    .quadrant-card h4 {
        color: var(--neon-cyan);
        margin-bottom: var(--spacing-sm);
    }
    
    .quadrant-card p {
        color: var(--text-secondary);
        font-size: 0.9rem;
    }
    
    /* Psychology Profile Styles */
    .psychology-profile {
        padding: var(--spacing-lg);
    }
    
    .profile-section {
        margin-bottom: var(--spacing-lg);
        padding: var(--spacing-md);
        background: var(--bg-tertiary);
        border-radius: var(--radius-md);
        border: 1px solid var(--glass-border);
    }
    
    .profile-section h4 {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        color: var(--neon-cyan);
        margin-bottom: var(--spacing-md);
    }
    
    .profile-section h4 i {
        font-size: 1.2rem;
    }
    
    .motivators-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-md);
    }
    
    .motivator-item {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        padding: var(--spacing-sm);
        background: var(--glass-bg);
        border-radius: var(--radius-sm);
    }
    
    .motivator-icon {
        width: 40px;
        height: 40px;
        background: var(--gradient-success);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }
    
    .motivator-icon i {
        color: var(--bg-primary);
    }
    
    .demotivator-icon {
        width: 40px;
        height: 40px;
        background: var(--gradient-danger);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }
    
    .demotivator-icon i {
        color: var(--bg-primary);
    }
    
    .motivator-item h5 {
        margin: 0;
        font-size: 0.9rem;
        color: var(--text-primary);
    }
    
    .conflict-style {
        display: flex;
        gap: var(--spacing-md);
        align-items: flex-start;
    }
    
    .conflict-icon {
        width: 50px;
        height: 50px;
        background: var(--gradient-primary);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }
    
    .conflict-icon i {
        font-size: 1.5rem;
        color: var(--bg-primary);
    }
    
    .conflict-style h5 {
        margin: 0 0 var(--spacing-xs) 0;
        color: var(--neon-purple);
    }
    
    .conflict-style p {
        margin: 0;
        color: var(--text-secondary);
        font-size: 0.9rem;
    }
    
    .risk-indicators {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
    }
    
    .risk-item {
        display: flex;
        gap: var(--spacing-md);
        align-items: flex-start;
        padding: var(--spacing-sm);
        background: var(--glass-bg);
        border-radius: var(--radius-sm);
        border-left: 3px solid;
    }
    
    .risk-item.high {
        border-left-color: var(--neon-red);
    }
    
    .risk-item.medium {
        border-left-color: var(--neon-orange);
    }
    
    .risk-item.low {
        border-left-color: var(--neon-green);
    }
    
    .risk-level {
        font-size: 0.75rem;
        padding: 2px 8px;
        border-radius: var(--radius-full);
        font-weight: 600;
        text-transform: uppercase;
    }
    
    .risk-level.high {
        background: var(--gradient-danger);
        color: var(--bg-primary);
    }
    
    .risk-level.medium {
        background: var(--gradient-warning);
        color: var(--bg-primary);
    }
    
    .risk-level.low {
        background: var(--gradient-success);
        color: var(--bg-primary);
    }
    
    .risk-item strong {
        display: block;
        color: var(--text-primary);
        margin-bottom: 2px;
    }
    
    .risk-item p {
        margin: 0;
        color: var(--text-secondary);
        font-size: 0.85rem;
    }
    
    /* Development Card Styles */
    .development-card {
        padding: var(--spacing-lg);
    }
    
    .development-card h4 {
        color: var(--neon-purple);
        margin-bottom: var(--spacing-md);
    }
    
    .development-overview {
        color: var(--text-secondary);
        margin-bottom: var(--spacing-lg);
        font-style: italic;
    }
    
    .development-steps {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-lg);
    }
    
    .step-item {
        display: flex;
        gap: var(--spacing-md);
        padding: var(--spacing-md);
        background: var(--bg-tertiary);
        border-radius: var(--radius-md);
        border: 1px solid var(--glass-border);
    }
    
    .step-item .step-number {
        width: 30px;
        height: 30px;
        background: var(--gradient-primary);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        color: var(--bg-primary);
        flex-shrink: 0;
    }
    
    .step-item h5 {
        margin: 0 0 var(--spacing-xs) 0;
        color: var(--neon-cyan);
    }
    
    .step-item p {
        margin: 0;
        color: var(--text-secondary);
        font-size: 0.9rem;
    }
    
    /* Mobile Responsiveness */
    @media (max-width: 768px) {
        .employee-grid {
            grid-template-columns: 1fr;
        }
        
        .overview-grid {
            grid-template-columns: 1fr;
        }
        
        .perception-grid {
            grid-template-columns: 1fr;
        }
        
        .cluster-grid {
            grid-template-columns: 1fr;
        }
        
        .risk-grid {
            grid-template-columns: 1fr;
        }
        
        .glossary-grid {
            grid-template-columns: 1fr;
        }
        
        .motivators-grid {
            grid-template-columns: 1fr;
        }
        
        .quadrant-grid {
            grid-template-columns: 1fr;
        }
        
        .raci-table {
            font-size: 0.8rem;
        }
        
        .development-table {
            font-size: 0.8rem;
        }
        
        .metrics-table {
            font-size: 0.8rem;
        }
        
        .analysis-title {
            font-size: 1.8rem;
        }
        
        .section-title {
            font-size: 1.3rem;
        }
    }
`;

// Append styles to document
document.head.appendChild(style);

// Make functions globally available for onclick handlers
window.showQuickInfo = showQuickInfo;
window.showDetailedModal = showDetailedModal;
window.showMemberDetails = showMemberDetails;
window.switchTab = switchTab;
window.closeMobileWarning = closeMobileWarning;

// Initialize on load
console.log('TeamPulse Analytics loaded successfully!');